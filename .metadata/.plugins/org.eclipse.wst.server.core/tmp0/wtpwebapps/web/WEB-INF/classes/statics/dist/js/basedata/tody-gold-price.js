"use strict";var vm=new Vue({el:"#gold_price_container",data:function(){return{isSave:!0,openTime:"",userName:"",nowTime:(new Date).Format("yyyy-MM-dd"),body:{buyPrice:{},salePrice:{},updateName:"",updateTime:""}}},methods:{exit:function(){window.parent.closeCurrentTab({exit:!0,openTime:this.openTime})},info:function(){$.ajax({type:"POST",url:contextPath+"/tbasetodygoldprice/info",success:function(e){"100100"===e.code?(null==e.data?(vm.body.updateTime=(new Date).Format("yyyy-MM-dd hh:mm:ss"),vm.body.updateName=vm.userName):(vm.body=e.data,vm.formatNull()),vm.isSave=!0):(vm.isSave=!0,layer.alert(e.msg,{icon:0}))},error:function(e){vm.isSave=!0,layer.alert("服务器异常，请重试！",{icon:0})}})},formatNull:function(){for(var e in this.body.buyPrice)this.body.buyPrice[e]&&"null"!=this.body.buyPrice[e]||(this.body.buyPrice[e]="");for(var e in this.body.salePrice)this.body.salePrice[e]&&"null"!=this.body.salePrice[e]||(this.body.salePrice[e]="")},update:function(e){$.ajax({type:"POST",url:contextPath+"/tbasetodygoldprice/update",contentType:"application/json",data:JSON.stringify(e),dataType:"json",success:function(e){"100100"===e.code?(layer.alert("操作成功",{icon:1}),vm.info()):(layer.alert(e.msg,{icon:0}),vm.isSave=!0)},error:function(e){layer.alert("服务器异常，请重试！",{icon:0}),vm.isSave=!0}})},save:function(){if(!this.validateNum())return!1;this.isSave=!1;var e=this.body;e.createTime="",this.update(e)},clearNoNum:function(e,i){e[i]=e[i].replace(/[^\d.]/g,""),e[i]=e[i].replace(/^\./g,""),e[i]=e[i].replace(/\.{2,}/g,"."),e[i]=e[i].replace(".","$#$").replace(/\./g,"").replace("$#$","."),this.$forceUpdate()},cancel:function(){this.body={PT950:"",PT990:"",PT999:"",AU750:"",S925:"",updateName:"",updateTime:""}},validateNum:function(){for(var e in this.body.buyPrice)if(!this.body.buyPrice[e]||isNaN(this.body.buyPrice[e]))return layer.alert("成本价中 【"+e+"】 必须填写具体数字，请重试!",{icon:0}),!1;for(var e in this.body.salePrice)if(!this.body.salePrice[e]||isNaN(this.body.salePrice[e]))return layer.alert("销售价中 【"+e+"】 必须填写具体数字，请重试!",{icon:0}),!1;return!0},initFormValidate:function(){$("#gold_price_form").validate({rules:{PT950:{required:!0,number:!0,min:0},PT990:{required:!0,number:!0,min:0},AU999:{required:!0,number:!0,min:0},AU750:{required:!0,number:!0,min:0},S925:{required:!0,number:!0,min:0}},messages:{PT950:{required:"请填写编码!",number:"必须是正数",min:"必须是正数"},PT990:{required:"请填写编码!",number:"必须是正数",min:"必须是正数"},AU999:{required:"请填写编码!",number:"必须是正数",min:"必须是正数"},AU750:{required:"请填写编码!",number:"必须是正数",min:"必须是正数"},S925:{required:"请填写编码!",number:"必须是正数",min:"必须是正数"}}})}},mounted:function(){this.info(),this.userName=layui.data("user").username,this.openTime=window.parent.params.openTime}});