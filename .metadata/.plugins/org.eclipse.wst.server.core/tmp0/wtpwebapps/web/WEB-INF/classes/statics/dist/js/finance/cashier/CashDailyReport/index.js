"use strict";new Vue({el:"#cash-daily-report",data:function(){return{currentYear:0,currentMonth:0,currentLastDay:0,currencyTitle:"原币和本位币",dateTitle:"",filter:{currencyOption:3,dateStr:"",showDetail:!0,showSubtotal:!0,showTotal:!0},formData:{for1:"",for2:"3",for3:"",for4:"",for5:"",for6:""},filterVisible:!1,base_config:{mtype:"POST",styleUI:"Bootstrap",url:contextPath+"/cashdailyreport/report",ajaxGridOptions:{contentType:"application/json;charset=utf-8"},datatype:"json",jsonReader:{root:"data",cell:"data",repeatitems:!0},viewrecords:!0},colNames:[],colModel:[],tableHeaders:[],organisationList:[{label:"金大祥",value:1},{label:"金大祥1",value:2},{label:"金大祥2",value:3}],baseData:{standardCurrencyId:1},printModal:!1,printInfo:{},lodoPList:[]}},mounted:function(){this.getYear(),this.getMonth(),this.lastday(),this.filter.dateStr=this.currentYear+"-"+this.currentMonth+"-"+this.currentLastDay,this.initMethod(),this.openTime=window.parent.params&&window.parent.params.openTime},methods:{getYear:function(){var e=this;$.ajax({url:contextPath+"/bankdepositstatement/year",type:"post",dataType:"json",async:!1,success:function(t){e.currentYear=t.data}})},getMonth:function(){var e=this;$.ajax({url:contextPath+"/bankdepositstatement/month",type:"post",dataType:"json",async:!1,success:function(t){e.currentMonth=t.data}})},getLastDay:function(t,e){var a=new Date(t,e,1);return cdt=new Date(a.getTime()-864e5),cdt.getDate()},lastday:function(){var t=this;t.currentLastDay=t.getLastDay(t.currentYear,t.currentMonth)},initMethod:function(){this.delTable(),this.setTableHeader()},setTableHeader:function(){1==this.filter.currencyOption?(this.colNames=["id","科目代码","科目名称","币别","昨日余额","今日借方","今日贷方","今日余额"],this.colModel=[{name:"id",index:"id",width:30,hidden:!0},{name:"subjectCode",index:"subjectCode",width:100},{name:"subjectName",index:"subjectName",width:150},{name:"currencyName",index:"currencyName",width:80},{name:"yesterdayBalanceFor",index:"yesterdayBalanceFor",width:120,formatter:function(t,e,a,n){return null==a.yesterdayBalanceFor?"":accounting.formatNumber(a.yesterdayBalanceFor,2)},formatoptions:{decimalSeparator:"."}},{name:"todayDebitFor",index:"todayDebitFor",width:120,formatter:function(t,e,a,n){return null==a.todayDebitFor?"":accounting.formatNumber(a.todayDebitFor,2)},formatoptions:{decimalSeparator:"."}},{name:"todayCreditFor",index:"todayCreditFor",width:120,formatter:function(t,e,a,n){return null==a.todayCreditFor?"":accounting.formatNumber(a.todayCreditFor,2)},formatoptions:{decimalSeparator:"."}},{name:"todayBalanceFor",index:"todayBalanceFor",width:120,formatter:function(t,e,a,n){return null==a.todayBalanceFor?"":accounting.formatNumber(a.todayBalanceFor,2)},formatoptions:{decimalSeparator:"."}}],this.base_config.height=$(window).height()-120,this.tableHeaders=[]):2==this.filter.currencyOption?(this.colNames=["id","科目代码","科目名称","币别","昨日余额","今日借方","今日贷方","今日余额"],this.colModel=[{name:"id",width:30,hidden:!0},{name:"subjectCode",width:100},{name:"subjectName",width:150},{name:"currencyName",width:80},{name:"yesterdayBalance",width:120,formatter:function(t,e,a,n){return null==a.yesterdayBalance?"":accounting.formatNumber(a.yesterdayBalance,2)},formatoptions:{decimalSeparator:"."}},{name:"todayDebit",width:120,formatter:function(t,e,a,n){return null==a.todayDebit?"":accounting.formatNumber(a.todayDebit,2)},formatoptions:{decimalSeparator:"."}},{name:"todayCredit",width:120,formatter:function(t,e,a,n){return null==a.todayCredit?"":accounting.formatNumber(a.todayCredit,2)},formatoptions:{decimalSeparator:"."}},{name:"todayBalance",width:120,formatter:function(t,e,a,n){return null==a.todayBalance?"":accounting.formatNumber(a.todayBalance,2)},formatoptions:{decimalSeparator:"."}}],this.base_config.height=$(window).height()-120,this.tableHeaders=[]):(this.colNames=["id","科目代码","科目名称","币别","原币","本位币","原币","本位币","原币","本位币","原币","本位币"],this.colModel=[{name:"id",width:30,hidden:!0},{name:"subjectCode",width:100},{name:"subjectName",width:150},{name:"currencyName",width:80},{name:"yesterdayBalanceFor",width:120,formatter:function(t,e,a,n){return null==a.yesterdayBalanceFor?"":accounting.formatNumber(a.yesterdayBalanceFor,2)},formatoptions:{decimalSeparator:"."}},{name:"yesterdayBalance",width:120,formatter:function(t,e,a,n){return null==a.yesterdayBalance?"":accounting.formatNumber(a.yesterdayBalance,2)},formatoptions:{decimalSeparator:"."}},{name:"todayDebitFor",width:120,formatter:function(t,e,a,n){return null==a.todayDebitFor?"":accounting.formatNumber(a.todayDebitFor,2)},formatoptions:{decimalSeparator:"."}},{name:"todayDebit",width:120,formatter:function(t,e,a,n){return null==a.todayDebit?"":accounting.formatNumber(a.todayDebit,2)},formatoptions:{decimalSeparator:"."}},{name:"todayCreditFor",width:120,formatter:function(t,e,a,n){return null==a.todayCreditFor?"":accounting.formatNumber(a.todayCreditFor,2)},formatoptions:{decimalSeparator:"."}},{name:"todayCredit",width:120,formatter:function(t,e,a,n){return null==a.todayCredit?"":accounting.formatNumber(a.todayCredit,2)},formatoptions:{decimalSeparator:"."}},{name:"todayBalanceFor",width:120,formatter:function(t,e,a,n){return null==a.todayBalanceFor?"":accounting.formatNumber(a.todayBalanceFor,2)},formatoptions:{decimalSeparator:"."}},{name:"todayBalance",width:120,formatter:function(t,e,a,n){return null==a.todayBalance?"":accounting.formatNumber(a.todayBalance,2)},formatoptions:{decimalSeparator:"."}}],this.tableHeaders=[{startColumnName:"yesterdayBalanceFor",numberOfColumns:2,titleText:"昨日余额"},{startColumnName:"todayDebitFor",numberOfColumns:2,titleText:"今日借方"},{startColumnName:"todayCreditFor",numberOfColumns:2,titleText:"今日贷方"},{startColumnName:"todayBalanceFor",numberOfColumns:2,titleText:"今日余额"}],this.base_config.height=$(window).height()-170),this.jqGridInit(this.colNames,this.colModel,this.tableHeaders)},delTable:function(){$("#grid").empty();var t=$(".jqGrid_wrapper");t.empty(),$('<table id="grid"></table><div id="page"></div>').appendTo(t)},jqGridInit:function(t,e,a){this.filter.dateStr=new Date(this.filter.dateStr).format("yyyy-MM-dd HH:mm:ss");var n=this,r=Object.assign({},this.base_config,{rowNum:-1,colNames:t,colModel:e,postData:JSON.stringify(n.filter),loadComplete:function(t){jQuery("#grid").jqGrid("destroyGroupHeader"),jQuery("#grid").jqGrid("setGroupHeaders",{useColSpanStyle:!0,groupHeaders:a}),console.log(t,"===========xhr="),n.lodoPList=t.data||[]},gridComplete:function(){1==n.filter.currencyOption?n.currencyTitle="原币":2==n.filter.currencyOption?n.currencyTitle="本位币":n.currencyTitle="原币和本位币",n.dateTitle=new Date(n.filter.dateStr).format("yyyy-MM-dd")}});jQuery("#grid").jqGrid(r)},open:function(){this.filterVisible=!0},refresh:function(){this.initMethod()},save:function(){this.filterVisible=!1,this.initMethod()},cancel:function(){this.filterVisible=!1},exporting:function(){$("#export_form")[0].submit()},quit:function(){window.parent.closeCurrentTab({openTime:this.openTime,exit:!0})},print:function(){var t=this;if(console.log(t.lodoPList,"=========that.lodoPList"),t.lodoPList&&t.lodoPList.length){var e="",a="",n=t.lodoPList;3==t.filter.currencyOption?(e='\n                <tr class=\'thCs\'>\n                    <th rowspan="2" style="width: 10%">科目代码</th>\n                    <th rowspan="2" style="width: 18%">科目名称</th>\n                    <th rowspan="2" style="width: 18%">币别</th>\n                    <th colspan="2">昨日余额</th>\n                    <th colspan="2">今日借方</th>\n                    <th colspan="2">今日贷方</th>\n                    <th colspan="2">今日余额</th>\n                </tr>\n                <tr class=\'thCs\'>\n                    \n                    <th style="width: 9%">原币</th>\n                    <th style="width: 9%">本位币</th>\n                    <th style="width: 9%">原币</th>\n                    <th style="width: 9%">本位币</th>\n                    <th style="width: 9%">原币</th>\n                    <th style="width: 9%">本位币</th>\n                    <th style="width: 9%">原币</th>\n                    <th style="width: 9%">本位币</th>\n                    \n                    \n                </tr>\n            ',n.forEach(function(t){a+="\n                    <tr>\n                        <td>"+t.subjectCode+"</td>\n                        <td>"+t.subjectName+"</td>\n                        <td>"+t.currencyName+"</td>\n                        <td>"+(null==t.yesterdayBalanceFor?"":t.yesterdayBalanceFor)+"</td>\n                        <td>"+(null==t.yesterdayBalance?"":t.yesterdayBalance)+"</td>\n                        <td>"+(null==t.todayDebitFor?"":t.todayDebitFor)+"</td>\n                        <td>"+(null==t.todayDebit?"":t.todayDebit)+"</td>\n                        <td>"+(null==t.todayCreditFor?"":t.todayCreditFor)+"</td>\n                        <td>"+(null==t.todayCredit?"":t.todayCredit)+"</td>\n                        <td>"+(null==t.todayBalanceFor?"":t.todayBalanceFor)+"</td>\n                        <td>"+(null==t.todayBalance?"":t.todayBalance)+"</td>\n                        \n                        \n                    </tr>\n                "})):1==t.filter.currencyOption?(e='\n                <tr class=\'thCs\'>\n                    <th style="width: 10%">科目代码</th>\n                    <th style="width: 18%">科目名称</th>\n                    <th style="width: 18%">币别</th>\n                    <th>昨日余额</th>\n                    <th>今日借方</th>\n                    <th>今日贷方</th>\n                    <th>今日余额</th>\n                </tr>\n            ',n.forEach(function(t){a+="\n                    <tr>\n                        <td>"+t.subjectCode+"</td>\n                        <td>"+t.subjectName+"</td>\n                        <td>"+t.currencyName+"</td>\n                        <td>"+(null==t.yesterdayBalanceFor?"":t.yesterdayBalanceFor)+"</td>\n                        <td>"+(null==t.todayDebitFor?"":t.todayDebitFor)+"</td>\n                        <td>"+(null==t.todayCreditFor?"":t.todayCreditFor)+"</td>\n                        <td>"+(null==t.todayBalanceFor?"":t.todayBalanceFor)+"</td>\n                    </tr>\n                "})):(e='\n                <tr class=\'thCs\'>\n                    <th style="width: 10%">科目代码</th>\n                    <th style="width: 18%">科目名称</th>\n                    <th style="width: 18%">币别</th>\n                    <th>昨日余额</th>\n                    <th>今日借方</th>\n                    <th>今日贷方</th>\n                    <th>今日余额</th>\n                </tr>\n            ',n.forEach(function(t){a+="\n                    <tr>\n                        <td>"+t.subjectCode+"</td>\n                        <td>"+t.subjectName+"</td>\n                        <td>"+t.currencyName+"</td>\n                        <td>"+(null==t.yesterdayBalance?"":t.yesterdayBalance)+"</td>\n                        <td>"+(null==t.todayDebit?"":t.todayDebit)+"</td>\n                        <td>"+(null==t.todayCredit?"":t.todayCredit)+"</td>\n                        <td>"+(null==t.todayBalance?"":t.todayBalance)+"</td>\n                    </tr>\n                "})),console.log("thead------------"),console.log(e),console.log("tbody-------------"),console.log(a);var r={title:"现金日报表",template:12,titleInfo:[{name:"币别",val:t.currencyTitle},{name:"日期",val:t.dateTitle}],colMaxLenght:9,data:[],totalRow:!1,tbodyInfo:{theadTX:e,tbodyTX:a}};htPrint(r)}else t.$Message.info({content:"无打印数据",duration:3})},printModalShow:function(t){this.printModal=t}}});