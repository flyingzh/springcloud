"use strict";var _methods;function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e};var warehouseVm=new Vue({el:"#warehouse-info",data:function(){var i=this;return{isSearchHide:!0,isTabulationHide:!0,isHide:!0,showModal:!1,buttonFlag:!0,openTime:"",selectOrginId:[],columns:[{type:"selection",width:60,align:"center"},{title:"组织名称",key:"orgName"}],colContent:[],isEdit:!1,reload:!1,isLock:!1,selected:[],body:{name:"",codes:"",type:[]},addBody:{id:"",codes:"",name:"",type:"",managerId:"",managerName:"",groupId:"",groupName:"",address:"",remark:"",createId:"",createName:"",status:1,phoneNum:""},isAdd:!1,isShow:!1,warehouseType:[{name:"普通仓",code:1},{name:"待检仓",code:2},{name:"赠品仓",code:3},{name:"代管仓",code:4},{name:"受托代销",code:5},{name:"其他",code:6}],warehouseGroup:[],admin:[],status:[{label:"有效",value:1},{label:"无效",value:0}],warehoseUrl:contextPath+"/baseaddress/queryAddress",data_config:{url:contextPath+"/wareHouse/list",colNames:["编码","仓库名称","仓库类型","仓管员","联系电话","备注","创建人","创建时间"],colModel:[{name:"codes",index:"warehouseCode asc, invdate",width:120,formatter:function(e,t,a,o){return $(document).off("click",".detail"+e).on("click",".detail"+e,function(){i.selected=[a.id],i.view()}),'<a class="detail'+e+'">'+e+"</a>"}},{name:"name",index:"warehouseName",width:120},{name:"type",index:"warehouseType",width:120,align:"left"},{name:"managerName",index:"warehouseAdmin",width:120,align:"left"},{name:"phoneNum",index:"contacts",width:120,align:"left"},{name:"remark",index:"comment",width:120,align:"left"},{name:"createName",index:"creator",width:120,sortable:!1,align:"left"},{name:"createTime",index:"createTime",width:150,align:"left",formatter:function(e){return new Date(e).Format("yyyy-MM-dd hh:mm:ss")}}]},data_config2:{colNames:["变更信息","变更前","变更后","变更日期","变更人"],colModel:[{name:"changeInfo",index:"changeInfo",width:235},{name:"operationBefore",index:"operationBefore",width:235},{name:"operationAfter",index:"operationAfter",width:235},{name:"operationTime",index:"operationTime",width:235},{name:"userName",index:"userName",width:235}],multiselect:!1},logUrl:"",area:{},areaInit:{isInit:!1,province:"",city:"",county:"",detail:"",disabled:!1}}},created:function(){},methods:(_methods={hideSearch:function(){this.isSearchHide=!this.isSearchHide,$(".chevron").css("top","")},getManager:function(){console.log("查询管理员");var r=this;$.ajax({type:"POST",url:contextPath+"/wareHouse/getManager",contentType:"application/json",dataType:"json",async:!1,success:function(e){if(console.log(e),"100100"===e.code){var t=!0,a=!(r.admin=[]),o=void 0;try{for(var i,n=e.data[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var d=i.value;r.admin.push({label:d.empName,value:d.id,code:d.empCode})}}catch(e){a=!0,o=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw o}}}else layer.alert("网络异常",{icon:0})},error:function(e){layer.alert("网络异常",{icon:0})}})},initOrgin:function(){var n=this;isAdd=!0,$.ajax({type:"POST",url:contextPath+"/wareHouse/paramMap",contentType:"application/json",dataType:"json",async:!1,success:function(e){if(console.log(e),"100100"===e.code){for(var t=e.data.organList,a=e.data.organId,o=-1,i=0;i<t.length;i++)if(a==t[i].id){o=i;break}t.splice(o,1),n.colContent=t}else layer.alert("网络异常",{icon:0})},error:function(e){layer.alert("网络异常",{icon:0})}})}},_defineProperty(_methods,"hideSearch",function(){this.isHide=!this.isHide,this.isSearchHide=!this.isSearchHide,$(".chevron").css("top","")}),_defineProperty(_methods,"hidTabulation",function(){this.isHide=!this.isHide,this.isTabulationHide=!this.isTabulationHide,this.isTabulationHide?$(".chevron").css("top",""):$(".chevron").css("top","84%")}),_defineProperty(_methods,"showOrgin",function(){0!=this.selected.length?this.showModal=!0:layer.alert("请选择行!")}),_defineProperty(_methods,"okModel",function(){if(0!=this.selectOrginId.length){var e={ids:{},orginIds:{}};e.ids=this.selected.join(","),e.orginIds=this.selectOrginId.join(","),this.cancelModel(),console.log(e);var t=this;$.ajax({type:"POST",url:contextPath+"/wareHouse/allot",traditional:!0,datatype:"json",data:e,success:function(e){"100100"===e.code?(layer.alert("分配成功",{icon:1}),t.selectOrginId=[]):layer.alert(e.msg,{icon:0})},error:function(e){layer.alert("服务器出错",{icon:0})}})}else layer.alert("请选择分配组织!")}),_defineProperty(_methods,"cancelModel",function(){this.selectOrginId=[],this.$refs.test.selectAll(!1),this.showModal=!1}),_defineProperty(_methods,"changeselect",function(e){console.log(e);for(var t=0;t<e.length;t++)this.selectOrginId.push(e[t].id)}),_defineProperty(_methods,"addBodyInit",function(){this.addBody={codes:"",name:"",type:"",managerId:"",managerName:"",groupId:"",groupName:"",address:"",remark:"",createId:"",createName:"",status:1,phoneNum:""}}),_defineProperty(_methods,"add_click",function(){console.log("新增按钮"),this.buttonFlag=!0,this.isAdd=!0,this.isLock=!1,this.isEdit=!0,this.areaInit.disabled=!1,this.areaClear(),this.bodyClear()}),_defineProperty(_methods,"bodyClear",function(){this.addBody.codes="",this.addBody.name="",this.addBody.managerId="",this.addBody.managerName="",this.addBody.groupId="",this.addBody.groupName="",this.addBody.remark="",this.addBody.phoneNum="",this.addBody.type="",this.addBody.id=""}),_defineProperty(_methods,"areaClear",function(){this.area=[],this.areaInit={isInit:!1,province:"",city:"",county:"",detail:"",disabled:!1}}),_defineProperty(_methods,"del_click",function(){console.log(JSON.stringify(this.selected)),layer.confirm("当前数据有可能被引用，会影响数据准确性，确认是否删除？",{btn:["确定","取消"]},function(e,t){$.ajax({type:"POST",url:contextPath+"/wareHouse/delete",contentType:"application/json",data:JSON.stringify(warehouseVm.selected),dataType:"json",success:function(e){"100100"==e.code?(console.log(e.msg+"123"),layer.alert(e.msg),warehouseVm.contentType=e.data,warehouseVm.selected=[],warehouseVm.reload=!warehouseVm.reload):layer.alert(e.msg)},error:function(e){alert(e)}})})}),_defineProperty(_methods,"modify",function(){var t=this;console.log("点击了修改"),this.buttonFlag=!0;var e=warehouseVm.selected[0];this.addBody.id=e,console.log(this.addBody.id),1!==warehouseVm.selected.length?layer.alert("修改只能对单条数据进行操作"):(warehouseVm.isEdit=!1,$.ajax({type:"POST",url:contextPath+"/wareHouse/info",data:{id:e},dataType:"json",success:function(e){console.log("id查询 "+JSON.stringify(e.data)),t.addBody=e.data,t.addBody.managerName=e.data.managerId+"-"+e.data.managerName,t.isLock=!1,t.isEdit=!0,t.isAdd=!1,e.data.province&&(t.areaInit={isInit:!0,province:e.data.province,city:e.data.city,county:e.data.county,detail:e.data.detail,disabled:!1},t.area={province:e.data.province,city:e.data.city,county:e.data.county,detail:e.data.detail})},error:function(e){alert(e.msg)}}))}),_defineProperty(_methods,"view",function(){console.log("点击了查看");var t=this;if(t.isShow=!0,1<this.selected.length)layer.alert("查看只能对单条数据进行操作");else if(this.selected.length<1)layer.alert("请选择操作数据");else{var e=this.selected[0];console.log(e),this.logUrl=contextPath+"/wareHouse/changeInfos?id="+e+"&nd="+$.now(),$.ajax({type:"POST",url:contextPath+"/wareHouse/info?id="+e,contentType:"application/json",dataType:"json",success:function(e){console.log("id查询 "+JSON.stringify(e.data)),t.addBody=e.data,t.addBody.managerName=e.data.managerId+"-"+e.data.managerName,console.log(t.isLock),t.isLock=!0,t.isEdit=!0,e.data.province&&(t.areaInit={isInit:!0,province:e.data.province,city:e.data.city,county:e.data.county,detail:e.data.detail,disabled:!0},t.area={province:e.data.province,city:e.data.city,county:e.data.county,detail:e.data.detail})},error:function(e){alert(e.msg)}})}}),_defineProperty(_methods,"exit",function(){$("#my_from").validate().resetForm(),$(".layui-tab-title li").eq(0).click(),this.isEdit=!1,console.log(this.$refs.warea),this.addBodyInit(),this.areaClear(),this.selected=[],this.reload=!this.reload}),_defineProperty(_methods,"save",function(){var t=this;$("#my_from").valid()&&(t.buttonFlag=!1,warehouseVm.addBody.id?(console.log("修改id: "+warehouseVm.addBody.id),this.update()):($.isEmptyObject(this.area)||Object.assign(warehouseVm.addBody,this.area),console.log(JSON.stringify(warehouseVm.addBody)),$.ajax({type:"POST",url:contextPath+"/wareHouse/addWareHouse",contentType:"application/json",data:JSON.stringify(warehouseVm.addBody),dataType:"json",success:function(e){t.buttonFlag=!0,"100100"==e.code?layer.alert(e.msg,{icon:1,end:function(){t.area=[],t.addBodyInit(),t.isEdit=!1,t.reload=!t.reload}}):layer.alert(e.msg)},error:function(e){console.log("服务器出错")}})))}),_defineProperty(_methods,"search",function(){if(console.log("点击了搜索按钮"),console.log(this.body),!$.isEmptyObject(this.body.type)){var e=[],t=!0,a=!1,o=void 0;try{for(var i,n=this.body.type[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var d=i.value,r=!0,s=!1,c=void 0;try{for(var l,h=warehouseVm.warehouseType[Symbol.iterator]();!(r=(l=h.next()).done);r=!0){var u=l.value;u.code==d&&e.push(u.name)}}catch(e){s=!0,c=e}finally{try{!r&&h.return&&h.return()}finally{if(s)throw c}}}}catch(e){a=!0,o=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw o}}this.body.type=e.join(",")}warehouseVm.reload=!warehouseVm.reload}),_defineProperty(_methods,"clear",function(){console.log("点击了清空按钮"),this.$refs.type.selectMore=[],this.body={name:"",codes:"",type:[]}}),_defineProperty(_methods,"detailClick",function(e){var t=e.rows;this.isEdit=!0,(this.addBody=t).province&&(this.areaInit={isInit:!0,province:t.province,city:t.city,county:t.county,detail:t.detail,disabled:!0}),this.isShow=!0}),_defineProperty(_methods,"update",function(){var t=this;$.isEmptyObject(this.area)||Object.assign(warehouseVm.addBody,this.area),console.log("修改入参 "+JSON.stringify(warehouseVm.addBody)),$.ajax({type:"POST",url:contextPath+"/wareHouse/updateWareHouse",contentType:"application/json",data:JSON.stringify(warehouseVm.addBody),dataType:"json",success:function(e){"100100"==e.code?layer.alert(e.msg,{icon:1,end:function(){t.buttonFlag=!0,t.isEdit=!1,t.bodyClear(),t.reload=!t.reload}}):layer.alert(e.msg)},error:function(e){alert(e)}})}),_defineProperty(_methods,"cancel",function(){window.parent.closeCurrentTab({exit:!0,openTime:this.openTime})}),_defineProperty(_methods,"copy",function(){console.log("进复制了。。");var t=this;if(1!=this.selected.length)return layer.alert("请选择一条操作数据"),!1;warehouseVm.isEdit=!1;var e=this.selected[0];console.log(this.selected),console.log(e),console.log(this.selected[0]),$.ajax({type:"POST",url:contextPath+"/wareHouse/info",data:{id:e},dataType:"json",success:function(e){console.log(e),console.log("id查询 "+JSON.stringify(e.data)),t.addBody.type=e.data.type,t.addBody.managerName=e.data.managerId+"-"+e.data.managerName,t.addBody.groupId=e.data.groupId,t.addBody.remark=e.data.remark,t.addBody.status=e.data.status,t.addBody.phoneNum=e.data.phoneNum,t.isLock=!1,t.isAdd=!0,t.isEdit=!0,e.data.province&&(t.areaInit={isInit:!0,province:e.data.province,city:e.data.city,county:e.data.county,detail:e.data.detail,disabled:!1},t.area={province:e.data.province,city:e.data.city,county:e.data.county,detail:e.data.detail})},error:function(e){alert(e.msg)}})}),_defineProperty(_methods,"initFormValidate",function(){var e={onfocusout:function(e){$(e).valid()},onkeyup:!1,rules:{wcode:{required:!0,remote:{url:contextPath+"/wareHouse/validateCode",type:"post",dataType:"json",data:{code:function(){return warehouseVm.addBody.codes},id:function(){return warehouseVm.addBody.id}},dataFilter:function(e,t){var a=JSON.parse(e);return"100100"===a.code?a.data:(layer.alert(a.msg),!1)}}},wname:{required:!0,remote:{url:contextPath+"/wareHouse/validateCode",type:"post",dataType:"json",data:{name:function(){return warehouseVm.addBody.name},id:function(){return warehouseVm.addBody.id}},dataFilter:function(e,t){var a=JSON.parse(e);return"100100"===a.code?a.data:(layer.alert(a.msg),!1)}}},wType:{required:!0}},messages:{wcode:{required:"请填写仓库代码!",remote:"该编码已存在!"},wname:{required:"请填写仓库名称!",remote:"该币种名称已存在!"},wType:{required:"请填写仓库类型!"}}};$("#my_from").validate(e)}),_methods),mounted:function(){this.initOrgin(),this.initFormValidate(),this.getManager(),this.loadrepertorypositiongroup(),this.openTime=window.parent.params.openTime}});