"use strict";new Vue({el:"#fixedAssetsList",data:function(){return{dateStr:"",selectedId:0,formData:{sPeriodYear:"",sPeriodMonth:"",showInitPeriod:!1,showMultiDeptUse:"3",showAdd:!0,showChange:!0,showClear:!0},periodYear:[],periodList:[],filterVisible:!0,base_config:{mtype:"POST",styleUI:"Bootstrap",url:contextPath+"/assetslistcontroller/getFaList",ajaxGridOptions:{contentType:"application/json;charset=utf-8"},datatype:"json",jsonReader:{root:"data",cell:"list",repeatitems:!1},onSelectRow:function(e,t){console.log("当前选择的单个id==="+e),this.selectedId=e},ondblClickRow:function(e){console.log("当前双击的单个id==="+e)},viewrecords:!0,rowNum:99999,shrinkToFit:!1},colNames:[],colModel:[],tableHeaders:[],organisationList:[],printModal:!1,printInfo:{},dataList:[]}},created:function(){this.openTime=window.parent.params&&window.parent.params.openTime},mounted:function(){this.initData()},methods:{operateDate:function(e){return new Date(e).format("yyyy-MM-dd")},initData:function(){var n=this;$.ajax({type:"post",async:!1,url:contextPath+"/assetslistcontroller/initPage",success:function(e){if("100100"!=e.code){var t="页面初始化失败";return e.hasOwnProperty("data")&&(t=e.msg),void layer.alert(t)}var a=e.data;n.periodYear=a.yearList,n.periodList=a.monthList,$.each(n.periodYear,function(e,t){t.value==a.currentYear&&(n.formData.sPeriodYear=t.name)}),$.each(n.periodList,function(e,t){t.value==a.currentMonth&&(n.formData.sPeriodMonth=t.name,console.log(t.name),console.log(n.formData.sPeriodMonth))})}})},initMethod:function(){this.delTable(),this.setTableHeader()},setTableHeader:function(){this.colNames=["id","资产编码","资产名称","类别","型号","单位","变动方式","制造商","产地","供应商","入账日期","使用日期","使用情况","使用部门","部门代码","经济用途","折旧方法","存放地点","数量","币别","汇率","原值原币","原值本币","累计折旧","净值","减值准备","净额","预计净残值","本期折旧额","使用寿命","剩余寿命","备注"],this.colModel=[{name:"id",width:30,frozen:!0},{name:"assetCode",width:120},{name:"assetName",width:120},{name:"classesName",width:120},{name:"model",width:120},{name:"unitName",width:120},{name:"changeModeName",width:120},{name:"manufacturer",width:120},{name:"originPlace",width:120},{name:"supplierName",width:120},{name:"enterAccountDateStr",width:120},{name:"beginUsedateStr",width:120},{name:"useStateName",width:120},{name:"deptName",width:120},{name:"deptCode",width:120},{name:"useType",width:120},{name:"deprMethodStr",width:120},{name:"locationName",width:120},{name:"num",width:120},{name:"currencyName",width:120},{name:"exchangeRate",width:120},{name:"orgValForStr",width:120},{name:"orgValStr",width:120},{name:"deprService",width:120,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,2,",")}},{name:"netVal",width:120,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,2,",")}},{name:"devalPreparation",width:120,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,2,",")}},{name:"netAmo",width:120,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,2,",")}},{name:"expectNetSalvage",width:120,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,2,",")}},{name:"currentDepreciation",width:120,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,2,",")}},{name:"expectUsePeriods",width:120},{name:"usefulLife",width:120},{name:"remark",width:120}],this.tableHeaders=[],this.base_config.height=$(window).height()-140,this.jqGridInit(this.colNames,this.colModel,this.tableHeaders)},delTable:function(){$("#grid").empty();var e=$(".jqGrid_wrapper");e.empty(),$('<table id="grid"></table><div id="page"></div>').appendTo(e)},jqGridInit:function(e,t,a){var n=this,o=Object.assign({},this.base_config,{colNames:e,colModel:t,postData:JSON.stringify(n.formData),loadComplete:function(e){if("100100"!=e.code){var t="系统异常!";return e.hasOwnProperty("data")&&(t=result.msg),void layer.alert(t)}n.dateStr=n.formData.sPeriodYear+"年"+n.formData.sPeriodMonth+"期",n.dataList=e.data||[],jQuery("#grid").jqGrid("destroyGroupHeader"),jQuery("#grid").jqGrid("setGroupHeaders",{useColSpanStyle:!0,groupHeaders:a})},gridComplete:function(){var e=jQuery("#grid").jqGrid("getRowData"),t=$("#grid").jqGrid("getDataIDs");e.push($("#grid").jqGrid("getRowData",t[t.length-1]))}});jQuery("#grid").jqGrid(o)},open:function(){this.filterVisible=!0},refresh:function(){this.initMethod()},save:function(){this.filterVisible=!1,this.initMethod()},cancel:function(){this.filterVisible=!1},exportExcel:function(){var e=this.formData,t=contextPath+"/assetslistcontroller/exportExcel?sPeriodYear="+e.sPeriodYear+"&sPeriodMonth="+e.sPeriodMonth+"&showInitPeriod="+e.showInitPeriod+"&showChange="+e.showChange+"&showMultiDeptUse="+e.showMultiDeptUse+"&showAdd="+e.showAdd+"&showClear="+e.showClear;window.open(t,"数据引出")},exitPrevent:function(){window.parent.closeCurrentTab({name:"清单表",openTime:this.openTime,exit:!0})},print:function(){var e,t=this;t.dataList&&t.dataList.length?(e={title:"固定资产清单",template:1,titleInfo:[{name:"会计期间",val:t.dateStr}],colNames:[{name:"资产编码",col:"assetCode"},{name:"资产名称",col:"assetName"},{name:"类别",col:"classesName"},{name:"型号",col:"model"},{name:"单位",col:"unitName"},{name:"变动方式",col:"changeModeName"},{name:"制造商",col:"manufacturer"},{name:"产地",col:"originPlace"},{name:"供应商",col:"supplierName"},{name:"入账日期",col:"enterAccountDateStr"},{name:"使用日期",col:"beginUsedateStr"},{name:"使用情况",col:"useStateName"},{name:"使用部门",col:"deptName"},{name:"部门代码",col:"deptCode"},{name:"经济用途",col:"useType"},{name:"折旧方法",col:"deprMethodStr"},{name:"存放地点",col:"locationName"},{name:"数量",col:"num"},{name:"币别",col:"currencyName"},{name:"汇率",col:"exchangeRate"},{name:"原值原币",col:"orgValForStr"},{name:"原值本币",col:"orgValStr"},{name:"累计折旧",col:"deprService",formatNub:!0},{name:"净值",col:"netVal",formatNub:!0},{name:"减值准备",col:"devalPreparation",formatNub:!0},{name:"净额",col:"netAmo",formatNub:!0},{name:"预计净残值",col:"expectNetSalvage",formatNub:!0},{name:"本期折旧额",col:"currentDepreciation",formatNub:!0},{name:"使用寿命",col:"expectUsePeriods"},{name:"剩余寿命",col:"usefulLife"},{name:"备注",col:"remark"}],styleCss:"",colMaxLenght:30,data:t.dataList,totalRow:!1},t.printInfo=e,t.printModalShow(!0)):t.$Message.info({content:"无打印数据",duration:3})},printModalShow:function(e){this.printModal=e},nullValue:function(e){return null==e||void 0===e||0==e?"":e},cardDetail:function(){}}});