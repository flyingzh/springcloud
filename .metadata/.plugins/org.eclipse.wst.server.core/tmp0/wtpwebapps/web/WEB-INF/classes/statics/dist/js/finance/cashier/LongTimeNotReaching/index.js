"use strict";new Vue({el:"#long-time-not-reaching",data:function(){return{openTime:"",periodYear:[],periodList:[],subjectList:[],currencyList:[],organisationList:[],formData:{subjectId:0,currencyId:0,currentYear:"",currentMonth:"",radioId:1,fullSubjectName:"",currencyName:"",bankName:"",bankAccount:"",reportName:"",dateStr:""},queryData:{year:"",month:"",subjectId:"",currencyId:"",dateStr:"",typeId:1},filterVisible:!0,base_config:{mtype:"POST",datatype:"json",styleUI:"Bootstrap",url:contextPath+"/app/longTimeNotReaching/list",jsonReader:{root:"data"},height:$(window).height()-140,viewrecords:!0,rowNum:999999999},colNames:[],colModel:[],tableHeaders:[],baseData:{standardCurrencyId:1},printModal:!1,printInfo:{},dataList:[]}},mounted:function(){this.openTime=window.parent.params&&window.parent.params.openTime,this.initFormData(),this.currency(),this.initMethod()},methods:{initFormData:function(){var e=this;$.ajax({type:"post",async:!1,url:contextPath+"/app/bankAccount/initData",data:{isCash:1},success:function(t){console.log(t,"长期未达账");var a=t.data;null!=a&&(e.periodYear=a.systemProfile.yearList,e.periodList=a.systemProfile.monthList,e.formData.currentYear=a.systemProfile.currentYear,e.formData.currentMonth=a.systemProfile.currentMonth,e.subjectList=a.subject.data,0<e.subjectList.length&&(e.formData.subjectId=e.subjectList[0].accountId))}})},currency:function(){var e=this;$.ajax({type:"post",async:!1,url:contextPath+"/cashierBalanceController/app/initCnCurrency",data:{isCash:1},success:function(t){console.log(t,"币别");var a=t.data;0<(e.currencyList=a).length&&(e.formData.currencyId=a[0].currencyId)}})},titleParams:function(){var t=this.subjectList;if(null!=t)for(var a=0;a<t.length;a++){var e=t[a];if(e.accountId==this.queryData.subjectId){this.formData.bankName=e.bankName,this.formData.bankAccount=e.bankAccount,this.formData.fullSubjectName=e.accountCode+" "+e.accountName;break}}var n=this.currencyList;if(null!=n)for(a=0;a<n.length;a++)if(n[a].currencyId==this.queryData.currencyId){this.formData.currencyName=n[a].currencyName;break}this.formData.dateStr=this.queryData.year+"年第"+this.queryData.month+"期";var r=this.queryData.typeId;1==r&&(this.formData.reportName="银行未达账"),2==r&&(this.formData.reportName="企业未达账")},refresh:function(){$("#grid").jqGrid("setGridParam",{postData:this.queryData}).trigger("reloadGrid")},initMethod:function(){this.delTable(),this.setTableHeader()},jqGridInit:function(t,a,e){var n=this,r=Object.assign({},this.base_config,{colNames:t,colModel:a,loadComplete:function(t){n.dataList=t.data||[],jQuery("#grid").jqGrid("destroyGroupHeader"),jQuery("#grid").jqGrid("setGroupHeaders",{useColSpanStyle:!0,groupHeaders:e})}});jQuery("#grid").jqGrid(r)},setTableHeader:function(){1==this.formData.radioId?this.baseData.standardCurrencyId===this.formData.currencyId?(this.colNames=["id","项目","日期","凭证字号","对方科目","借方金额","贷方金额","制单人","数据来源","备注"],this.colModel=[{name:"id",width:40,hidden:!0},{name:"summary",width:150},{name:"voucherDate",width:80},{name:"voucherName",width:100},{name:"relativeSubjectName",width:150},{name:"debitAmount",width:100,align:"right"},{name:"creditAmount",width:100,align:"right"},{name:"createName",width:80},{name:"dataSourceName",width:80},{name:"reamk",width:100}],this.tableHeaders=[]):(this.colNames=["id","项目","日期","凭证字号","对方科目","原币","本位币","原币","本位币","制单人","数据来源","备注"],this.colModel=[{name:"id",width:40,hidden:!0},{name:"summary",width:150},{name:"voucherDate",width:80},{name:"voucherName",width:100},{name:"relativeSubjectName",width:150},{name:"debitAmountFor",width:100,align:"right"},{name:"debitAmount",width:100,align:"right"},{name:"creditAmountFor",width:100,align:"right"},{name:"creditAmount",width:100,align:"right"},{name:"createName",width:80},{name:"dataSourceName",width:80},{name:"reamk",width:100}],this.tableHeaders=[{startColumnName:"debitAmountFor",numberOfColumns:2,titleText:"借方金额"},{startColumnName:"creditAmountFor",numberOfColumns:2,titleText:"贷方金额"}]):this.baseData.standardCurrencyId===this.formData.currencyId?(this.colNames=["id","项目","日期","借方金额","贷方金额","制单人","数据来源","备注"],this.colModel=[{name:"id",width:40,hidden:!0},{name:"summary",width:150},{name:"voucherDate",width:80},{name:"debitAmount",width:100,align:"right"},{name:"creditAmount",width:100,align:"right"},{name:"createName",width:80},{name:"dataSourceName",width:80},{name:"reamk",width:100}],this.tableHeaders=[]):(this.colNames=["id","项目","日期","原币","本位币","原币","本位币","制单人","数据来源","备注"],this.colModel=[{name:"id",width:40,hidden:!0},{name:"summary",width:150},{name:"voucherDate",width:80},{name:"debitAmountFor",width:100,align:"right"},{name:"debitAmount",width:100,align:"right"},{name:"creditAmountFor",width:100,align:"right"},{name:"creditAmount",width:100,align:"right"},{name:"createName",width:80},{name:"dataSourceName",width:80},{name:"reamk",width:100}],this.tableHeaders=[{startColumnName:"debitAmountFor",numberOfColumns:2,titleText:"借方金额"},{startColumnName:"creditAmountFor",numberOfColumns:2,titleText:"贷方金额"}]),this.jqGridInit(this.colNames,this.colModel,this.tableHeaders)},delTable:function(){$("#grid").empty();var t=$(".jqGrid_wrapper");t.empty(),$('<table id="grid"></table><div id="page"></div>').appendTo(t)},save:function(){this.cancel(),this.queryData.subjectId=this.formData.subjectId,this.queryData.currencyId=this.formData.currencyId,this.queryData.year=this.formData.currentYear,this.queryData.month=this.formData.currentMonth,this.queryData.dateStr=this.queryData.year+"-"+this.queryData.month,this.queryData.typeId=this.formData.radioId,this.base_config.postData=this.queryData,this.initMethod(),this.titleParams()},exportExcel:function(){var t="银行："+this.formData.bankName+"  账号："+this.formData.bankAccount+"   报表："+this.formData.reportName+"   科目："+this.formData.fullSubjectName+"   币别："+this.formData.currencyName+"   期间："+this.formData.dateStr;window.open(rcContextPath+"/app/longTimeNotReaching/exportExcel?typeId="+this.queryData.typeId+"&currencyId="+this.queryData.currencyId+"&titles="+t)},companyPrint:function(){var a=this;if(a.formData.currencyId==a.baseData.standardCurrencyId){var t={title:"长期未达账",template:1,titleInfo:[{name:"银行",val:a.formData.bankName},{name:"账号",val:a.formData.bankAccount},{name:"报表",val:a.formData.reportName},{name:"科目",val:a.formData.fullSubjectName},{name:"币别",val:a.formData.currencyName},{name:"期间",val:a.formData.dateStr}],colNames:[{name:"项目",col:"summary"},{name:"日期",col:"voucherDate"},{name:"借方金额",col:"debitAmount"},{name:"贷方金额",col:"creditAmount"},{name:"制单人",col:"createName"},{name:"数据来源",col:"dataSourceName"},{name:"备注",col:"reamk"}],styleCss:"",colMaxLenght:7,data:a.dataList,totalRow:!1};a.printInfo=t,a.printModalShow(!0)}else{var e=a.dataList,n="";'\n                    <tr class=\'thCs\'>\n                        <th rowspan="2" style="width: 6%">项目</th>\n                        <th rowspan="2" style="width: 6%">日期</th>\n                        <th colspan="2" style="width: 12%">借方金额</th>\n                        <th colspan="2" style="width: 12%">贷方金额</th>\n                        <th rowspan="2" style="width: 6%">制单人</th>\n                        <th rowspan="2" style="width: 6%">数据来源</th>\n                        <th rowspan="2" style="width: 6%">备注</th>\n                    </tr>\n                     <tr class=\'thCs\'>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th> \n                    </tr>\n                ',e.forEach(function(t){n+="\n                        <tr>\n                            <td>"+a.nullValue(t.summary)+"</td>\n                            <td>"+a.nullValue(t.voucherDate)+"</td>\n                            <td>"+a.nullValue(t.debitAmountFor)+"</td>\n                            <td>"+a.nullValue(t.debitAmount)+"</td>\n                            <td>"+a.nullValue(t.creditAmountFor)+"</td>\n                            <td>"+a.nullValue(t.creditAmount)+"</td>\n                            <td>"+a.nullValue(t.createName)+"</td>\n                            <td>"+a.nullValue(t.dataSourceName)+"</td>\n                            <td>"+a.nullValue(t.reamk)+"</td>\n                        </tr>\n                    "});var r={title:"长期未达账",template:12,titleInfo:[{name:"银行",val:a.formData.bankName},{name:"账号",val:a.formData.bankAccount},{name:"报表",val:a.formData.reportName},{name:"科目",val:a.formData.fullSubjectName},{name:"币别",val:a.formData.currencyName},{name:"期间",val:a.formData.dateStr}],colMaxLenght:10,tbodyInfo:{theadTX:'\n                    <tr class=\'thCs\'>\n                        <th rowspan="2" style="width: 6%">项目</th>\n                        <th rowspan="2" style="width: 6%">日期</th>\n                        <th colspan="2" style="width: 12%">借方金额</th>\n                        <th colspan="2" style="width: 12%">贷方金额</th>\n                        <th rowspan="2" style="width: 6%">制单人</th>\n                        <th rowspan="2" style="width: 6%">数据来源</th>\n                        <th rowspan="2" style="width: 6%">备注</th>\n                    </tr>\n                     <tr class=\'thCs\'>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th> \n                    </tr>\n                ',tbodyTX:n,tfootTX:""}};htPrint(r)}},bankPrint:function(){var a=this;if(a.formData.currencyId==a.baseData.standardCurrencyId){var t={title:"长期未达账",template:1,titleInfo:[{name:"银行",val:a.formData.bankName},{name:"账号",val:a.formData.bankAccount},{name:"报表",val:a.formData.reportName},{name:"科目",val:a.formData.fullSubjectName},{name:"币别",val:a.formData.currencyName},{name:"期间",val:a.formData.dateStr}],colNames:[{name:"项目",col:"summary"},{name:"日期",col:"voucherDate"},{name:"凭证字号",col:"voucherName"},{name:"对方科目",col:"relativeSubjectName"},{name:"借方金额",col:"debitAmount"},{name:"贷方金额",col:"creditAmount"},{name:"制单人",col:"createName"},{name:"数据来源",col:"dataSourceName"},{name:"备注",col:"reamk"}],styleCss:"",colMaxLenght:9,data:a.dataList,totalRow:!1};a.printInfo=t,a.printModalShow(!0)}else{var e=a.dataList;console.log(e);var n="";'\n                    <tr class=\'thCs\'>\n                        <th rowspan="2" style="width: 6%">项目</th>\n                        <th rowspan="2" style="width: 6%">日期</th>\n                        <th rowspan="2" style="width: 6%">凭证字号</th>\n                        <th rowspan="2" style="width: 6%">对方科目</th>\n                        <th colspan="2" style="width: 12%">借方金额</th>\n                        <th colspan="2" style="width: 12%">贷方金额</th>\n                        <th rowspan="2" style="width: 6%">制单人</th>\n                        <th rowspan="2" style="width: 6%">数据来源</th>\n                        <th rowspan="2" style="width: 6%">备注</th>\n                    </tr>\n                     <tr class=\'thCs\'>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th> \n                    </tr>\n                ',e.forEach(function(t){n+="\n                        <tr>\n                            <td>"+a.nullValue(t.summary)+"</td>\n                            <td>"+a.nullValue(t.voucherDate)+"</td>\n                            <td>"+a.nullValue(t.voucherName)+"</td>\n                            <td>"+a.nullValue(t.relativeSubjectName)+"</td>\n                            <td>"+a.nullValue(t.debitAmountFor)+"</td>\n                            <td>"+a.nullValue(t.debitAmount)+"</td>\n                            <td>"+a.nullValue(t.creditAmountFor)+"</td>\n                            <td>"+a.nullValue(t.creditAmount)+"</td>\n                            <td>"+a.nullValue(t.createName)+"</td>\n                            <td>"+a.nullValue(t.dataSourceName)+"</td>\n                            <td>"+a.nullValue(t.reamk)+"</td>\n                        </tr>\n                    "});var r={title:"长期未达账",template:12,titleInfo:[{name:"银行",val:a.formData.bankName},{name:"账号",val:a.formData.bankAccount},{name:"报表",val:a.formData.reportName},{name:"科目",val:a.formData.fullSubjectName},{name:"币别",val:a.formData.currencyName},{name:"期间",val:a.formData.dateStr}],colMaxLenght:12,tbodyInfo:{theadTX:'\n                    <tr class=\'thCs\'>\n                        <th rowspan="2" style="width: 6%">项目</th>\n                        <th rowspan="2" style="width: 6%">日期</th>\n                        <th rowspan="2" style="width: 6%">凭证字号</th>\n                        <th rowspan="2" style="width: 6%">对方科目</th>\n                        <th colspan="2" style="width: 12%">借方金额</th>\n                        <th colspan="2" style="width: 12%">贷方金额</th>\n                        <th rowspan="2" style="width: 6%">制单人</th>\n                        <th rowspan="2" style="width: 6%">数据来源</th>\n                        <th rowspan="2" style="width: 6%">备注</th>\n                    </tr>\n                     <tr class=\'thCs\'>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th> \n                    </tr>\n                ',tbodyTX:n,tfootTX:""}};htPrint(r)}},print:function(){var t=this;t.dataList&&t.dataList.length?1==t.formData.radioId?t.bankPrint():t.companyPrint():t.$Message.info({content:"无打印数据",duration:3})},nullValue:function(t){return null==t||void 0===t||0==t?"":t},open:function(){this.filterVisible=!0},cancel:function(){this.filterVisible=!1},outHtml:function(){window.parent.closeCurrentTab({name:"长期未达账",openTime:this.openTime,exit:!0})},printModalShow:function(t){this.printModal=t}}});