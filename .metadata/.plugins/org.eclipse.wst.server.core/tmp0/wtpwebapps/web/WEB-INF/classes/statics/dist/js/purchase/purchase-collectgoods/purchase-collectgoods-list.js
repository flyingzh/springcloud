"use strict";var _methods;function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var pendingList=new Vue({el:"#ReceivingList",data:function(){var e,t,o,a=this;return{openTime:"",isSearchHide:!0,isTabulationHide:!0,isShow:!1,isHide:!0,isEdit:!1,reload:!1,selected:[],categoryType:[],empList:[],employees:[],commodityCategoty:[],dateArr:[],suppliers:[],body:{businessType:"",goodsTypePath:"",salesmanId:"",salesmanName:"",orderStatus:"",orderNo:"",startTime:"",endTime:""},businessTypes:[{value:"P_RECEIPT_01",name:"收货单一客户送料"},{value:"P_RECEIPT_02",name:"收货单一标准采购收货"},{value:"P_RECEIPT_03",name:"收货单一受托加工收货"},{value:"P_RECEIPT_04",name:"收货单一供应商退料"}],orderStatus:[{value:1,name:"暂存"},{value:2,name:"待审核"},{value:3,name:"审核中"},{value:4,name:"已审核"},{value:5,name:"驳回"}],data_config:{url:contextPath+"/tpurchasecollectgoods/list",colNames:["单据编号","id","日期","业务类型","供应商","业务员","单据状态","商品类型","收货重量","收货数量","合格数量","不合格数量","特别放行数量","总金额","总成本"],colModel:[{name:"orderNo",index:"orderNo",width:240,align:"left",formatter:function(e,t,o,n){return $(document).off("click",".detail"+e).on("click",".detail"+e,function(){a.view(o.id)}),'<a class="detail'+e+'">'+e+"</a>"}},{name:"id",hidden:!0},(e={name:"createTime",index:"createTime",width:120,align:"center"},_defineProperty(e,"align","left"),_defineProperty(e,"formatter",function(e,t,o,n){return e?new Date(e).format("yyyy-MM-dd"):""}),e),(t={name:"businessType",index:"businessType",width:180,align:"center"},_defineProperty(t,"align","left"),_defineProperty(t,"formatter",function(e,t,o,n){return"P_RECEIPT_01"==o.businessType?"收货单一客户送料":"P_RECEIPT_02"==o.businessType?"收货单一标准采购收货":"P_RECEIPT_03"==o.businessType?"收货单一受托加工收货":"P_RECEIPT_04"==o.businessType?"收货单一供应商退料":""}),t),{name:"supplierName",index:"supplierName",align:"left",width:250},{name:"salesmanName",index:"businessType",align:"left",width:80},(o={name:"orderStatus",index:"orderStatus",width:80,align:"center"},_defineProperty(o,"align","left"),_defineProperty(o,"formatter",function(e,t,o,n){return 1==o.orderStatus?"暂存":2==o.orderStatus?"待审核":3==o.orderStatus?"审核中":4==o.orderStatus?"已审核":5==o.orderStatus?"驳回":""}),o),{name:"goodsTypeName",index:"goodsTypeName",width:80,align:"left"},{name:"takeDeliveryWeight",index:"takeDeliveryWeight",width:80,align:"left"},{name:"takeDeliveryCount",index:"takeDeliveryCount",width:80,align:"left"},{name:"qualifiedCount",index:"qualifiedCount",align:"left",width:80},{name:"unqualifiedCount",index:"unqualifiedCount",align:"left",width:80},{name:"releaseQuantityCount",index:"releaseQuantityCount",align:"left",width:80},{name:"totalAmount",index:"totalAmount",align:"left",width:80},{name:"totalCost",index:"totalCost",align:"left",width:80}],shrinkToFit:!1}}},methods:(_methods={loadData:function(){var t=this;$.ajax({type:"post",url:contextPath+"/tpurchasecollectgoods/data",dataType:"json",success:function(e){t.employees=e.data.employees},error:function(){t.$Modal.error({content:"系统异常,请联系技术人员！"})}})},search:function(){this.body.businessType||(this.body.businessType=""),this.body.orderStatus||(this.body.orderStatus=""),this.body.salesmanName||(this.body.salesmanName=""),this.body.supplierId||(this.body.supplierId=""),this.body.goodsTypePath||(this.body.goodsTypePath=""),0<this.dateArr.length&&(this.body.startTime=this.dateArr[0]?this.dateArr[0].format("yyyy-MM-dd HH:mm:ss"):"",this.body.endTime=this.dateArr[1]?this.dateArr[1].format("yyyy-MM-dd 23:59:59"):""),this.reload=!this.reload},clear:function(){this.$refs.saleName.reset(),this.$refs.supplier.reset(),this.$nextTick(function(){this.body.salesmanName="",this.body.supplierId=""}),this.body={businessType:"",goodsTypePath:"",salesmanName:"",supplierId:"",orderStatus:"",orderNo:"",startTime:"",endTime:""},this.commodityCategoty=[],this.dateArr=[]},refresh:function(){},generateReport:function(){this.$Modal.warning({content:"请选择数据生成收货订单"})},goPurchaseAdd:function(e,t){window.parent.activeEvent({name:"采购收货单-新增",url:contextPath+"/purchase/purchase-collectgoods/purchase-collectgoods-add.html",params:e,type:t})},cancel:function(){},submit:function(){}},_defineProperty(_methods,"refresh",function(){this.clear(),this.search()}),_defineProperty(_methods,"loadProductType",function(){var t=this;$.ajax({type:"post",url:contextPath+"/documentController/getCategory?parentId=0",contentType:"application/json",dataType:"json",success:function(e){t.categoryType=t.initGoodCategory(e.data.cateLists)},error:function(e){t.$Modal.error({content:"系统异常,请联系技术人员！"})}})}),_defineProperty(_methods,"loadSuppliers",function(){var t=this;$.ajax({type:"post",url:contextPath+"/tpurchasecollectgoods/findSupplierByOrgId",dataType:"json",success:function(e){t.suppliers=e.data},error:function(){t.$Modal.error({content:"系统出现异常,请联系管理人员"})}})}),_defineProperty(_methods,"changeCategory",function(e){this.body.goodsTypePath=e[e.length-1]}),_defineProperty(_methods,"add",function(){window.parent.activeEvent({name:"采购收货单-新增",url:contextPath+"/purchase/purchase-collectgoods/purchase-collectgoods-add.html",params:"",type:2})}),_defineProperty(_methods,"modify",function(){var t=this;if(1==t.selected.length){if(1<t.selected[0].orderStatus)return void this.$Modal.confirm({content:"只能对暂存的数据进行修改！"});$.ajax({type:"post",url:contextPath+"/tpurchasecollectgoods/info?id="+t.selected[0].id,dataType:"json",success:function(e){"100100"==e.code&&t.goPurchaseAdd(e.data,3)},error:function(e){t.$Modal.error({content:"系统异常,请联系技术人员！"})}})}else this.$Modal.confirm({content:"请选择一条数据进行修改！"})}),_defineProperty(_methods,"view",function(e){var t=this;$.ajax({type:"post",url:contextPath+"/tpurchasecollectgoods/info?id="+e,dataType:"json",success:function(e){"100100"==e.code&&t.goPurchaseAdd(e.data,4)},error:function(e){t.$Modal.error({content:"系统异常,请联系技术人员！"})}})}),_defineProperty(_methods,"del",function(){var e=this;if(0<e.selected.length){var t=[];e.selected.forEach(function(e){t.push(e.id)}),this.$Modal.confirm({content:"你确定要删除选中的数据？",okText:"确定",cancelText:"取消",onOk:function(){e.deleteMany(t)}})}else this.$Modal.confirm({content:"请选择一条数据进行删除！"})}),_defineProperty(_methods,"deleteMany",function(e){var t=this;$.ajax({type:"post",url:contextPath+"/tpurchasecollectgoods/delete",data:JSON.stringify(e),dataType:"json",contentType:"application/json",success:function(e){"100100"==e.code&&setTimeout(function(){t.$Modal.info({content:e.data,onOk:function(){t.reload=!t.reload}})},300)},error:function(e){t.$Modal.error({content:"系统异常,请联系技术人员！"})}})}),_defineProperty(_methods,"initGoodCategory",function(e){var a=this,i=[];return e.forEach(function(e){var t=e.customCode,o=e.name,n=e.cateLists;n&&(n=a.initGoodCategory(n)),i.push({value:t,label:o,children:n})}),i.forEach(function(e){e.children||delete e.children}),i}),_defineProperty(_methods,"exit",function(){window.parent.closeCurrentTab({exit:!0,openTime:this.openTime})}),_methods),created:function(){this.loadProductType(),this.loadSuppliers(),this.loadData()},mounted:function(){this.openTime=window.parent.params.openTime}});