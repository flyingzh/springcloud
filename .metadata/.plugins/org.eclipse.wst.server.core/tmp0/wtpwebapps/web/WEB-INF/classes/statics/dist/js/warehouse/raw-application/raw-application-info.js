"use strict";var vm=new Vue({el:"#app",data:{numDisabled:!1,isStampShow:!1,isRequiredSupplier:!1,isRequiredCustId:!1,tabValid:!0,openTime:"",isDisabled:!1,isOpened:!1,productDetailList:[],productDetailModal:{showModal:!1,ids:{goodsId:"",commodityId:"",documentType:"W_MATERIAL_USED"}},queryCondition:{id:"",documentNo:""},organizationName:"",modalTrigger:!1,modalType:"",approvalDatas:[],stepList:[],goodsType:[],unitMap:[],isShow:!1,reload:!1,isSearchHide:!0,isTabulationHide:!0,showDepartment:!1,treeSetting:{},supplierDisabled:!0,custDisabled:!0,applicationEmpList:[],categoryType:[],customerList:[],supplierList:[],countingUnitList:[],weightUnitList:[],selectProductType:[],tabVal:"name1",ctrlMark:!0,body:{id:"",documentNo:"",documentTime:new Date||"",purchaseDocumentCode:"",custemCode:"",goodsTypeName:"",purpose:"",supplierId:"",supplierCode:"",supplierName:"",custId:"",custCode:"",custName:"",applicationDepartmentId:"",applicationDepartmentName:"",applicantId:"",applicantName:"",remark:"",documentStatus:1,delList:[],goodList:[]},commodityCodeParam:{categoryCustomCode:"",field:"",limit:""},params:{id:""},frameTab:!1,selectedIndex:null,showProductProperty:!1,OrderInfoList:[],selectPickingUse:[{value:"W_MATERIAL_USED_01",label:"采购送料"},{value:"W_MATERIAL_USED_02",label:"采购料结"},{value:"W_MATERIAL_USED_03",label:"受托加工送料"},{value:"W_MATERIAL_USED_04",label:"受托加工退料"}],other:{createName:"",createTime:"",updateName:"",updateTime:"",examineVerifyName:"",examineVerifyDate:""},isOrderInfo:!1,otherInfoDatas:{goodsTypeName:"",goodsNo:"",goodsName:"",applicationNum:"",transferCheckNum:"",transferQualifiedNum:"",transferCheckFailNum:"",transferCheckReleaseNum:"",transferCheckStatus:"",totalTransferNum:""},data_config_order:{url:contextPath+"/rawapplication/getTPurchaseOrder",datatype:"json",colNames:["单据编号","采购日期","业务类型","供应商"],colModel:[{name:"orderNo",width:150,align:"left"},{name:"purchaseDate",width:150,align:"left",formatter:function(t,e,o,i){return new Date(t).format("yyyy-MM-dd")}},{name:"businessTypeId",width:150,align:"left",formatter:function(t,e,o,i){return"P_ORDER_01"===t?"标准采购":"P_ORDER_02"===t?"受托加工采购":void 0}},{name:"supplierName",align:"left",width:150}],rowNum:5,rowList:[10,20,30],mtype:"post",viewrecords:!0}},created:function(){var t=this;t.getOrganizationName(),t.initUnit(),t.getCustomers(),t.getSppliers(),t.treeSetting={callback:{onClick:this.treeClickCallBack,beforeClick:this.treeBeforeClick}},t.loadProductType(),$.ajax({type:"post",url:contextPath+"/rawapplication/queryallempbyorganid",dataType:"json",success:function(t){vm.applicationEmpList=t.data}}),t.param=window.parent.params.params;var e=window.parent.params.params;t.getUpdateData(e.data,e.type)},mounted:function(){this.openTime=window.parent.params.openTime,$("#base-info").validate(),this.getSelect("table-responsive","goods")},computed:{sumAmountWeight:function(){if(0<this.productDetailList.length)return this.productDetailList.map(function(t){return t.applicationWeight?t.applicationWeight:0}).reduce(function(t,e){return parseFloat(e)+t},0).toFixed(3)},sumAmountNum:function(){if(0<this.productDetailList.length)return this.productDetailList.map(function(t){return t.applicationNum?t.applicationNum:0}).reduce(function(t,e){return parseFloat(e)+t},0)}},methods:{htPrint:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){htPrint()}),getSelect:function(t,e){return repositionDropdownOnSroll(t,e)},unDisabledShow:function(){this.supplierDisabled=!1,this.custDisabled=!1,this.isDisabled=!1,this.isOpened=!1,this.showDepartment=!1},disabledShow:function(){this.supplierDisabled=!0,this.custDisabled=!0,this.isDisabled=!0,this.isOpened=!0,this.showDepartment=!1},isEdit:function(t,e){eventHub.$emit("isEdit",t)},saveAccess:function(t,e,o){eventHub.$emit("saveFile",t,e)},getAccess:function(t,e,o){eventHub.$emit("queryFile",t,e)},gotoAdd:function(){window.parent.activeEvent({name:"新增原料领用申请单",url:contextPath+"/warehouse/raw-application/raw-application-info.html",params:{openTime:this.openTime}})},gotoList:function(){window.parent.activeEvent({name:"原料领用申请单列表",url:contextPath+"/warehouse/raw-application/raw-application-list.html",params:{openTime:this.openTime}})},handlerDataToPost:function(){var t=this,e={id:"",commodityId:"",pictureUrl:"",goodsNo:"",goodsName:"",goodsMainType:"",goodsNorm:"",countingUnit:"",applicationNum:"",weightUnit:"",applicationWeight:"",productStyleId:"",certificateType:"",stonesParts:[],materialParts:[],partParts:[],goldParts:[]},o=t.body;if(0<t.productDetailList.length&&null!=t.productDetailList){o.goodList=[JSON.parse(JSON.stringify(e))];htHandlerProductDetail(t.productDetailList,o,e);this.productDetailList.map(function(t,e){o.goodList[e]||(o.goodList[e]={}),Object.assign(o.goodList[e],{commodityId:t.commodityId,pictureUrl:t.pictureUrl,goodsNo:t.goodsNo,goodsName:t.goodsName,goodsNorm:t.goodsNorm,goodsMainType:t.goodsMainType,applicationWeight:t.applicationWeight,applicationNum:t.applicationNum,countingUnit:t.countingUnit,weightUnit:t.weightUnit,productStyleId:t.productStyleId,certificateType:t.certificateType,id:t.id})})}else o.goodList=[];return o},exit:function(){var t=this;$.isEmptyObject(t.param)||("update"===t.param.type?window.parent.closeCurrentTab({name:"修改原料领用申请单",openTime:this.openTime,exit:!0}):"query"===t.param.type?window.parent.closeCurrentTab({name:"查看原料领用申请单",openTime:this.openTime,exit:!0}):window.parent.closeCurrentTab({name:"新增原料领用申请单",openTime:this.openTime,exit:!0}))},initUnit:function(){var i=this;$.ajax({type:"post",url:contextPath+"/tbaseunit/list",contentType:"application/json",dataType:"json",async:!1,success:function(t){"100100"===t.code?t.data.map(function(t){var e=t.id,o=t.name;i.unitMap[e]=o}):layer.alert("服务器异常,请联系技术人员！",{icon:0})},error:function(t){layer.alert("网络异常,请联系技术人员！",{icon:0})}})},getOrganizationName:function(){var e=this;$.ajax({type:"post",url:contextPath+"/entrustOut/getOrgName",dataType:"json",success:function(t){if(window.top.home.loading("hide"),"100100"===t.code)e.organizationName=t.data.name;else if("-1"===t.code)return void vm.$Modal.warning({title:"提示信息",content:"服务器出错啦!"})},error:function(){vm.$Modal.warning({title:"提示信息",content:"服务器出错啦!"})}})},getApprovalHistory:function(t){var e=this;$.ajax({contentType:"application/json",type:"post",url:contextPath+"/rawapplication/queryReceiptsById",data:JSON.stringify({receiptsId:t}),success:function(t){t.data.forEach(function(t){t.approvalResult=1===t.approvalResult?"审核":"驳回",t.currentLevel=0===t.currentLevel?"开始":1===t.currentLevel?"一级审核":2===t.currentLevel?"二级审核":3===t.currentLevel?"三级审核":4===t.currentLevel?"四级审核":5===t.currentLevel?"五级审核":6===t.currentLevel?"六级审核":"结束","驳回"!==t.approvalResult||t.nextLevel?t.nextLevel="0"===t.nextLevel?"开始":"1"===t.nextLevel?"一级审核":"2"===t.nextLevel?"二级审核":"3"===t.nextLevel?"三级审核":"4"===t.nextLevel?"四级审核":"5"===t.nextLevel?"五级审核":"6"===t.nextLevel?"六级审核":"结束":t.nextLevel="开始"}),e.approvalDatas=t.data}})},splitCustemCode:function(t,e){for(var o=[],i=0;i<t.length;i++){var a=t.indexOf(".",e);if(-1===a)break;o.push(a),e=a+1}for(var s=1;s<o.length;s++)this.goodsType.push(t.substring(0,o[s])+".");return this.goodsType},queryOneDatas:function(t,e){var o=this;$.ajax({url:contextPath+"/rawapplication/info",contentType:"application/json",data:t,type:"post",success:function(t){o.body=t.data,o.other=t.data,o.productDetailList=Object.assign([],t.data.goodList),o.otherInfoDatas=t.data,o.goodsType=o.splitCustemCode(t.data.custemCode,0),o.selectProductType=o.goodsType,t.data.delList||(o.body.delList=[]),"update"===e&&(1!=t.data.documentStatus?(o.disabledShow(),o.isEdit("N"),$(".is-disabled:gt(0):lt(2)").css("pointer-events","none").css({color:"#bbbec4"})):(t.data.purpose&&o.purposeChange(t.data.purpose),o.isEdit("Y"))),4===t.data.documentStatus&&(o.isStampShow=!0),o.getApprovalHistory(t.data.documentNo),o.getAccess(t.data.documentNo,"W_MATERIAL_USED")}})},loadProductType:function(){var e=this;$.ajax({type:"post",url:contextPath+"/rawapplication/queryStyleCategory?parentId=0",contentType:"application/json",dataType:"json",success:function(t){e.categoryType=e.initGoodCategory(t.data.cateLists)},error:function(){alert("服务器出错啦")}})},purposeChange:function(t){var e=this;this.isRequiredSupplier="W_MATERIAL_USED_04"!=t?(this.supplierDisabled=!1,!(this.isRequiredCustId=!1)):(this.supplierDisabled=!0,this.body.supplierId&&(this.$refs.supplier.reset(),this.$nextTick(function(){e.body.supplierId=""})),!(this.isRequiredCustId=!0)),"W_MATERIAL_USED_03"===t||"W_MATERIAL_USED_04"===t?(this.custDisabled=!1,this.isRequiredCustId=!0):(this.custDisabled=!0,this.body.custId&&(this.$refs.cust.reset(),this.$nextTick(function(){e.body.custId=""})))},initGoodCategory:function(t){var a=this,s=[];return t.forEach(function(t){var e=t.customCode,o=t.name,i=t.cateLists;i&&(i=a.initGoodCategory(i)),s.push({value:e,label:o,children:i})}),s.forEach(function(t){t.children||delete t.children}),s},changeproductTypeName:function(e,o){var i=this;if(i.goodsType.length<1)return i.body.custemCode=o[o.length-1].value,i.body.goodsTypeName=o[o.length-1].label,void(i.selectProductType=e);i.goodsType!=o&&0<i.productDetailList.length&&i.$Modal.confirm({content:"修改商品类型会清空商品简述和商品明细列表的所有数据，是否确定修改？",onOk:function(){for(var t in 0<o.length?(i.body.custemCode=o[o.length-1].value,i.body.goodsTypeName=o[o.length-1].label):i.body.custemCode="",i.selectProductType=e,i.productDetailList)i.productDetailList[t].id&&i.body.delList.push(i.productDetailList[t].id);i.productDetailList=[],i.$forceUpdate()},onCancel:function(){i.goodsType=i.selectProductType,i.$forceUpdate()}})},getCustomers:function(){var e=this;$.ajax({type:"post",url:contextPath+"/rawapplication/queryAllCustomer",dataType:"json",success:function(t){e.customerList=t.data}})},getSppliers:function(){var e=this;$.ajax({type:"post",url:contextPath+"/rawapplication/getSuppliers",dataType:"json",success:function(t){e.supplierList=t.data}})},approval:function(t){this.modalType="approve",this.modalTrigger=!this.modalTrigger},reject:function(){this.modalType="reject",this.modalTrigger=!this.modalTrigger},approvalOrRejectCallBack:function(t){var e=this;if("100100"===t.result.code){if(e.body.documentStatus=parseInt(t.result.data),4===e.body.documentStatus){var o=JSON.stringify({id:e.body.id});e.queryOneDatas(o)}1===e.body.documentStatus&&($(".is-disabled:gt(0):lt(2)").css({"pointer-events":"auto "}).css({color:"#495060"}),e.unDisabledShow(),e.purposeChange(e.body.purpose),e.isEdit("Y"))}e.getApprovalHistory(e.body.documentNo)},autoApproveOrReject:function(){var o=this;$.ajax({url:contextPath+"/rawapplication/submitapproval?submitType=1",method:"post",contentType:"application/json;charset=utf-8",data:JSON.stringify({receiptsId:o.body.documentNo,approvalResult:"reject"==o.modalType?1:0}),success:function(t){if("100100"===t.code){if(o.body.documentStatus=parseInt(t.data),1==o.body.documentStatus){var e=JSON.stringify({id:o.body.id});o.queryOneDatas(e),o.getApprovalHistory(o.body.documentNo)}}else o.$Modal.warning({content:t.msg})}})},tabValidate:function(){var o=this;$.each(o.productDetailList,function(t,e){return e.applicationNum&&e.applicationWeight?o.tabValid=!0:o.tabValid=!1})},rowClick:function(t,e){var o=this;if("add"===t&&this.validateProduct()){if(""===o.body.custemCode)return void o.$Modal.warning({title:"提示信息",content:"请先选择商品类型！"});o.productDetailList.push({id:"",commodityId:"",pictureUrl:"",goodsNo:"",goodsName:"",goodsMainType:"",goodsNorm:"",countingUnit:"",applicationNum:"",weightUnit:"",applicationWeight:"",productStyleId:""}),o.tabValid=!0,o.$nextTick(function(){o.getSelect("table-responsive","goods")}),o.commodityCodeParam.categoryCustomCode=o.body.custemCode,$.ajax({type:"post",url:contextPath+"/tbasecommodity/findByType",data:o.commodityCodeParam,dataType:"json",success:function(t){Object.assign(o.productDetailList[o.productDetailList.length-1],{options:t.data}),o.$forceUpdate()},error:function(t){layer.alert("服务器出错啦")}})}else if("copy"===t&&o.validateProduct()){if(null===o.selectedIndex)o.$Message.warning({title:"提示信息",content:"请选择一条数据！"});else{var i=Object.assign({},o.productDetailList[o.selectedIndex]);i.id="",o.$nextTick(function(){o.productDetailList.push(i)}),o.selectedIndex=null}o.tabValid=!0,o.$nextTick(function(){o.getSelect("table-responsive","goods")})}},valueVerify:function(){},showDepartmentTree:function(t){this.isDisabled||(this.showDepartment=t)},treeClickCallBack:function(t,e,o){this.body.applicationDepartmentName=o.name,this.body.applicationDepartmentId=o.id,this.showDepartment=!1},treeBeforeClick:function(t,e,o){return!e.isParent},getSelectedItem:function(t,i){var a=this;$.ajax({type:"post",url:contextPath+"/tbasecommodity/getBriefById/"+t.id,dataType:"json",success:function(t){var e=t.data,o={goodsNo:"",goodsName:"",commodityId:"",pictureUrl:null,goodsNorm:"",countingUnit:"",weightUnit:"",goodsMainType:"",productStyleId:"",certificateType:""};o.goodsNo=e.code,o.goodsName=e.name,o.commodityId=e.id,o.goodsNorm=e.specification,o.productStyleId=e.styleCategoryId,e.frontPic&&(o.pictureUrl=e.frontPic.fdUrl),o.goodsMainType=e.mainType,o.countingUnit=a.unitMap[e.countUnitId],o.weightUnit=a.unitMap[e.weightUnitId],"attr_ranges_gold"===e.mainType&&(o.certificateType=e.certificateType,o.applicationNum=""),Vue.set(a.productDetailList,i,o),a.$forceUpdate()},error:function(){layer.alert("服务器出错啦")}})},getInputValue:function(t,e){var o=this;""!==o.body.custemCode&&null!==o.body.custemCode?(o.commodityCodeParam.categoryCustomCode=o.body.custemCode,o.commodityCodeParam.field=t,$.ajax({type:"post",url:contextPath+"/tbasecommodity/findByType",data:o.commodityCodeParam,dataType:"json",success:function(t){Object.assign(o.productDetailList[e],{options:t.data}),o.$forceUpdate()},error:function(t){layer.alert("服务器出错啦")}})):o.$Modal.warning({title:"提示信息",content:"请先选择商品类型"})},selectProductDetail:function(t){this.selectedIndex=t},productDetailId:function(t,e){var o=this,i={goodsId:e.id,commodityId:e.commodityId,documentType:"W_MATERIAL_USED"};Object.assign(this.productDetailModal,{showModal:!1,ids:i});var a=void 0;this.$nextTick(function(){a=o.$refs.modalRef.getParts(),console.log(a)}),"attr_ranges_goods"===this.productDetailList[t].goodsMainType?Object.assign(this.productDetailList[t],{tBaseBomEntity:a,assistAttrs:null,overEdit:!0}):Object.assign(this.productDetailList[this.selectedIndex],{assistAttrs:a,tBaseBomEntity:null,overEdit:!0})},showProductDetail:function(t){var e=this;if(this.selectedIndex=t,e.productDetailList[t].commodityId){var o={goodsId:this.productDetailList[t].id,commodityId:this.productDetailList[t].commodityId,documentType:"W_MATERIAL_USED"};Object.assign(this.productDetailModal,{showModal:!0,ids:o}),this.$nextTick(function(){e.$refs.modalRef.getProductDetail()})}else e.$Modal.warning({title:"提示信息",content:"请先选择商品"})},modalSure:function(t){this.productDetailModalClick(t)},modalCancel:function(t){},productDetailModalClick:function(t){"attr_ranges_goods"===this.productDetailList[this.selectedIndex].goodsMainType?Object.assign(this.productDetailList[this.selectedIndex],{tBaseBomEntity:t,assistAttrs:null,overEdit:!0}):Object.assign(this.productDetailList[this.selectedIndex],{assistAttrs:t,tBaseBomEntity:null,overEdit:!0})},validateProduct:function(){var o=!0,i=this;return $.each(i.productDetailList,function(t,e){if(console.log(e,t),e.id)return!0;if("attr_ranges_goods"==e.goodsMainType){if(!e.tBaseBomEntity)return o=!1,i.$Modal.error({content:"第"+(t+1)+"行商品明细未选择，请先选择商品明细！"}),!1}else if(!e.assistAttrs)return o=!1,i.$Modal.error({content:"第"+(t+1)+"行商品明细未选择，请先选择商品明细！"}),!1}),o},submit:function(){this.tabValid=!1;var e=this;if(1==e.body.documentStatus){if(null===e.productDetailList||e.productDetailList.length<1)e.$Modal.warning({title:"提示信息",content:"请添加商品！"});else if($("#base-info").valid()&&e.validateProduct()&&!e.tableValidate()){e.body.documentStatus=2,e.getCodeAndName();var t=e.handlerDataToPost();e.body.documentNo?(window.top.home.loading("show"),$.ajax({contentType:"application/json",type:"post",data:JSON.stringify(t),url:contextPath+"/rawapplication/update",success:function(t){t.data?(e.body=t.data,e.other=t.data,t.data.goodList&&(e.productDetailList=Object.assign([],t.data.goodList)),e.otherInfoDatas=t.data,t.data.custemCode&&(e.goodsType=e.splitCustemCode(t.data.custemCode,0),e.selectProductType=e.goodsType),t.data.delList&&(e.body.delList=t.data.delList),e.$Modal.success({title:"提示信息",content:"提交成功！"}),1!=t.data.documentStatus&&(e.disabledShow(),$(".is-disabled:gt(0):lt(2)").css("pointer-events","none").css({color:"#bbbec4"})),e.saveAccess(t.data.documentNo,"W_MATERIAL_USED"),e.saveAccess(t.data.documentNo,"W_MATERIAL_USED"),e.isEdit("N")):e.$Modal.error({title:"提示信息",content:"提交失败！"}),window.top.home.loading("hide")},error:function(){window.top.home.loading("hide")}})):(window.top.home.loading("show"),$.ajax({contentType:"application/json",type:"post",data:JSON.stringify(t),url:contextPath+"/rawapplication/save",success:function(t){t.data?(e.body=t.data,e.other=t.data,t.data.goodList&&(e.productDetailList=Object.assign([],t.data.goodList)),e.otherInfoDatas=t.data,t.data.custemCode&&(e.goodsType=e.splitCustemCode(t.data.custemCode,0),e.selectProductType=e.goodsType),t.data.delList&&(e.body.delList=t.data.delList),e.$Modal.success({title:"提示信息",content:"提交成功！"}),1!=t.data.documentStatus&&(e.disabledShow(),$(".is-disabled:gt(0):lt(2)").css("pointer-events","none").css({color:"#bbbec4"})),e.saveAccess(t.data.documentNo,"W_MATERIAL_USED"),e.saveAccess(t.data.documentNo,"W_MATERIAL_USED"),e.isEdit("N")):e.$Modal.error({title:"提示信息",content:"提交失败！"}),window.top.home.loading("hide")},error:function(){window.top.home.loading("hide")}}))}}else e.$Modal.warning({title:"提示信息",content:"单据状态不为暂存不能提交！"})},getCodeAndName:function(){var t=this;if(t.body.supplierId)for(var e in t.supplierList)if(t.supplierList[e].id===t.body.supplierId){t.body.supplierCode=t.supplierList[e].supplierCode,t.body.supplierName=t.supplierList[e].supplierName;break}if(t.body.custId)for(var o in t.customerList)if(t.customerList[o].id===t.body.custId){t.body.custCode=t.customerList[o].code,t.body.custName=t.customerList[o].name;break}if(t.body.applicantId)for(var i in t.applicationEmpList)if(t.applicationEmpList[i].id===t.body.applicantId){t.body.applicantName=t.applicationEmpList[i].empName;break}},tableValidate:function(){return htValidateRow(this.productDetailList,{goodsNo:{name:"商品编码",type:"string"},applicationWeight:{name:"申请重量",type:"number",floor:3},applicationNum:{name:"申请数量",type:"number",empty:!0}})},clearNoNumber:function(t,e,o){return htInputNumber(t,e,o)},save:function(){var e=this;e.getCodeAndName();var t=e.handlerDataToPost();e.validateProduct()&&(e.body.id?(window.top.home.loading("show"),$.ajax({type:"post",url:contextPath+"/rawapplication/update",data:JSON.stringify(t),contentType:"application/json",dataType:"json",success:function(t){t.data?(e.body=t.data,e.other=t.data,t.data.goodList&&(e.productDetailList=Object.assign([],t.data.goodList)),e.otherInfoDatas=t.data,t.data.custemCode&&(e.goodsType=e.splitCustemCode(t.data.custemCode,0),e.selectProductType=e.goodsType),t.data.delList&&(e.body.delList=t.data.delList),e.$Modal.success({title:"提示信息",content:"保存成功！"}),1!=t.data.documentStatus&&e.disabledShow(),e.saveAccess(t.data.documentNo,"W_MATERIAL_USED"),e.saveAccess(t.data.documentNo,"W_MATERIAL_USED"),e.isEdit("Y")):e.$Modal.error({title:"提示信息",content:"保存失败！"}),window.top.home.loading("hide")},error:function(){window.top.home.loading("hide")}})):(window.top.home.loading("show"),$.ajax({type:"post",url:contextPath+"/rawapplication/save",data:JSON.stringify(t),contentType:"application/json",dataType:"json",success:function(t){t.data?(e.body=t.data,e.other=t.data,e.productDetailList=Object.assign([],t.data.goodList),t.data.custemCode&&(e.goodsType=e.splitCustemCode(t.data.custemCode,0),e.selectProductType=e.goodsType),t.data.delList&&(e.body.delList=t.data.delList),e.otherInfoDatas=t.data,e.$Modal.success({title:"提示信息",content:"保存成功！"}),1!=t.data.documentStatus&&e.disabledShow(),e.saveAccess(t.data.documentNo,"W_MATERIAL_USED"),e.saveAccess(t.data.documentNo,"W_MATERIAL_USED"),e.isEdit("Y")):e.$Modal.error({title:"提示信息",content:"保存失败！"}),window.top.home.loading("hide")},error:function(){window.top.home.loading("hide")}})))},orderAction:function(){this.isDisabled||(this.isOrderInfo=!0)},backAction:function(){if(1!=vm.OrderInfoList.length)return vm.$Message.warning("请选择一条采购订单"),!1;var t=$("#orderInfo"),e=t.jqGrid("getGridParam","selrow"),o=t.jqGrid("getRowData",e);this.isOrderInfo=!1,this.body.purchaseDocumentCode=o.orderNo},exitAction:function(){this.isOrderInfo=!1},action2:function(){null===this.selectedIndex?this.$Message.warning({title:"提示信息",content:"请选择一条数据！"}):(this.productDetailList[this.selectedIndex].id&&this.body.delList.push(this.productDetailList[this.selectedIndex].id),this.productDetailList.splice(this.selectedIndex,1),this.$forceUpdate(),this.selectedIndex=null)},action1:function(t){this.selectedIndex=t},detailAction:function(t){var e=this;if(t)for(var o in e.productDetailList)if(e.productDetailList[o].id===t){e.otherInfoDatas=e.productDetailList[o],e.tabVal="name2",console.log(e.otherInfoDatas),1===e.otherInfoDatas.transferCheckStatus?e.otherInfoDatas.transferCheckStatus="已质检":e.otherInfoDatas.transferCheckStatus="待质检";break}},tabsSwitch:function(t){this.tabVal=t},getImage:function(t){this.productDetailList.pictureUrl=t.currentTarget.src},getUpdateData:function(t,e){var o;"update"===e?(o=JSON.stringify({id:t}),this.queryOneDatas(o,e)):"query"===e?(this.disabledShow(),$(".is-disabled").css("pointer-events","none").css({color:"#bbbec4"}),o=JSON.stringify({documentNo:t}),this.queryOneDatas(o,e),this.isEdit("N")):this.isEdit("Y")}},watch:{"body.supplierId":function(){this.body.supplierId&&($("#orderInfo").jqGrid("clearGridData"),$("#orderInfo").jqGrid("setGridParam",{postData:{supplierId:this.body.supplierId}}).trigger("reloadGrid"))}}});