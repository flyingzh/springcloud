"use strict";var _methods;function _defineProperty(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}Vue.component("edit-formula",{data:function(){var t;return _defineProperty(t={show:this.value,dataList:[],operate:[{label:"1001 库存现金",value:1},{label:"100101 现金",value:11},{label:"100102 库存外币",value:12},{label:"1002 银行存款",value:2}],subject:"",subjectVisable:!1,reload:!0,curTable:"",currentSelectRow:"",addData:[],delDdata:[]},"subjectVisable",!1),_defineProperty(t,"formData",{discountSubjectId:0,discountSubjectCode:"",discountSubject:""}),t},methods:(_methods={showSubjectVisable:function(){this.subjectVisable=!0},subjectClose:function(){this.subjectVisable=!1},subjectData:function(t){console.log(t,"====treeNode"),this.formData.discountSubjectId=t.id,this.formData.discountSubjectCode=t.subjectCode,this.formData.discountSubject=t.subjectName},editClick:function(t){console.log(t)},closeModal:function(){this.$emit("close")},selectSub:function(){this.subjectVisable=!0}},_defineProperty(_methods,"subjectClose",function(){this.subjectVisable=!1}),_defineProperty(_methods,"cancleRemark",function(){}),_defineProperty(_methods,"delRemark",function(){}),_defineProperty(_methods,"subjectDate",function(t){this.subject=t,console.log("确定科科目信息: ",t)}),_defineProperty(_methods,"add",function(){this._ajaxAddData(),this.addData&&0<this.addData.length&&(this.dataList.unshift(this.addData[0]),this.addData=[])}),_defineProperty(_methods,"_ajaxAddData",function(){var e=this,t=this.accountYearPeriod.split("_"),a="/web/reportProfit/formulaAmount?accountYear="+t[0]+"&accountPeriod="+t[1]+"&accountId="+this.formData.discountSubjectId+"&tableName=lrb&valueRule=1";$.ajax({type:"POST",data:"",url:a,dataType:"json",async:!1,success:function(t){e.addData[0]=t.data},error:function(t){console.log(t)}})}),_defineProperty(_methods,"save",function(){this._ajaxSaveData(),this.$emit("reflist")}),_defineProperty(_methods,"_ajaxSaveData",function(){var e=this,a=[];if(e.dataList.forEach(function(t){(!t.id||t.id<0)&&a.push(t)}),e.delData.forEach(function(t){0<t.id&&(t.status=2,a.push(t))}),a.length<=0)return alert("数据没有发生变化!"),!1;a.forEach(function(t){delete t.account,t.reportContentId=reportVue.reportContentId,t.reportContentName=reportVue.reportContentName});var t=contextPath+"/reportProfit/formulaSave";$.ajax({type:"POST",data:JSON.stringify(a),url:t,dataType:"json",contentType:"application/json;charset=utf-8",success:function(t){e.$Message.success(t.msg),e.$emit("close"),e.delData=[],e.addData=[],e.dataList=[],e.$emit("reflist")},error:function(t){console.log(t)}})}),_defineProperty(_methods,"_ajaxList",function(){var a=this;a.addData=[],a.delData=[],a.dataList=[];var t=this.accountYearPeriod.split("_"),e="/web/reportProfit/formulaList?accountYear="+t[0]+"&accountPeriod="+t[1]+"&tableName=lrb&reportContentId="+reportVue.reportContentId;$.ajax({type:"POST",data:"",url:e,dataType:"json",async:!1,success:function(t){var e=t.data;a.dataList=e||[]},error:function(t){console.log(t)}})}),_defineProperty(_methods,"refresh",function(){}),_defineProperty(_methods,"clickTr",function(t){this.currentSelectRow=t.id,this.curTable="2"}),_defineProperty(_methods,"table2ChickTr2",function(){}),_defineProperty(_methods,"del",function(e){var a=this;console.log(e);var t=this.dataList.findIndex(function(t){return t.id==e.id});t<0||this.dataList.splice(t,1).forEach(function(t){a.delData.push(t)})}),_defineProperty(_methods,"formatNum",function(t,e){var a=Math.pow(1e3,e);return parseInt(t*a,10)/a}),_methods),watch:{value:function(t){(this.show=t)&&this._ajaxList()}},computed:{totalAmount1:function(){var e=this,a=0;return this.dataList.forEach(function(t){a+=e.formatNum(t.amount1,1)}),(a=accounting.formatMoney(a,"",2))||0},totalAmount2:function(){var e=this,a=0;return this.dataList.forEach(function(t){a+=e.formatNum(t.amount2,1)}),(a=accounting.formatMoney(a,"",2))||0}},filters:{filterMoney:function(t){return accounting.formatMoney(t,"",2)}},props:["title","value","accountYearPeriod"],template:'\n        <div>\n            <Modal\n                :title=\'title\'\n                v-model="show"\n                width="800"\n                @on-cancel=\'closeModal\'\n                :mask-closable="false">\n                <label>科目：</label>\n               \n                <i-input v-model="formData.discountSubject" style="width:200px" readonly="true" @on-click="showSubjectVisable" icon="ios-list-outline" type="text"></i-input>\n\n                <i-button @click="add">添加</i-button>\n                <div class="ht-receivableW-table mt10"> \n                    <div class="ht-wrapper-tbl">\n                        <table class="table tablediv">\n                            <thead>\n                            <tr>\n                                <td class="wt200">项目</td>\n                                <td class="wt100">运算方式</td>\n                                <td class="wt125">本年累计金额</td>\n                                <td class="wt100">本月金额</td>\n                                <td class="wt80">操作</td>\n                            </tr>\n                            </thead>\n                            <tbody >\n                            <tr lay-size="sm" v-for="(item,idx) in dataList" @click="clickTr(item)"  :class="{success: currentSelectRow === item.id}" >     \n                                <td class="wt200">{{item.account}}</td>\n                                <td class="wt100">{{item.computeType}}</td>\n                                <td class="wt125">{{item.amount1 | filterMoney}}</td>\n                                <td class="wt100">{{item.amount2 | filterMoney}}</td>\n                                <td class="wt80">\n                                    <Icon type="close-round" @click="del(item)"></Icon>\n                                </td>\n                            </tr>\n                            </tbody>\n                            <tfoot>\n                            <tr>\n                                <td class="wt200">合计</td>\n                                <td class="wt100"></td>\n                                <td class="wt125">{{totalAmount1}}</td>\n                                <td class="wt100">{{totalAmount2}}</td>\n                                <td class="wt80"></td>    \n                            </tr>\n                            </tfoot>\n                        </table>\n                    </div>\n                </div>\n                <div slot="footer">\n                    <i-button type="primary" @click="save">确定</i-button>\n                    <i-button @click="closeModal">取消</i-button>\n                </div>\n            </Modal>\n            <ht-modal-subject v-model="subjectVisable" @close="subjectClose" @save="subjectData" ref="modalSubject"></ht-modal-subject>\n        </div>\n    '});