"use strict";function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var unSourceDocument=new Vue({el:"#unSourceDocument",data:function(){var e,o=this;return _defineProperty(e={isShow:!1,isEdit:!1,reload:!1,isSearchHide:!0,showSupplierModal:!1,openTime:"",isTabulationHide:!0,isHide:!0,selected:[],commodityCategoty:[],confirmConfig:{showConfirm:!1,title:"提示",content:"请点击确认",onlySure:!0,success:!0},docType:[],dataValue:[],categoryType:[]},"commodityCategoty",[]),_defineProperty(e,"body",{goodsTypePath:"",supplier:"",supplierId:"",businessType:"",startTime:"",endTime:"",orderStatus:"",orderNo:""}),_defineProperty(e,"data_config",{url:contextPath+"/certificateOutbreaks/findListByTypePage",colNames:["日期","单据编号","单据状态","供应商","商品类型","业务类型","证书类型","证书数量","发货重量"],colModel:[{name:"deliveryDate",index:"deliveryDate",align:"left",width:320,formatter:function(e,t,i,n){return null==e&&""==e?"":e.substr(0,10)}},{name:"orderNo",index:"orderNo",width:360,align:"left",formatter:function(e,t,i,n){return $(document).off("click",".detail"+e).on("click",".detail"+e,function(){o.detailClick({value:e,grid:t,rows:i,state:n})}),'<a class="detail'+e+'">'+e+"</a>"}},{name:"orderStatus",index:"orderStatus",width:310,align:"left",formatter:function(e,t,i,n){return 1==e?"暂存":2==e?"待审批":3==e?"审批中":4==e?"已审批":"驳回"}},{name:"supplier",index:"supplier",width:310,align:"left"},{name:"goodsTypeName",index:"goodsTypeName",width:310,align:"left"},{name:"businessType",index:"businessType",width:310,align:"left",formatter:function(e,t,i,n){return"P_CREDENTIAL_OUT_01"==e?"标配证书":"特种证书"}},{name:"certificateType",index:"certificateType",width:310,align:"left"},{name:"certificateNumber",index:"certificateNumber",width:310,align:"left"},{name:"deliverWeight",index:"deliverWeight",width:310,align:"left"}]}),e},methods:{changeDate:function(e){var t=e[0].replace(/\//g,"-"),i=e[1].replace(/\//g,"-");null!=t&&""!=t&&null!=i&&""!=i&&(this.body.startTime=t+" 00:00:00",this.body.endTime=i+" 23:59:59")},handleClear:function(){this.body.startTime=null,this.body.endTime=null},search:function(){this.reload=!this.reload},detailClick:function(e){var t=e.rows.id;window.parent.activeEvent({name:"外发证书单详情",url:contextPath+"/purchase/certificateOutbreaks/certificate-add.html",params:{type:"id",id:t}})},clear:function(){this.commodityCategoty=[],this.body={goodsTypePath:"",supplier:"",supplierId:"",businessType:null,startTime:"",endTime:"",orderStatus:null,orderNo:""},this.dataValue=[],this.commodityCategoty=[]},selectSupplier:function(){this.showSupplierModal=!this.showSupplierModal},closeSupplierModal:function(){this.showSupplierModal=!1},closeTab:function(){window.parent.closeCurrentTab({openTime:this.openTime,exit:!0})},view:function(){},reloadAgain:function(){this.clear(),this.reload=!this.reload},loadProductType:function(){var t=this;$.ajax({type:"post",url:contextPath+"/documentController/getCategory?parentId=0",dataType:"json",success:function(e){console.log(e),t.categoryType=t.initGoodCategory(e.data.cateLists)},error:function(){alert("服务器出错啦")}})},initGoodCategory:function(e){var o=this,a=[];return e.forEach(function(e){var t=e.customCode,i=e.name,n=e.cateLists;n&&(n=o.initGoodCategory(n)),a.push({value:t,label:i,children:n})}),a.forEach(function(e){e.children||delete e.children}),a},changeGoodsTypePath:function(e){console.log(e),this.body.goodsTypePath=e[e.length-1],console.log(this.body.goodsTypePath)},hideSearch:function(){this.isHide=!this.isHide,this.isSearchHide=!this.isSearchHide,$(".chevron").css("top","")},hidTabulation:function(){this.isHide=!this.isHide,this.isTabulationHide=!this.isTabulationHide,this.isTabulationHide?$(".chevron").css("top",""):$(".chevron").css("top","90%")},rcv:function(e,t,i){console.log(e,t,i),this.body.supplierId=e,this.body.supplier=i},add:function(){window.parent.activeEvent({name:"新增证书外发单",url:contextPath+"/purchase/certificateOutbreaks/certificate-add.html",params:{type:"add"}})},deleteList:function(){var e=this,o=this;o.selected.length<1?o.$Modal.warning({content:"请至少选择一条数据！"}):o.$Modal.confirm({content:"您要删除该单据吗？",onOk:function(){var i=!0,n=[];$.each(e.selected,function(e,t){if(1!=t.orderStatus)return i=!1,void setTimeout(function(){o.$Modal.warning({content:"单据编号为"+t.orderNo+"的单据已提交或审核不可以删除！"})},300);n.push(t.id)}),i&&$.ajax({type:"post",url:contextPath+"/certificateOutbreaks/deleteList",contentType:"application/json",data:JSON.stringify(n),success:function(e){console.log(e),"100100"===e.code?setTimeout(function(){o.$Modal.success({content:"删除成功！",onOk:function(){o.reloadAgain()}})},300):setTimeout(function(){o.$Modal.warning({content:"删除失败！请重试！"})},300)},error:function(){o.$Modal.warning({content:"系统错误，请重试！"})}})}})}},mounted:function(){this.openTime=window.parent.params.openTime,this.loadProductType()}});