"use strict";var menuItem=Vue.extend({name:"menu-item",props:{item:{}},template:["<li>",'<a v-if="item.type == 0" href="javascript:;">','<i v-if="item.icon != null" :class="item.icon"></i>',"<span>{{item.name}}</span>",'<i class="fa fa-angle-left pull-right"></i>',"</a>",'<ul v-if="item.type == 0" class="treeview-menu">','<menu-item :item="item" v-for="item in item.list"></menu-item>',"</ul>",'<a v-if="item.type == 1" :href="\'#\'+item.url"><i v-if="item.icon != null" :class="item.icon"></i><i v-else class="fa fa-circle-o"></i> {{item.name}}</a>',"</li>"].join("")});$(window).on("resize",function(){var e=$(".content");e.height($(this).height()-120),e.find("iframe").each(function(){$(this).height(e.height())})}).resize(),Vue.component("menuItem",menuItem);var vm=new Vue({el:"#rrapp",data:{user:{},menuList:{},main:"sys/main.html",password:"",newPassword:"",navTitle:"控制台"},methods:{getMenuList:function(e){$.getJSON("sys/menu/userMenu?_"+$.now(),function(e){vm.menuList=e.menuList})},getUser:function(){$.getJSON("sys/user/info?_"+$.now(),function(e){vm.user=e.user})},updatePassword:function(){layer.open({type:1,skin:"layui-layer-molv",title:"修改密码",area:["550px","270px"],shadeClose:!1,content:jQuery("#passwordLayer"),btn:["修改","取消"],btn1:function(t){var e="password="+vm.password+"&newPassword="+vm.newPassword;$.ajax({type:"POST",url:"sys/user/password",data:e,dataType:"json",success:function(e){0==e.code?(layer.close(t),layer.alert("修改成功",function(e){location.reload()})):layer.alert(e.msg)}})}})}},created:function(){this.getMenuList(),this.getUser()},updated:function(){var e=new Router;routerList(e,vm.menuList),e.start()}});function routerList(e,t){for(var i in t){var n=t[i];0==n.type?routerList(e,n.list):1==n.type&&e.add("#"+n.url,function(){var e=window.location.hash;vm.main=e.replace("#",""),$(".treeview-menu li").removeClass("active"),$("a[href='"+e+"']").parents("li").addClass("active"),vm.navTitle=$("a[href='"+e+"']").text()})}}