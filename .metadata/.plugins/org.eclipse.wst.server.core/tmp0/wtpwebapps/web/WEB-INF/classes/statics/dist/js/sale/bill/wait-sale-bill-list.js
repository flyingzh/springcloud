"use strict";var waitSaleBill=new Vue({el:"#wait-sale-bill-list",data:function(){var o=this;return{isShow:!1,isEdit:!1,reload:!1,openTime:"",openName:"",isHideSearch:!0,isHideList:!0,isHide:!0,selected:[],dataValue:[],businessType:{},body:{outStockNo:"",custName:"",startTime:"",endTime:"",isDel:1},data_config:{url:contextPath+"/saleBillController/listByPageForWaitBill",colNames:["id","计价方式","源单类型","单据编号","日期","业务类型","客户编号","客户","总数量","总重量","实际销售金额"],colModel:[{name:"id",index:"id",hidden:!0},{name:"pricingMethod",index:"outStockNopricingMethod",hidden:!0},{name:"",index:"",width:200,align:"left",formatter:function(t,e,i,n){return"销售出库单"}},{name:"outStockNo",index:"outStockNo",width:250,align:"left",formatter:function(t,e,i,n){var a=".detail"+t;return $(document).off("click",a).on("click",a,function(){o.detailClick({value:t,grid:e,rows:i,state:n})}),'<a class="detail'+t+'">'+t+"</a>"}},{name:"createTime",index:"createTime",width:240,align:"left",formatter:function(t,e,i,n){return new Date(t).format("yyyy-MM-dd")}},{name:"businessType",index:"businessType",align:"left",width:240,formatter:function(t,e,i,n){return"S_CUST_ORDER_02"===t?"受托加工销售":"S_CUST_ORDER_01"===t?"普通销售":""}},{name:"custNo",index:"outStockNocustNo",hidden:!0},{name:"custName",index:"outStockNocustName",align:"left",width:200},{name:"totalNum",index:"totalNum",align:"right",width:200,formatter:function(t,e,i,n){var a=0;return t&&(a=t.toFixed(2)),a}},{name:"totalWeight",index:"totalWeight",align:"right",width:200,formatter:function(t,e,i,n){var a=0;return t&&(a=t.toFixed(2)),a}},{name:"totalSaleAmount",index:"totalSaleAmount",align:"right",width:200,formatter:function(t,e,i,n){var a=0;return t&&(a=t.toFixed(2)),a}}],multiselect:!0}}},methods:{changeDate:function(t){this.body.startTime=""===t[0]?"":t[0].replace(/\//g,"-")+" 00:00:00",this.body.endTime=""===t[1]?"":t[1].replace(/\//g,"-")+" 23:59:59"},search:function(){this.reload=!this.reload},clear:function(){this.$refs.bType.reset(),this.$nextTick(function(){this.body.businessType=""}),this.body={outStockNo:"",custName:"",startTime:"",endTime:"",isDel:1},this.dataValue=[]},detailClick:function(t){var e=t.rows.outStockNo;console.log(e),window.parent.activeEvent({name:"销售出库单-查看",url:contextPath+"/sale/saleoutstock/saleoutstock-add.html",params:{type:"other",data:e}})},refresh:function(){this.clear(),this.reload=!this.reload,this.selected=[]},addSaleBill:function(){if(console.log(this.selected,"出库单List"),!ht.util.hasValue(this.selected,"array"))return this.$Modal.warning({title:"提示",content:"请先选择一条记录"}),!1;if(1<this.selected.length)for(var t=this.selected[0].custNo,e=this.selected[0].pricingMethod,i=1;i<this.selected.length;i++){if(t!==this.selected[i].custNo)return this.$Modal.warning({content:"客户不一致"}),!1;if(e!==this.selected[i].pricingMethod)return this.$Modal.warning({content:"计价方式一致"}),!1}window.parent.activeEvent({name:"销售结算单-新增",url:contextPath+"/sale/bill/sale-bill-add.html",params:{data:this.selected,type:"add"}})},exit:function(){window.parent.closeCurrentTab({name:this.openName,exit:!0,openTime:this.openTime})},loadData:function(){this.businessType=getCodeList("jxc_xsckd_xsckd_ywlx")}},created:function(){this.loadData()},mounted:function(){this.openTime=window.parent.params.openTime,this.openName=window.parent.params.name}});