"use strict";var unSourceDocument=new Vue({el:"#unSourceDocument",data:function(){return{isShow:!1,isEdit:!1,reload:!1,isSearchHide:!0,openTime:"",isTabulationHide:!0,isHide:!0,selected:[],confirmConfig:{showConfirm:!1,title:"提示",content:"请点击确认",onlySure:!0,success:!0},docType:[],dataValue:[],categoryType:[],commodityCategoty:[],body:{businessType:"",goodsTypePath:"",startTime:"",endTime:"",orderNo:""},data_config:{url:contextPath+"/certificateOutbreaks/findOutGoingList",colNames:["源单类型","日期","单据编号","商品类型","业务类型","证书数量","发货重量"],colModel:[{name:"businessType",index:"businessType",width:310,align:"left",formatter:function(e,t,i,o){return"P_RECEIPT_02"==e?"收货单－标准采购":"P_RECEIPT_03"==e?"收货单－受托加工":void 0}},{name:"createTime",index:"createTime",align:"left",width:310},{name:"orderNo",index:"sourceNo",width:360,align:"left"},{name:"goodsTypeName",index:"goodsTypeName",width:310,align:"left"},{name:"businessType",index:"businessType",width:310,align:"left",formatter:function(e,t,i,o){return"标配证书"}},{name:"qualifiedCount",index:"qualifiedCount",width:310,align:"left"},{name:"takeDeliveryWeight",index:"takeDeliveryWeight",width:310,align:"left"}]}}},methods:{changeDate:function(e){var t=e[0].replace(/\//g,"-"),i=e[1].replace(/\//g,"-");null!=t&&""!=t&&null!=i&&""!=i&&(this.body.startTime=t+" 00:00:00",this.body.endTime=i+" 23:59:59")},handleClear:function(){this.body.startTime=null,this.body.endTime=null},hideSearch:function(){this.isHide=!this.isHide,this.isSearchHide=!this.isSearchHide,$(".chevron").css("top","")},search:function(){this.reload=!this.reload},reloadAgain:function(){this.clear(),this.reload=!this.reload},insertCertificate:function(){var i=this.selected,o=!0;console.log(i),ht.util.hasValue(i,"array")?(1<i.length&&$.each(i,function(e,t){if(e<=i.length-2&&i[e].goodsTypeName!=i[e+1].goodsTypeName)return layer.alert("所有行的商品类型必须一致才能合成一张单！"),void(o=!1)}),o&&window.parent.activeEvent({name:"新增证书外发单",url:contextPath+"/purchase/certificateOutbreaks/certificate-add.html",params:{type:"undo",data:i}})):layer.alert("请先选择一条记录!")},clear:function(){this.body={businessType:null,goodsTypePath:"",startTime:"",endTime:"",orderNo:""},this.dataValue=[],this.commodityCategoty=[]},view:function(){},outGoing:function(){window.parent.closeCurrentTab({openTime:this.openTime,exit:!0})},loadCodeType:function(){this.docType=getCodeList("root_zj_jydydlx")},loadProductType:function(){var t=this;$.ajax({type:"post",url:contextPath+"/documentController/getCategory?parentId=0",dataType:"json",success:function(e){console.log(e),t.categoryType=t.initGoodCategory(e.data.cateLists)},error:function(){alert("服务器出错啦")}})},initGoodCategory:function(e){var n=this,a=[];return e.forEach(function(e){var t=e.customCode,i=e.name,o=e.cateLists;o&&(o=n.initGoodCategory(o)),a.push({value:t,label:i,children:o})}),a.forEach(function(e){e.children||delete e.children}),a},changeGoodsTypePath:function(e){console.log(e),this.body.goodsTypePath=e[e.length-1],console.log(this.body.goodsTypePath)}},mounted:function(){this.openTime=window.parent.params.openTime,this.loadProductType()}});