"use strict";function getUrlParam(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(e);return null!=n?unescape(n[2]):null}function formatNum(t,e){var n=Math.pow(1e3,e);return parseInt(t*n,10)/n}function numbersArray(t,n,o){n=n||1;var r=o?o-1:1;return Array(++t).join("0").split("").map(function(t,e){return e+n+(o?r*e:0)})}function guid(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}function htPrint(t){t?HT_LODOP.print(t):window.print()}function getCodeList(t){return layui.data("dict")[t]}function getCodeAll(t){var e=layui.data("dict")[t];return e=recursionDict(e)}function recursionDict(t){var n=layui.data("dict");return t&&0<t.length&&t.map(function(t){var e=n[t.mark];e&&Object.assign(t,{children:e}),recursionDict(e)}),t}function htLoadJs(t,n){if("array"==$.type(t)){var r="string"==$.type(n)?"dev":"",o=webInstance||"",i=[],s=[],a=contextPath||window.HT_ROOT||"/web",l=htComponentMap||{},u=(n="function"!=typeof n?null:n,function(t){return $.ajax({type:"get",dataType:"script",cache:!1,url:t})}),d=function(t){if("dev"==r){var e=document.createElement("script");e.setAttribute("src",t+"?_="+o),document.head.appendChild(e)}};if(void 0!==window.HT_ENV&&"prod"==window.HT_ENV&&(r="prod"),$.each(t,function(t,e){var n="";if(0==/.js$/i.test(e)){if(void 0!==l[e]){n=l[e],"prod"==r&&(n="/dist"+n);var o=a+n;$('script[src$="'+e+'.js"').remove(),d(o),i.push(o)}}else n=e,"prod"==r&&(n=n.replace(a+"/js/",a+"/dist/js/")),d(n),i.push(n)}),"dev"!=r&&0<i.length){var c=i.length;$.each(i,function(t,e){if(s.push(u(e)),t==c-2&&null==n)return!1});var e=$.when.apply(null,s);if(null!=n)e.done(n);else{var g=i[c-1];e.done(function(){u(g)})}e.fail(function(t,e,n){console.log(arguments)})}}}function htHandlerProductDetail(t,r,i,n){var s={applyOrganizationId:null,bomType:"",countingUnit:"",documentType:"",goldColor:null,goldLoss:null,commodityId:"",goodsCode:"",goodsId:"",id:"",inPrice:null,limit:null,name:"",num:"",partAttrs:[],price:null,pricingMethod:null,stoneClarity:null,stoneCoffeeColor:null,stoneColor:null,stoneCut:null,stoneFluorescent:null,stoneLoss:null,stoneMilkColor:null,stoneName:null,stoneNo:null,stoneSection:null,stoneShape:null,stoneWeight:null,weight:null,weightUnit:null};return t.map(function(t,o){if(t.tBaseBomEntity||t.assistAttrs||n)if(t.tBaseBomEntity||t.assistAttrs||!n)if("attr_ranges_goods"===t.goodsMainType)t.tBaseBomEntity.goldBoms.map(function(t,e){if(t.checked){var n=JSON.parse(JSON.stringify(s));Object.assign(n,{bomType:"BOM-GOLD",weightUnit:t.weightUnitId,weight:t.weightReference,commodityId:t.commodityId,goodsCode:t.commodityCode,name:t.commodityName,goldLoss:t.lose,goldColor:t.condition}),(t.attr||[]).map(function(t){0<Object.keys(t).length&&n.partAttrs.push({attr:t.name||t.attr,attrValue:t.model||t.attrValue})}),r.goodList[o]||(r.goodList[o]=JSON.parse(JSON.stringify(i))),r.goodList[o].goldParts.push(n)}}),t.tBaseBomEntity.stonesBoms.map(function(t,e){var n=JSON.parse(JSON.stringify(s));Object.assign(n,{bomType:"BOM-STONE",countingUnit:t.countUnitId,weightUnit:t.weightUnitId,num:t.count,weight:t.weightReference,commodityId:t.commodityId,goodsCode:t.commodityCode,name:t.commodityName,stoneName:t.partName,stoneLoss:t.lose}),(t.attr||[]).map(function(t){0<Object.keys(t).length&&n.partAttrs.push({attr:t.name||t.attr,attrValue:t.model||t.attrValue})}),r.goodList[o]||(r.goodList[o]=JSON.parse(JSON.stringify(i))),r.goodList[o].stonesParts.push(n)}),t.tBaseBomEntity.partBoms.map(function(t,e){var n=JSON.parse(JSON.stringify(s));Object.assign(n,{bomType:"BOM-PART",countingUnit:t.countUnitId,weightUnit:t.weightUnitId,num:t.count,weight:t.weightReference,commodityId:t.commodityId,goodsCode:t.commodityCode,name:t.commodityName}),(t.attr||[]).map(function(t){0<Object.keys(t).length&&n.partAttrs.push({attr:t.name||t.attr,attrValue:t.model||t.attrValue})}),r.goodList[o]||(r.goodList[o]=JSON.parse(JSON.stringify(i))),r.goodList[o].partParts.push(n)});else{var e=JSON.parse(JSON.stringify(s));Object.assign(e,{bomType:"BOM-MATERIAL"}),t.assistAttrs.assistAttrs.map(function(t){"string"==typeof t.attr?e.partAttrs.push(t):(t.attr||[]).map(function(t){0<Object.keys(t).length&&e.partAttrs.push({attr:t.name,attrValue:t.model})})}),r.goodList[o]||(r.goodList[o]=JSON.parse(JSON.stringify(i))),r.goodList[o].materialParts.push(e)}else Object.assign(t,{stonesParts:t.stonesParts,goldParts:t.goldParts,partParts:t.partParts,materialParts:t.materialParts});else Object.assign(t,{stonesParts:[],goldParts:[],partParts:[],materialParts:[]})}),t}function htValidateRow(t,r){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return t.some(function(t,e){for(var n in r)if(r.hasOwnProperty(n)){if("string"===r[n].type&&(void 0===t[n]||""===t[n]||null===t[n]))return i&&layer.alert("分录行第"+(e+1)+"行"+r[n].name+"必填"),!0;if("number"===r[n].type&&("attr_ranges_gold"!==t.goodsMainType||!0!==r[n].empty)){var o=0===r[n].floor?"^\\+?[1-9][0-9]*$":"^[0-9]+(.[0-9]{0,"+r[n].floor+"})?$";if(!new RegExp(o).test(t[n]))return i&&layer.alert("分录行第"+(e+1)+"行"+r[n].name+"不符合要求"),!0;if(r[n].plus&&0===Number(t[n]))return layer.alert("分录行第"+(e+1)+"行"+r[n].name+"必须大于0"),!0}}})}function repositionDropdownOnSroll(e,n){document.querySelector("."+e);if($("."+e).scroll(function(){if($("."+n).offset()){var t=$("."+n).offset().left;$("."+e+" .ivu-select-dropdown").css({left:t+"px"})}}),$("."+n).offset()){var t=$("."+n).offset().left;$("."+e+" .ivu-select-dropdown").css({left:t+"px"})}}function htInputNumber(t,e,n){if(null!==t[e]&&void 0!==t[e]){t[e]=t[e].toString().replace(/[^\d.]/g,""),t[e]=t[e].toString().replace(/^\./g,""),t[e]=t[e].toString().replace(/\.{2,}/g,"."),t[e]=t[e].toString().replace(".","$#$").replace(/\./g,"").replace("$#$",".");var o=t[e].toString(),r=0===n?-1<o.indexOf(".")?o.indexOf("."):o.length+1:-1<o.indexOf(".")?o.indexOf(".")+n+1:o.length+1;t[e]=o.substring(0,r)}}function inputNumberF(t,e,n){var o=t;n?o[e][n]=o[e][n]?parseFloat(o[e][n]).toFixed(2):"0.00":o[e]=o[e]?parseFloat(o[e]).toFixed(2):"0.00"}Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(t)&&(t=t.replace(RegExp.$1,(1<RegExp.$1.length?2<RegExp.$1.length?"星期":"周":"")+{0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"}[this.getDay()+""])),e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t};