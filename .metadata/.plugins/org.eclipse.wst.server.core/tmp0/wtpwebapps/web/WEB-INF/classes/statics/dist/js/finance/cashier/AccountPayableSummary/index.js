"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};new Vue({el:"#accountPayableSummary",data:function(){return{openTime:"",formData:{supplierCodeStart:"",supplierCodeEnd:"",departmentCodeStart:"",departmentCodeEnd:"",salesmanCodeStart:"",salesmanCodeEnd:"",dateTimeStart:"",dateTimeEnd:"",coinStopId:0,isAuditing:1,isPaymentSettlement:1,isOtherPayable:1,showPeriodSum:0,showYearSum:0,otherTypesDocuments:2,gather:1,documentType:2},form:{supplier:"",department:"",salesman:"",coinStopName:""},formDataInit:{coinStop:[],supplier:[],department:[],salesman:[],dateTimeStart:"",dateTimeEnd:""},organisationList:[{label:"金大祥",value:1},{label:"金大祥1",value:2},{label:"金大祥2",value:3}],filterVisible:!1,base_config:{mtype:"POST",styleUI:"Bootstrap",url:contextPath+"/accountsPayableStatement/payableBreakdown",ajaxGridOptions:{contentType:"application/json;charset=utf-8"},datatype:"json",jsonReader:{root:"data"},height:$(window).height()-140,rowNum:999999999},colNames:[],colModel:[],tableHeaders:[],tableSelectId:"",baseData:{standardCurrencyId:1},currencyList:[{label:"人民币",value:1},{label:"美元",value:2},{label:"欧元",value:3}],lodoPList:[],printModal:!1,printInfo:{}}},mounted:function(){this.initMethod(),this.openTime=window.parent.params&&window.parent.params.openTime},methods:{derivation:function(){console.log("引出,导出excel...");var t="";for(var e in this.formData.dateTimeStart=new Date(this.formData.dateTimeStart).format("yyyy-MM-dd"),this.formData.dateTimeEnd=new Date(this.formData.dateTimeEnd).format("yyyy-MM-dd"),console.log("this.formData",this.formData),this.formData)t+=e+"="+this.formData[e]+"&";t=t.slice(0,t.length-1),console.log("data====>",t),window.open(contextPath+"/accountsPayableStatement/exportExcel?"+t)},_ajaxGetFormData:function(){var a=this;$.ajax({type:"post",url:contextPath+"/accountsPayableStatement/init",dataType:"json",data:null,success:function(t){var e="";"100100"===t.code?(e=t.msg,console.log(t,"======>"),a.formDataInit=t.data,a.formData.dateTimeStart=t.data.dateTimeStart,a.formData.dateTimeEnd=t.data.dateTimeEnd,a.formData.coinStopId=t.data.id,console.log("that.formData===>",a.formData),a.setTableHeader()):e=t.msg,a.$Message.info({content:e,duration:3})}})},initMethod:function(){this.delTable(),this._ajaxGetFormData()},setTableHeader:function(){this.baseData.standardCurrencyId===this.formData.coinStopId?(this.colNames=["id","供应商代码","供应商名称","部门代码","部门名称","业务员代码","业务员名称","期初余额","预付金额","应付金额","实付金额","期末余额","documentId","system"],this.colModel=[{name:"id",width:30,hidden:!0},{name:"customerCode",width:100},{name:"customerName",width:100},{name:"departmentCode",width:100},{name:"departmentName",width:100},{name:"employeeCode",width:100},{name:"employeeName",width:100},{name:"beginBalance",width:120,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"depositBalance",width:150,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"receivableBalance",width:100,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"officialBalance",width:100,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"endBalance",width:100,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"documentId",hidden:!0},{name:"system",hidden:!0}],this.tableHeaders=[]):(this.colNames=["id","供应商代码","供应商名称","部门代码","部门名称","业务员代码","业务员名称","原币","本位币","原币","本位币","原币","本位币","原币","本位币","原币","本位币","documentId","system"],this.colModel=[{name:"id",width:30,hidden:!0},{name:"customerCode",width:100},{name:"customerName",width:100},{name:"departmentCode",width:100},{name:"departmentName",width:100},{name:"employeeCode",width:100},{name:"employeeName",width:100},{name:"beginBalanceFor",width:120,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"beginBalance",width:120,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"depositBalanceFor",width:150,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"depositBalance",width:150,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"receivableBalanceFor",width:100,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"receivableBalance",width:100,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"officialBalanceFor",width:100,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"officialBalance",width:100,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"endBalanceFor",width:100,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"endBalance",width:100,formatter:function(t,e,a,n){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"documentId",hidden:!0},{name:"system",hidden:!0}],this.tableHeaders=[{startColumnName:"beginBalanceFor",numberOfColumns:2,titleText:"期初余额"},{startColumnName:"depositBalanceFor",numberOfColumns:2,titleText:"预付金额"},{startColumnName:"receivableBalanceFor",numberOfColumns:2,titleText:"应付金额"},{startColumnName:"officialBalanceFor",numberOfColumns:2,titleText:"实付金额"},{startColumnName:"endBalanceFor",numberOfColumns:2,titleText:"期末余额"}]),this.jqGridInit(this.colNames,this.colModel,this.tableHeaders)},delTable:function(){$("#grid").empty();var t=$(".jqGrid_wrapper");t.empty(),$('<table id="grid"></table><div id="page"></div>').appendTo(t)},jqGridInit:function(t,e,a){var o=this;console.log("_vm.formData=====>>",o.formData);var n=Object.assign({},this.base_config,{colNames:t,colModel:e,postData:JSON.stringify(o.formData),userDataOnFooter:!0,gridComplete:o.completeMethod,loadComplete:function(t){console.log("ret====>>>",t),o.lodoPList=t.data||[],jQuery("#grid").jqGrid("destroyGroupHeader"),jQuery("#grid").jqGrid("setGroupHeaders",{useColSpanStyle:!0,groupHeaders:a})},onSelectRow:function(t,e){console.log("data---------",t,e),o.tableSelectId=t},ondblClickRow:function(t,e,a,n){console.log(t,e,a,n,"-----rowid,iRow,iCol,e---------"),-1==o.tableSelectId.indexOf("-log-")&&o.checkTheDocuments()}});jQuery("#grid").jqGrid(n)},getColSum:function(t){var e=$("td[aria-describedby='grid_"+t+"']"),a=0;return(e=0!==e.children("div.sumCol").length?$("td[aria-describedby='grid_"+t+"']").children("div.sumCol"):$("td[aria-describedby='grid_"+t+"']:not(:last)")).each(function(t,e){a+=1e3*accounting.unformat($(e).text())}),a/=1e3,a=accounting.formatMoney(a,"",2)},completeMethod:function(){$("#grid").footerData("set",{voucherPeriodData:"合计",createName:[0]});var t=this.getColSum("createName");$("#grid").footerData("set",{voucherPeriodData:"合计",createName:t})},open:function(){this.filterVisible=!0},refresh:function(){this.delTable(),this.setTableHeader()},save:function(){this.filterVisible=!1,this.refresh()},cancel:function(){this.filterVisible=!1},checkTheDocuments:function(){var t=this,e="",a={id:"0"},n="";if(0!=t.lodoPList.length)for(var o=0;o<t.lodoPList.length;o++)t.tableSelectId===t.lodoPList[o].id&&(a=t.lodoPList[o]);if(console.log("!_date",a),"0"===a.id)return console.log("!_date",a),void this.$Message.info("请先选中一条数据");if(console.log("that.lodoPList",t.lodoPList),console.log("_date",a),-1==a.id.indexOf("-log-")){if(-1===a.system){JSON.stringify(t.formData).toString();e=rcContextPath+"/finance/cashier/AccountPayable/index.html?customerCode="+a.customerCode,n="应付账款明细表";var r=t.http_builder_url(e,t.formData)}window.parent.activeEvent({name:n,url:r})}},http_builder_url:function(t,e){if(void 0===t||null==t||""==t)return"";if(void 0===e||null==e||"object"!=(void 0===e?"undefined":_typeof(e)))return"";for(var a in t+=-1!=t.indexOf("?")?"":"?",e)t+=(-1!=t.indexOf("=")?"&":"")+a+"="+encodeURI(e[a]);return t},outHtml:function(){window.parent.closeCurrentTab({name:name,openTime:this.openTime,exit:!0})},print:function(){var e=this;if(console.log(e.lodoPList,"=========that.lodoPList"),e.lodoPList&&e.lodoPList.length){(this.formData.supplierCodeStart||this.formData.supplierCodeEnd)&&(this.form.supplier=(this.formData.supplierCodeStart?this.formData.supplierCodeStart:"")+"--"+(this.formData.supplierCodeEnd?this.formData.supplierCodeEnd:"")),this.formData.supplierCodeStart||this.formData.supplierCodeEnd||(this.form.supplier="所有"),(this.formData.departmentCodeStart||this.formData.departmentCodeEnd)&&(this.form.department=(this.formData.departmentCodeStart?this.formData.departmentCodeStart:"")+"--"+(this.formData.departmentCodeEnd?this.formData.departmentCodeEnd:"")),this.formData.departmentCodeStart||this.formData.departmentCodeEnd||(this.form.department="所有"),(this.formData.salesmanCodeStart||this.formData.salesmanCodeEnd)&&(this.form.salesman=(this.formData.salesmanCodeStart?this.formData.salesmanCodeStart:"")+"--"+(this.formData.salesmanCodeEnd?this.formData.salesmanCodeEnd:"")),this.formData.salesmanCodeStart||this.formData.salesmanCodeEnd||(this.form.salesman="所有");var t=this.formDataInit.coinStop;console.log("coinStop",t),console.log("this.formData===",this.formData);for(var a=0;a<t.length;a++)t[a].id===this.formData.coinStopId&&(this.form.coinStopName=t[a].name);if(e.baseData.standardCurrencyId===e.formData.coinStopId){var n={title:"应付账款汇总表",template:1,titleInfo:[{name:"起始日期",val:new Date(this.formData.dateTimeStart).format("yyyy-MM-dd")},{name:"结束日期",val:new Date(this.formData.dateTimeEnd).format("yyyy-MM-dd")},{name:"供应商代码范围",val:this.form.supplier},{name:"部门代码范围",val:this.form.department},{name:"业务员代码范围",val:this.form.salesman},{name:"币别",val:this.form.coinStopName}],colNames:[{name:"日期",col:"documentDate"},{name:"单据类型",col:"documentType"},{name:"单据编号",col:"documentNumber"},{name:"供应商名称",col:"customerName"},{name:"摘要",col:"summary"},{name:"凭证号",col:"voucherSize"},{name:"部门",col:"departmentName"},{name:"业务员",col:"employeeName"},{name:"预付金额",col:"depositBalance"},{name:"应付金额",col:"receivableBalance"},{name:"实付金额",col:"officialBalance"},{name:"期末余额",col:"endBalance"}],styleCss:"",colMaxLenght:9,data:e.lodoPList};e.printInfo=n,e.printModalShow(!0)}else{var o=e.lodoPList,r="";'\n                    <tr class=\'thCs\'>\n                        <th rowspan="2" style="width: 6%">日期</th>\n                        <th rowspan="2" style="width: 6%">单据类型</th>\n                        <th rowspan="2" style="width: 6%">单据编号</th>\n                        <th rowspan="2" style="width: 6%">供应商名称</th>\n                        <th rowspan="2" style="width: 6%">摘要</th>\n                        <th rowspan="2" style="width: 6%">凭证号</th>\n                        <th rowspan="2" style="width: 6%">部门</th>\n                        <th rowspan="2" style="width: 6%">业务员</th>\n                        <th colspan="2" style="width: 12%">预付金额</th>\n                        <th colspan="2" style="width: 12%">应付金额</th>\n                        <th colspan="2" style="width: 12%">实付金额</th>\n                        <th colspan="2" style="width: 12%">期末余额</th>\n                    </tr>\n                    <tr class=\'thCs\'>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                    </tr>\n                ',o.forEach(function(t){r+="\n                        <tr>\n                            <td>"+e._nullData(t.documentDate)+"</td>\n                            <td>"+e._nullData(t.documentType)+"</td>\n                            <td>"+e._nullData(t.documentNumber)+"</td>\n                            <td>"+e._nullData(t.customerName)+"</td>\n                            <td>"+e._nullData(t.summary)+"</td>\n                            <td>"+e._nullData(t.voucherSize)+"</td>\n                            <td>"+e._nullData(t.departmentName)+"</td>\n                            <td>"+e._nullData(t.employeeName)+"</td>\n                            <td>"+e._nullData(t.depositBalance)+"</td>  \n                            <td>"+e._nullData(t.depositBalanceFor)+"</td>\n                            <td>"+e._nullData(t.receivableBalance)+"</td>\n                            <td>"+e._nullData(t.receivableBalanceFor)+"</td>\n                            <td>"+e._nullData(t.officialBalance)+"</td>\n                            <td>"+e._nullData(t.officialBalanceFor)+"</td>\n                            <td>"+e._nullData(t.endBalance)+"</td>\n                            <td>"+e._nullData(t.endBalanceFor)+"</td>\n                        </tr>\n                    "});var i={title:"应付账款汇总表",template:12,titleInfo:[{name:"起始日期",val:new Date(this.formData.dateTimeStart).format("yyyy-MM-dd")},{name:"结束日期",val:new Date(this.formData.dateTimeEnd).format("yyyy-MM-dd")},{name:"供应商代码范围",val:this.form.supplier},{name:"部门代码范围",val:this.form.department},{name:"业务员代码范围",val:this.form.salesman},{name:"币别",val:this.form.coinStopName}],data:[],colMaxLenght:10,tbodyInfo:{theadTX:'\n                    <tr class=\'thCs\'>\n                        <th rowspan="2" style="width: 6%">日期</th>\n                        <th rowspan="2" style="width: 6%">单据类型</th>\n                        <th rowspan="2" style="width: 6%">单据编号</th>\n                        <th rowspan="2" style="width: 6%">供应商名称</th>\n                        <th rowspan="2" style="width: 6%">摘要</th>\n                        <th rowspan="2" style="width: 6%">凭证号</th>\n                        <th rowspan="2" style="width: 6%">部门</th>\n                        <th rowspan="2" style="width: 6%">业务员</th>\n                        <th colspan="2" style="width: 12%">预付金额</th>\n                        <th colspan="2" style="width: 12%">应付金额</th>\n                        <th colspan="2" style="width: 12%">实付金额</th>\n                        <th colspan="2" style="width: 12%">期末余额</th>\n                    </tr>\n                    <tr class=\'thCs\'>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                        <th style="width: 6%">原币</th>\n                        <th style="width: 6%">本位币</th>\n                    </tr>\n                ',tbodyTX:r,tfootTX:""}};htPrint(i)}}else e.$Message.info({content:"无打印数据",duration:3})},printModalShow:function(t){this.printModal=t},_nullData:function(t){return t||""}},computed:{currencyName:function(){var e=this,t=this.currencyList.find(function(t){return t.value===e.formData.currencyId});if(t)return t.label}}});