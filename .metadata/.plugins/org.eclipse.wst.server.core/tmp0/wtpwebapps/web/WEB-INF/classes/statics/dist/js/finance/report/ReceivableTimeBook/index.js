"use strict";var _vm=new Vue({el:"#receivableTimeBook",data:function(){return{openTime:"",startDate:"",endDate:"",curDate:(new Date).format("yyyy-MM-dd"),objectTypeIdNext:-1,initInfo:{pageType:1,pageTitle:"单据序时簿",objectTypeId:-1,objectTypeList:[]},isContinue:!1,isContinueList:[],isInit:!0,showFilter:!1,subjectVisable:!1,visible_filter:!1,showOptionVisible:!1,optionInfo:{abnormalDataProcessing:"1",abnormalErrorHandling:"4",subjectMergerDebit:!1,subjectMergerLender:!1},columnsDataList:[{title:"模板编号",key:"templateNumber",width:100},{title:"模板名称",key:"templateName",width:100},{title:"创建时间",key:"createTime",width:180,render:function(e,t){return e("div",new Date(t.row.createTime).format("yyyy-MM-dd"))}},{title:"制单人",key:"createName",width:100},{title:"默认",key:"isDefault",render:function(e,t){return e("div",1===t.row.isDefault?"否":"是")},width:80},{title:"系统",key:"isSystem",render:function(e,t){return e("div",1===t.row.isSystem?"否":"是")},width:80}],dataList:[],showVoucherVisible:!1,voucherModelTxt:"",viewReportVisible:!1,viewReportTxt:"",selectListId:[],auditStatus:"",confirmConfig:{showConfirm:!1,title:"提示",content:"这是内容",onlySure:!0,success:!0},filterBody:{objectTypeId:"",timeStart:(new Date).format("yyyy-MM-dd"),timeEnd:(new Date).format("yyyy-MM-dd"),documentType:1,dateScore:"",auditStatus:"",isVoucher:"",documentNumber:"",sobId:""},detailDate:[{label:"全部",value:""},{label:"今天",value:"today"},{label:"昨天",value:"yesterday"},{label:"近7天",value:"interval7"},{label:"近30天",value:"interval30"},{label:"本月",value:"thisMon"},{label:"上月",value:"lastMon"},{label:"本季度",value:"thisQuarter"},{label:"上季度",value:"lastQuarter"},{label:"本年",value:"thisYear"},{label:"去年",value:"lastYear"}],auditStatusList:[{label:"未审核",value:1},{label:"已审核",value:2}],isVoucherList:[{label:"未记账",value:1},{label:"已记账",value:2}]}},methods:{_ajaxGetData:function(){var i=this,e=baseURL+"voucherMenu/getCategorys";http.post(e,"").then(function(e){var t="";"100100"===e.code?(i.initInfo.objectTypeList=e.data,i.initInfo.objectTypeId=e.data[0].objectTypeId||-1,i.objectTypeIdNext=e.data[0].objectTypeId||-1,i._getTable(i.initInfo.objectTypeId)):(t=e.msg,i.$Message.info({content:t,duration:3}))},function(e){})},objectTypeChange:function(e){console.log(this.initInfo)},_getTable:function(e){var a=this,t={_jqGridColNames:[],_colModel:[],_completeMethod:null,_url:""};switch(e){case 1:case 2:case 3:case 4:case 5:case 6:t._jqGridColNames=1===e||2===e||3===e?(a.initInfo.pageType=1,a.filterBody.documentType=1,["审核标志","日期","单据号","源单编号","结算账号","折扣科目","折后金额","折后金额(本位币)","凭证字号","整单折扣(%)","币别","汇率","表头收款金额","表头收款金额(本位币)","收款类型","单据日期","单据金额","单据金额(本位币)","已核销金额","未核销金额","本次核销","本次核销(本位币)","发票币别","表体汇率","摘要","部门","主管","客户","业务员","制单人","审核人","审核日期","打印次数","备注","sobId","isVoucher","voucherId","peId"]):(a.initInfo.pageType=2,a.filterBody.documentType=2,["审核标志","日期","单据号","源单编号","结算账号","折扣科目","折后金额","折后金额(本位币)","凭证字号","整单折扣(%)","币别","汇率","表头付款金额","表头付款金额(本位币)","付款类型","单据日期","单据金额","单据金额(本位币)","已核销金额","未核销金额","本次核销","本次核销(本位币)","发票币别","表体汇率","摘要","部门","主管","供应商","业务员","制单人","审核人","审核日期","打印次数","备注","sobId","isVoucher","voucherId","peId"]),t._colModel=[{name:"paymentReceiptEntity.auditMark",width:70,formatter:function(e,t,i,n){return"合计"===e?e:2===e?"Y":"N"}},{name:"paymentReceiptEntity.orderDate",index:"orderDate",width:90,formatter:function(e,t,i,n){return e?e.slice(0,10):""}},{name:"paymentReceiptEntity.documentNumber",width:80,align:"left"},{name:"financeSourceSingleDataEntities",width:100,align:"left",formatter:function(e,t,i,n){var a="";return i.financeSourceSingleDataEntities.map(function(e,t){e.sourceListNumber&&"null"!==e.sourceListNumber&&(a+=e.sourceListNumber+"<br>")}),a}},{name:"paymentReceiptEntity.clearanceAccount",width:80,align:"left"},{name:"paymentReceiptEntity.discountSubject",width:80,align:"right"},{name:"paymentReceiptEntity.reducedAmountFor",width:80,align:"right",formatter:function(e,t,i,n){return accounting.formatMoney(e,"",2)}},{name:"paymentReceiptEntity.reducedAmount",width:120,align:"right",formatter:function(e,t,i,n){return accounting.formatMoney(e,"",2)}},{name:"paymentReceiptEntity.voucherSize",width:80,align:"left"},{name:"paymentReceiptEntity.bulkDiscount",width:80,align:"right"},{name:"paymentReceiptEntity.coinStop",width:80,align:"left"},{name:"paymentReceiptEntity.exchangeRate",width:50,align:"right"},{name:"paymentReceiptEntity.watchPaymentFor",width:120,align:"right",formatter:function(e,t,i,n){return accounting.formatMoney(e,"",2)}},{name:"paymentReceiptEntity.watchPayment",width:150,align:"right",formatter:function(e,t,i,n){return accounting.formatMoney(e,"",2)}},{name:"paymentReceiptEntity.typePaymentReceived",index:"typePaymentReceived",width:120,align:"right",formatter:function(e,t,i,n){var a="";switch(e){case 1:a="收款单";break;case 2:a="付款单";break;case 3:a="预收款单";break;case 4:a="预付款单";break;case 5:a="收款退款单";break;case 6:a="付款退款单";break;default:a=""}return a}},{name:"financeSourceSingleDataEntities",width:80,align:"right",formatter:function(e,t,i,n){var a="";return i.financeSourceSingleDataEntities.map(function(e,t){e.documentDate&&"null"!==e.documentDate&&(a+=e.documentDate.slice(0,10)+"<br>")}),a}},{name:"paymentReceiptEntity.documentaryAmountForList",width:80,align:"right",formatter:function(e,t,i,n){return a.sortData(e,t,i,n)}},{name:"paymentReceiptEntity.documentaryAmountList",width:100,align:"right",formatter:function(e,t,i,n){return a.sortData(e,t,i,n)}},{name:"paymentReceiptEntity.cancellationAmountList",width:100,align:"right",formatter:function(e,t,i,n){return a.sortData(e,t,i,n)}},{name:"paymentReceiptEntity.notCancellationAmountList",width:100,align:"right",formatter:function(e,t,i,n){return a.sortData(e,t,i,n)}},{name:"paymentReceiptEntity.thisTiemCancellationForList",width:100,align:"right",formatter:function(e,t,i,n){return a.sortData(e,t,i,n)}},{name:"paymentReceiptEntity.thisTiemCancellationList",width:100,align:"right",formatter:function(e,t,i,n){return a.sortData(e,t,i,n)}},{name:"financeSourceSingleDataEntities",width:100,align:"right",formatter:function(e,t,i,n){var a="";return i.financeSourceSingleDataEntities.map(function(e,t){a+=e.invoiceCoinType+"<br>"}),a}},{name:"financeSourceSingleDataEntities",width:100,align:"right",formatter:function(e,t,i,n){var a="";return i.financeSourceSingleDataEntities.map(function(e,t){a+=e.surfaceExchangeRate+"<br>"}),a}},{name:"paymentReceiptEntity.summary",width:80,align:"right"},{name:"paymentReceiptEntity.department",width:80,align:"right"},{name:"paymentReceiptEntity.director",width:80,align:"right"},{name:"paymentReceiptEntity.occurrenceObject",width:80,align:"right"},{name:"paymentReceiptEntity.salesman",width:80,align:"right"},{name:"paymentReceiptEntity.singlePerson",width:80,align:"right"},{name:"paymentReceiptEntity.auditorName",width:80,align:"right"},{name:"paymentReceiptEntity.auditDate",width:80,align:"right",formatter:function(e,t,i,n){return e?e.slice(0,10):""}},{name:"paymentReceiptEntity.printingTimes",width:80,align:"right"},{name:"financeSourceSingleDataEntities",width:100,align:"right",formatter:function(e,t,i,n){var a="";return i.financeSourceSingleDataEntities.map(function(e,t){a+=e.remark+"<br>"}),a}},{name:"paymentReceiptEntity.sobId",hidden:!0},{name:"paymentReceiptEntity.isVoucher",hidden:!0},{name:"paymentReceiptEntity.voucherId",hidden:!0},{name:"paymentReceiptEntity.id",hidden:!0,key:!0}],t._url=baseURL+"paymentreceiptController/filtrate?r="+(new Date).getTime(),t._completeMethod=a.completeMethodPaymentReceip;break;case 7:case 8:case 9:case 10:case 11:case 12:t._jqGridColNames=7===e||8===e||9===e||10===e?(a.initInfo.pageType=1,a.filterBody.documentType=1,["日期","单据编号","凭证字号","客户","供应商","币别","实收金额","部门","业务员","sobId","isVoucher","voucherId"]):11===e?(a.initInfo.pageType=2,a.filterBody.documentType=2,["日期","单据编号","凭证字号","转出客户","转入客户","币别","实收金额","部门","业务员","sobId","isVoucher","voucherId"]):(a.initInfo.pageType=3,a.filterBody.documentType=3,["日期","单据编号","凭证字号","转出供应商","转入供应商","币别","实收金额","部门","业务员","sobId","isVoucher","voucherId"]),t._colModel=[{name:"documentDate",index:"orderDate",width:90,formatter:function(e,t,i,n){return"合计"===e?e:e?e.slice(0,10):""}},{name:"billNumber",width:80,align:"left"},{name:"voucherSize",width:80,align:"right"},{name:"occurrenceObjectOne",width:80,align:"right"},{name:"occurrenceObjectTwo",width:80,align:"right"},{name:"coinStop",width:80,align:"right"},{name:"thisTiemCancellation",width:80,align:"right",formatter:function(e,t,i,n){return accounting.formatMoney(e,"",2)}},{name:"department",width:80,align:"right"},{name:"salesman",width:80,align:"right"},{name:"sobId",hidden:!0},{name:"isVoucher",hidden:!0},{name:"voucherId",hidden:!0}],t._url=baseURL+"verificationSheet/querys?r="+(new Date).getTime(),t._completeMethod=a.completeMethod;break;case 13:case 14:case 15:case 16:t._jqGridColNames=13===e||15===e?(a.initInfo.pageType=1,a.filterBody.documentType=1,["审核标志","日期","单据号","单据类型","结算账户","客户","币别","汇率","收款金额","收款金额(本位币)","收款期限","收入类别 ","应结算金额","凭证字号","摘要","部门","经手人","制单人","审核人","审核日期","打印次数","备注","sobId","isVoucher","voucherId"]):(a.initInfo.pageType=2,a.filterBody.documentType=2,["审核标志","日期","单据号","单据类型","结算账户","供应商","币别","汇率","付款金额","付款金额(本位币)","付款期限","支出类别","应结算金额","凭证字号","摘要","部门","经手人","制单人","审核人","审核日期","打印次数","备注","sobId","isVoucher","voucherId"]),t._colModel=[{name:"auditStatus",width:70,formatter:function(e,t,i,n){return"合计"===e?e:2===e?"Y":"N"}},{name:"documentDate",index:"orderDate",width:90,formatter:function(e,t,i,n){return e?e.slice(0,10):""}},{name:"documentNumber",width:80,align:"left"},{name:"documentTypeName",width:80,align:"left"},{name:"clearanceAccount",width:80,align:"right"},{name:"occurrenceObject",width:80,align:"right"},{name:"coinStop",width:80,align:"right"},{name:"exchangeRate",width:80,align:"right"},{name:"amountPaymentReceivedFor",width:80,align:"right"},{name:"amountPaymentReceived",width:80,align:"left"},{name:"receiptPaymentPeriod",width:80,align:"right",formatter:function(e,t,i,n){return e?e.slice(0,10):""}},{name:"incomeCategoryName",width:80,align:"right"},{name:"payableAmountFor",width:80,align:"right"},{name:"voucherSize",width:80,align:"right"},{name:"summary",width:80,align:"right"},{name:"department",width:80,align:"right"},{name:"brokerage",width:80,align:"right"},{name:"createName",width:80,align:"right"},{name:"auditorName",width:80,align:"right"},{name:"auditorDate",width:80,align:"right",formatter:function(e,t,i,n){return e?e.slice(0,10):""}},{name:"printingTimes",width:80,align:"right"},{name:"remark",width:80,align:"right"},{name:"sobId",hidden:!0},{name:"isVoucher",hidden:!0},{name:"voucherId",hidden:!0}],t._url=baseURL+"receivablePayableVouche/getOtherFilterNew?r="+(new Date).getTime(),t._completeMethod=a.completeMethodOthPaymentReceip}a.pageInit(t)},_queryObject:function(){var t=this,e=baseURL+"generatingCredentialOption/getCredentialOption",i=new FormData;i.append("ownershipSystem",2),http.post(e,i).then(function(e){"100100"===e.code&&(t.optionInfo=e.data)},function(e){})},_queryTypeId:function(e){var i=this,t=baseURL+"VoucherTemplate/queryObjectType",n=new FormData;n.append("objectTypeId",e),http.post(t,n).then(function(e){if("100100"===e.code){var t=e.data.filter(function(e){return 2===e.isDefault});i.dataList=t}},function(e){})},sortData:function(e,t,i,n){var a="";return e.map(function(e,t){"number"==typeof e&&(e=accounting.formatMoney(e,"",2)),a+="<div class='sumCol'>"+e+"</div>"}),a},getColSum:function(e){var t=$("td[aria-describedby='list_"+e+"']"),i=0;return(t=0!==t.children("div.sumCol").length?$("td[aria-describedby='list_"+e+"']").children("div.sumCol"):$("td[aria-describedby='list_"+e+"']:not(:last)")).each(function(e,t){i+=1e3*accounting.unformat($(t).text())}),i/=1e3,i=accounting.formatMoney(i,"",2)},pageInit:function(e){var n=this,a=n.initInfo.objectTypeId;n.filterBody.objectTypeId=7==a||13==a?1:8==a||14==a?2:9==a||15==a?3:10==a||16==a?4:11==a?5:12==a?6:2==a?5:4==a?2:5==a?6:6==a?4:a,n.selectListId=[],console.log("that.filterBody",JSON.stringify(n.filterBody)),jQuery("#list").jqGrid({url:e._url,postData:JSON.stringify(n.filterBody),ajaxGridOptions:{contentType:"application/json;charset=utf-8"},datatype:"json",colNames:e._jqGridColNames,colModel:e._colModel,rowNum:999999999,sortorder:"desc",mtype:"post",jsonReader:{root:"data"},sortable:!1,styleUI:"Bootstrap",height:.7*$(window).height(),viewrecords:!0,multiselect:!0,footerrow:!0,userDataOnFooter:!0,gridComplete:e._completeMethod,beforeRequest:function(){n.selectListId=[]},onCellSelect:function(e){jQuery("#list").jqGrid("getRowData",e)},ondblClickRow:function(e){console.log(e,"==双击事件222"),n._gotoDetails(e)},onSortCol:function(e,t,i){},onSelectAll:function(e,t){console.log(e,t,"===aRowids,status=="),n.selectListId=t?e:[]},onSelectRow:function(t,e){if(1<=a&&a<=6){var i=jQuery("#list").jqGrid("getRowData",t)["paymentReceiptEntity.id"];console.log(i),e?n.selectListId.push(i):n.selectListId=n.selectListId.filter(function(e){return e!==i})}else console.log(t,e,"===rowid,status=="),e?n.selectListId.push(t):n.selectListId=n.selectListId.filter(function(e){return e!==t});console.log("当前选择的id==="+n.selectListId)}})},completeMethod:function(){var e=this.getColSum("thisTiemCancellation");$("#list").footerData("set",{documentDate:"合计",thisTiemCancellation:e})},completeMethodPaymentReceip:function(){var e=this.getColSum("paymentReceiptEntity.reducedAmountFor"),t=this.getColSum("paymentReceiptEntity.reducedAmount"),i=this.getColSum("paymentReceiptEntity.watchPaymentFor"),n=this.getColSum("paymentReceiptEntity.watchPayment"),a=this.getColSum("paymentReceiptEntity.documentaryAmountForList"),o=this.getColSum("paymentReceiptEntity.documentaryAmountList"),r=this.getColSum("paymentReceiptEntity.cancellationAmountList"),c=this.getColSum("paymentReceiptEntity.notCancellationAmountList"),s=this.getColSum("paymentReceiptEntity.thisTiemCancellationForList"),l=this.getColSum("paymentReceiptEntity.thisTiemCancellationList");$("#list").footerData("set",{"paymentReceiptEntity.auditMark":"合计","paymentReceiptEntity.reducedAmountFor":e,"paymentReceiptEntity.reducedAmount":t,"paymentReceiptEntity.watchPayment":n,"paymentReceiptEntity.watchPaymentFor":i,"paymentReceiptEntity.documentaryAmountForList":[a],"paymentReceiptEntity.documentaryAmountList":[o],"paymentReceiptEntity.cancellationAmountList":[r],"paymentReceiptEntity.notCancellationAmountList":[c],"paymentReceiptEntity.thisTiemCancellationForList":[s],"paymentReceiptEntity.thisTiemCancellationList":[l]})},completeMethodOthPaymentReceip:function(){var e=this.getColSum("amountPaymentReceivedFor"),t=this.getColSum("amountPaymentReceived"),i=this.getColSum("payableAmountFor"),n=this.getColSum("settledAmount");$("#list").footerData("set",{auditStatus:"合计",amountPaymentReceivedFor:e,amountPaymentReceived:t,payableAmountFor:i,settledAmount:n})},handleOpen:function(){this.visible_filter=!0},detailClick:function(e){},iconPopup:function(e){this.subjectVisable=!0},subjectClose:function(){this.subjectVisable=!1},conformCancel:function(){this.confirmConfig.showConfirm=!1},conformSure:function(){this.confirmConfig.showConfirm=!1,this.confirmConfig.onlySure=!this.confirmConfig.onlySure},subjectDate:function(e){},delTable:function(){$("#list").empty();var e=$(".jqGrid_wrapper");e.empty(),$('<table id="list"></table><div id="page"></div>').appendTo(e)},sure:function(e){var t=this;if(e)if(t.objectTypeIdNext===t.initInfo.objectTypeId)t.selectListId=[],$("#list").setGridParam({postData:JSON.stringify(this.filterBody)}).trigger("reloadGrid");else{t.delTable(),$("#list").jqGrid("clearGridData"),$.jgrid.gridUnload("list"),t.id="",t._getTable(t.initInfo.objectTypeId);var i=Object.assign({},t.initInfo);t.objectTypeIdNext=i.objectTypeId}this.visible_filter=!1},_gotoDetails:function(e){console.log("that.initInfo.objectTypeId",this.initInfo.objectTypeId);var t=this.initInfo.objectTypeId,i="",n="",a={name:"收款单",url:rcContextPath+"/paymentReceipt/index.html?type=1"},o=jQuery("#list").jqGrid("getRowData",e);switch(t){case 1:case 2:case 3:case 4:case 5:case 6:var r=o["paymentReceiptEntity.id"];n=1===t||2===t||3===t?(i=rcContextPath+"/finance/paymentReceipt/index.html?type=1&id="+r+"&action=query","收款单"):(i=rcContextPath+"/finance/paymentReceipt/index.html?type=2&id="+r+"&action=query","付款单");break;case 7:case 8:case 9:case 10:case 11:case 12:n="核销单",i=rcContextPath+"/finance/ReceivableWriteofflist/index.html?id="+e+"&sobId=0&action=query";break;case 13:case 14:case 15:case 16:i=13===t||15===t?(n="其它收款单据",rcContextPath+"/finance/otherReceipts/index.html?otherTypesDocument=1&id="+e+"&action=query"):(n="其它付款单据",rcContextPath+"/finance/otherReceipts/index.html?otherTypesDocument=2&id="+e+"&action=query")}a.name=n,a.url=i,window.parent.activeEvent(a)},derivation:function(){console.log("引出")},print:function(){console.log("打印"),window.print()},voucher:function(){console.log("凭证1111111")},goPathOption:function(){var e={name:"模板设置",url:rcContextPath+"/finance/VoucherTemplates/index.html"};window.parent.activeEvent(e)},selectRowAction:function(e){var i=this,n=this,t="";console.log(n.selectListId,"==选中的list:that.selectListId");var a=n.initInfo.objectTypeId,o=n.getObjectType(a),r={paramVOS:[]};if(n.selectListId.forEach(function(e){var t={id:e};r.paramVOS.push(t)}),"summary"===e)t="1"==o?baseURL+"paymentreceiptController/createVoucherN":"2"==o?baseURL+"verificationSheet/setPoolVoucher":baseURL+"otherPaymentReceipt/createCollectVoucher",http.post(t,JSON.stringify(r)).then(function(e){if("100100"===e.code){if("4"===e.data.gcoe.abnormalErrorHandling){var t={name:"查看凭证",url:rcContextPath+"/finance/voucher-lrt/index.html?key="+e.data.key+"&sys="+e.data.voucherVO.entity.belongSystem+"&type=2"};window.parent.activeEvent(t)}$("#list").setGridParam({postData:JSON.stringify(i.filterBody)}).trigger("reloadGrid")}n.$Message.info({content:e.msg,duration:3})},function(e){});else if("according"===e)n._ajaxAccording(o,r);else if("bill"===e)console.log("that.selectListId[that.selectListId.length - 1]",n.selectListId[n.selectListId.length-1]),n._gotoDetails(n.selectListId[n.selectListId.length-1]);else if("voucher"===e){var c=jQuery("#list").jqGrid("getRowData",n.selectListId[n.selectListId.length-1]),s=0;if("1"==o){if(console.log("_d['paymentReceiptEntity.isVoucher']",c["paymentReceiptEntity.isVoucher"],c,n.selectListId),"2"!=c["paymentReceiptEntity.isVoucher"])return void n.$Message.info({content:"最后选取的单据号暂未生成凭证。",duration:3});s=c["paymentReceiptEntity.voucherId"]}else if("2"==o){if(console.log("_d",c.voucherId),"2"!=c.isVoucher)return void n.$Message.info({content:"最后选取的单据号暂未生成凭证。",duration:3});s=c.voucherId}else{if(console.log("_d",c.voucherId,c),"2"!=c.isVoucher)return void n.$Message.info({content:"最后选取的单据号暂未生成凭证。",duration:3});s=c.voucherId}var l={name:"查看凭证",url:rcContextPath+"/finance/voucher-lrt/index.html?voucherId="+s+"&sobId=1"};window.parent.activeEvent(l)}},_ajaxAccording:function(e,n){var a=this,t="";t="1"==e?baseURL+"paymentreceiptController/createVoucherListX":"2"==e?baseURL+"verificationSheet/setVouchers":baseURL+"otherPaymentReceipt/createVoucher",http.post(t,JSON.stringify(n)).then(function(e){if("100100"===e.code){if("4"===e.data.gcoe.abnormalErrorHandling){var t={name:"查看凭证",url:rcContextPath+"/finance/voucher-lrt/index.html?key="+e.data.key+"&sys="+e.data.voucherVO.entity.belongSystem+"&type=2"};return window.parent.activeEvent(t),a.showVoucher(!1),void a.showVoucherVisibleClose()}"1"===e.data.gcoe.abnormalDataProcessing?a.isContinue=!1:"2"===e.data.gcoe.abnormalDataProcessing?a.isContinue=!1:"3"===e.data.gcoe.abnormalDataProcessing&&(e.data.vses.length&&(a.selectListId=a.selectListId.filter(function(t){return!e.data.vses.filter(function(e){return parseInt(t)===e.id}).length})),a.selectListId.shift(),a.isContinue=!!a.selectListId.length,console.log(a.selectListId,"===that.selectListId==")),a.voucherModelTxt=e.data.vses.length===n.paramVOS.length?"生成凭证成功！":"生成凭证失败！";var i="报告内容：<br/>";e.data.log.forEach(function(e){i+=e+" <br/> "}),a.viewReportTxt=i}else a.voucherModelTxt="生成凭证失败！",a.viewReportTxt=e.msg;a.showVoucher(!0)},function(e){})},accordingAction:function(){var e=this;if(e.isContinue){var t=e.initInfo.objectTypeId,i=e.getObjectType(t),n={paramVOS:[]};e.selectListId.forEach(function(e,t){var i={id:e};n.paramVOS.push(i)}),e._ajaxAccording(i,n)}else e.showVoucher(!1),e.showVoucherVisibleClose()},showVoucherVisibleClose:function(){$("#list").setGridParam({postData:JSON.stringify(this.filterBody)}).trigger("reloadGrid"),this.selectListId=[],this.isContinue=!1},showOption:function(){this.showOptionVisible=!0,this._queryTypeId(this.initInfo.objectTypeId)},closeOption:function(){this.showOptionVisible=!1},saveOption:function(){var t=this;console.log(t.optionInfo,"===that.optionInfo");var e=baseURL+"generatingCredentialOption/update",i=new FormData;i.append("abnormalDataProcessing",parseInt(t.optionInfo.abnormalDataProcessing)),i.append("abnormalErrorHandling",parseInt(t.optionInfo.abnormalErrorHandling)),i.append("subjectMergerDebit",t.optionInfo.subjectMergerDebit),i.append("subjectMergerLender",t.optionInfo.subjectMergerLender),i.append("ownershipSystem",2),http.post(e,i).then(function(e){"100100"===e.code&&t.closeOption(),t.$Message.info({content:e.msg,duration:3})},function(e){})},_getData:function(){var t=this,e=baseURL+"verificationSheet/getData";http.post(e,"").then(function(e){"100100"===e.code&&(t.filterBody.timeStart=e.data.startDate,t.filterBody.timeEnd=e.data.endDate,console.log(" that.filterBody",t.filterBody),t._ajaxGetData())},function(e){})},showVoucher:function(e){this.showVoucherVisible=e},showViewReport:function(){this.viewReportVisible=!this.viewReportVisible},closeWindow:function(){window.parent.closeCurrentTab({name:"应收应付生成凭证",openTime:this.openTime,url:this.openTime,exit:!0})},getObjectType:function(e){return 1<=e&&e<=6?"1":7<=e&&e<=12?"2":"3"}},computed:{selectRowDisabled:function(){return 0===this.selectListId.length}},mounted:function(){console.log(layui.data("user")),this._getData(),this._queryObject(),this.openTime=window.parent.params&&window.parent.params.openTime}});