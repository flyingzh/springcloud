<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--<meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="${rc.contextPath}/ktc/css/base.css">  <script>var contextPath='${rc.contextPath}';</script>
    <link rel="stylesheet" href="${rc.contextPath}/ktc/css/inner_gold.css">
    <link rel="stylesheet" href="${rc.contextPath}/ktc/css/gold.css">
    <link rel="stylesheet" href="${rc.contextPath}/css/bootstrap.min.css">
    <link rel="stylesheet" href="${rc.contextPath}/css/main.css">
    <link rel="stylesheet" href="${rc.contextPath}/plugins/layui/css/layui.css">
    <link rel="stylesheet" href="${rc.contextPath}/plugins/jqgrid/ui.jqgrid-bootstrap.css">
    <link rel="stylesheet" href="${rc.contextPath}/plugins/ztree/css/zTreeStyle/zTreeStyle.css">  
    <link rel="stylesheet" href="${rc.contextPath}/css/iview.css"><script>var contextPath = '${rc.contextPath}';var rcContextPath = '${rc.contextPath}';</script>
    <link rel="stylesheet" href="${rc.contextPath}/ktc/css/common.css">    
    <link rel="stylesheet" href="${rc.contextPath}/css/basedata/ht-list-common.css">-->

    <style> 
    
     [v-cloak]
      { display: none } 
        .hidden-input{
            visibility: hidden;
            width:0;
            height: 0;
        }
        .hidden-input~label{
            position: absolute;
            top:0;
            right:130px;
        }
        .spec-input~label{
            left:750px;
        }
      .department-select .ivu-modal {
            width: 70% !important;
        }

        .department-select .ivu-form-item {
            display: inline-block;
        }

        .department-select .my-checkbox,
        .department-select .name,
        .department-select .code {
            display: inline-block;
            text-align: center;
            height: 30px;
            line-height: 30px;
        }
        .department-select .my-checkbox{
            width: 40px;
            float: left;
        }
        .department-select .ivu-form-item{
            margin-bottom: 0;
        }

        .department-select .name,
        .department-select .code {
            width: 100px;
            border-left: 1px solid #ccc;
        }

        .department-select .item {
            border-top: 1px solid #ccc;
        }
        btn-menu .ivu-btn{
            font-size:14px !important;
            padding:0px 10px!important;
        }
        /*.ui-jqgrid .ui-jqgrid-pager{*/
            /*margin-bottom:250px !important;*/
        /*}*/
        .ht-calc-width{
            width:calc(33.3% + 320px);
        }

    </style>
    <title>纠正预防单-新增</title>
    #parse("modules/public/header.html")
</head>

<body>
    <div id="corrective" v-cloak>
        <div>
            <div class="btn-menu ht-menu-fix">
                #if($shiro.hasPermission("quality:tQcCorrectPreventDocum:add"))
                <i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="add">新增</i-button>
                #end
                #if($shiro.hasPermission("quality:tQcCorrectPreventDocum:save"))
                <i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="save">保存</i-button>
                #end
                <!--#if($shiro.hasPermission("quality:tQcCorrectPreventDocum:issueRelease"))-->
                <i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="issueRelease">问题发布</i-button>
                <!--#end-->
                #if($shiro.hasPermission("quality:tQcCorrectPreventDocum:issueAnalysis"))
                <i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="issueAnalysis">问题分析</i-button>
                #end
                #if($shiro.hasPermission("quality:tQcCorrectPreventDocum:issuePrevent"))
                <i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="issuePrevent">纠正预防</i-button>
                #end
                #if($shiro.hasPermission("quality:tQcCorrectPreventDocum:issueVerify"))
                <i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="issueVerify">问题验证</i-button>
                #end
                #if($shiro.hasPermission("quality:tQcCorrectPreventDocum:admit"))
                <i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="submit">提交</i-button>
                #end
                <i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="approval">审核</i-button>
                <i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="reject">驳回</i-button>
                <i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="showlist">列表</i-button>
                <!--<i-button type="text" :disabled="btnShow" class="pd-rg-md" @click="addattachment">附件</i-button>-->
                <i-button type="text" class="pd-rg-md" @click="exit">退出</i-button>
            </div>
            <div class="ht-menu-top">
                <div class="ht-approve-stamp" v-if="isStampShow">
                    审核
                </div>
                <i-form label-width="120">
                    <ht-approve-reject
                            :can-reject-when-audit="canRejectWhenAudit"
                            :status-map="statusMap"
                            :trigger="modalTrigger"
                            :modal-type="modalType"
                            :receipt-id="corrective.documentCode"
                            :receipt-status="corrective.documentStatus"
                            :step-list.sync="stepList"
                            :table-data.sync="approvalTableData"
                            url-check='${rc.contextPath}/tQcCorrectPreventDocument/findUserOperation'
                            url-init-approve='${rc.contextPath}/tQcCorrectPreventDocument/queryProcessByReceiptsId'
                            url-approve='${rc.contextPath}/tQcCorrectPreventDocument/submitApproval'
                            url-table-data='${rc.contextPath}/tQcCorrectPreventDocument/queryReceiptsById'
                            @on-auto-approve="autoSubmitOrReject"
                            @on-approve="approvalOrRejectCallBack"
                            @on-reject="approvalOrRejectCallBack"
                            ref="ar">
                    </ht-approve-reject>
                        <row>
                            <i-col span="8">
                            <form-item label="单据编号：" class="ht-star">
                                <i-input disabled class="ht-width-input" placeholder="保存时自动生成" v-model="corrective.documentCode"></i-input>
                                <!--<span class="star"></span>-->
                            </form-item>
                            <form-item label="业务流向：" class="ht-star">
                                <i-select disabled class="ht-width-input" v-model="corrective.businessFlowDirection">
                                    <i-option v-for="item in businessFlowDirectionList" :value="item.value">{{item.name}}</i-option>
                                </i-select>
                                <!--<span class="star"></span>-->
                            </form-item>
                        </i-col>
                        <i-col span="8">
                            <form-item label="单据日期：" class="ht-star">
                                <i-input disabled class="ht-width-input" v-model="corrective.documentDate"></i-input>
                                <!--<span class="star"></span>-->
                            </form-item>
                        </i-col>
                        <i-col span="8">
                            <form-item label="单据状态：" class="ht-star">
                               <i-select disabled class="ht-width-input" v-model="corrective.documentStatus">
                                   <i-option v-for="item in documentStatusList" :value="item.value">{{item.name}}</i-option>
                               </i-select>
                               <!--<span class="star"></span>-->
                            </form-item>
                        </i-col>
                   </row>
                   <tabs value="name1">
                        <tab-pane label="基本信息" name="name1">
                            <div class="ht-subtitle mg-top-md">
                                <div>问题发布</div>
                            </div>
                            <i-form label-width="120" :model="release" ref="release" :rules="releaseValidate">
                            <row>
                                <i-col span="8">                                    
                                    <form-item label="源单类型：" prop="sourceDocumentType">
                                        <i-select
                                                class="ht-width-input"
                                                v-model="release.sourceDocumentType"
                                                @on-change="htTestChange"
                                                :disabled="releaseDisable"
                                        >
                                            <i-option v-for="item in DocumentTypeList" :value="item.value">{{item.name}}</i-option>
                                        </i-select>
                                        <!--<input type="text" required v-if="!releaseDisable" name="sourceDocumentType"  v-model="release.sourceDocumentType" class="inline-block hidden-input ">-->
                                        <!--<span class="star"></span>-->
                                    </form-item>
                                    <form-item label="源单单号：" prop="sourceDocumentCode">
                                         <i-input
                                                 class="ht-width-input"
                                                 class="inline-block"
                                                 :disabled="releaseDisable"
                                                 icon="search"
                                                 @on-click="showTypeCode(releaseDisable)"
                                                 v-model="release.sourceDocumentCode"
                                         ></i-input>

                                        <!--<input type="text" required name="code" v-if="!releaseDisable" v-model="release.sourceDocumentCode" class=" hidden-input ">-->
                                        <!--<span class="star"></span>-->
                                    </form-item>
                                    <form-item label="发出日期：" prop="issueDate">
                                        <i-input class="ht-width-input" disabled v-model="release.issueDate"></i-input>
                                        <!--<input type="text" required  v-if="!releaseDisable" name="issueDate"  v-model="release.issueDate" class="inline-block hidden-input ">-->
                                        <!--<span class="star"></span>-->
                                    </form-item>
                                </i-col>
                                <i-col span="8">
                                    <department-select :show-modal="showDepartmentModal" v-model="department_selected" @sure=departmentOk @cancel=departmentOk ></department-select>
                                    <form-item label="发出部门：" prop="issueDepartmentName">
                                        <i-input  class="ht-width-input" icon="search" :disabled="releaseDisable"
                                                 v-model="release.issueDepartmentName"
                                                 @on-click="showDepartmentTree('发出部门',releaseDisable)"
                                        ></i-input>
                                        <!--<input type="text" required name="ggggg"  v-if="!releaseDisable" v-model="release.issueDepartmentName" class="inline-block hidden-input ">-->
                                        <!--<span class="star"></span>-->
                                        <div v-show="showDepartment === '发出部门'" style="position: absolute;top: 33px; left: 0;z-index: 8;background: #fff;border: 1px solid #ccc;">
                                            <ht-tree url="${rc.contextPath}/tQcCorrectPreventDocument/querydeptbyorganid" :setting="treeSetting"></ht-tree>
                                        </div>
                                    </form-item>
                                    <form-item label="发出人：" prop="issuePersonId">
                                        <i-select
                                                v-model="release.issuePersonId"
                                                class="ht-width-input"
                                                @on-change="htTestChange"
                                                :disabled="releaseDisable">
                                            <i-option v-for="item in empList" :value="item.id" :label="item.empName" :key="item.empCode">
                                                <slot>{{item.empCode}} | {{ item.empName }}</slot>
                                            </i-option>
                                        </i-select>
                                        <!--<input type="text" required name="issuePerson"  v-if="!releaseDisable" v-model="release.issuePersonId" class="inline-block hidden-input ">-->
                                        <!--<span class="star"></span>-->
                                    </form-item>
                                </i-col>
                                <i-col span="8">
                                    <form-item label="接收部门：" prop="receiveDepartmentName">
                                        <i-input  class="ht-width-input" icon="search" :disabled="releaseDisable"
                                                 v-model="release.receiveDepartmentName"
                                                 @on-click="showDepartmentTree('接收部门',releaseDisable)"
                                        ></i-input>
                                        <!--<input type="text" required name="receiveDepartmentName"  v-if="!releaseDisable" v-model="release.receiveDepartmentName" class="inline-block hidden-input ">-->
                                        <!--<span class="star"></span>-->
                                        <div v-show="showDepartment === '接收部门'" style="position: absolute;top: 33px; left: 0;z-index: 8;background: #fff;border: 1px solid #ccc;">
                                            <ht-tree url="${rc.contextPath}/tQcCorrectPreventDocument/querydeptbyorganid" :setting="receiveTreeSetting"></ht-tree>
                                        </div>
                                    </form-item>
                                    <form-item label="要求回复时间：" prop="demandReplyDate">
                                        <!-- <date-select  style="width:300px" :disabled="releaseDisable" placeholder="请选择日期" v-model="release.demandReplyDate"></date-select> -->
                                        <date-picker
                                                v-if="!releaseDisable"
                                                transfer
                                                format="yyyy-MM-dd"
                                                type="date"
                                                :disabled="releaseDisable"
                                                class="ht-width-input"
                                                placeholder="Select date"
                                                @on-change="htTestChange()"
                                                v-model="release.demandReplyDate"
                                        ></date-picker>
                                        <i-input class="ht-width-input" disabled v-model="release.demandReplyDate" v-if="releaseDisable"></i-input>
                                        <!--<input type="text" required name="date"  v-if="!releaseDisable" v-model="release.demandReplyDate" class="inline-block hidden-input ">-->
                                        <!--<span class="star"></span>-->
                                    </form-item>
                                </i-col>
                            </row>
                            <form-item label="问题来源：">
                                <checkbox-group v-model="release.problemSourceId" @on-change="htTestChange">
                                    <checkbox v-for="item in problemSourceList" :label="item.id" :disabled="releaseDisable">{{item.name}}</checkbox>                                   
                                </checkbox-group>
                            </form-item>
                            <form-item label="问题描述：" class="ht-calc-width" prop="problemDescribe">
                                <i-input
                                        type="textarea"
                                        :rows="4"
                                        @on-change="htTestChange"
                                        v-model="release.problemDescribe"
                                        :disabled="releaseDisable"></i-input>
                                <!--<input type="text" required name="description"  v-if="!releaseDisable" v-model="release.problemDescribe" class="inline-block hidden-input ">-->
                                <!--<span class="star"></span>-->
                            </form-item> 
                            <row>
                                <i-col span="8">
                                    <form-item label="分析部门：" prop="analyseDepartmentName">
                                        <i-input class="ht-width-input" icon="search"
                                                 :disabled="releaseDisable"
                                                 v-model="release.analyseDepartmentName"
                                                 @on-click="showDepartmentTree('分析部门',releaseDisable)"
                                        ></i-input>
                                        <!--<input type="text" required name="depart"  v-if="!releaseDisable" v-model="release.analyseDepartmentName" class="inline-block hidden-input ">-->
                                        <!--<span class="star"></span>-->
                                        <div v-show="showDepartment==='分析部门'" style="position: absolute;top: 33px; left: 0;z-index: 8;background: #fff;border: 1px solid #ccc;">
                                            <ht-tree url="${rc.contextPath}/tQcCorrectPreventDocument/querydeptbyorganid" :setting="analyseTreeSetting"></ht-tree>
                                        </div>
                                    </form-item>
                                </i-col>
                                <i-col>
                                    <form-item label="分析人员：" prop="analysePersonnelId">
                                        <i-select
                                                v-model="release.analysePersonnelId"
                                                  class="ht-width-input"
                                                @on-change="htTestChange"
                                                :disabled="releaseDisable">
                                            <i-option v-for="item in empList" :value="item.id" :label="item.empName" :key="item.empCode">
                                                <slot>{{item.empCode}} | {{ item.empName }}</slot>
                                            </i-option>
                                        </i-select>
                                        <!--<input type="text" required name="deperson"  v-if="!releaseDisable"  v-model="release.analysePersonnelId" class="inline-block hidden-input spec-input">-->
                                        <!--<span class="star"></span>-->
                                    </form-item>
                                </i-col>
                            </row> 
                            <ht-sourcelist :show-modal="showSourceModal" :source-type="release.sourceDocumentType" @cancel="closeSourceModal"  style="width:400px" v-model="release.sourceDocumentCode" @sure="closeSourceModal" style="height:0"></ht-sourcelist>
                            </i-form>
                            <div class="ht-subtitle mg-top-md">
                                <div>问题分析</div>
                            </div>
                            <i-form label-width="120" :model="analyse" ref="analyse" :rules="analyseValidate">
                                <row>
                                    <i-col span="8">
                                        <form-item label="分析日期：">
                                            <i-input class="ht-width-input"  v-model="analyse.analyseDate" disabled></i-input>
                                        </form-item>
                                    </i-col>
                                    <i-col span="8">
                                        <form-item label="责任部门："  prop="dutyDepartmentName">
                                            <i-input class="ht-width-input" icon="search" :disabled="analyseDisable"
                                                     v-model="analyse.dutyDepartmentName"
                                                     @on-click="showDepartmentTree('责任部门',analyseDisable)"
                                            ></i-input>
                                            <!--<input type="text" required name="dename"  v-if="!analyseDisable"  v-model="analyse.dutyDepartmentName" class="inline-block hidden-input ">-->
                                            <!--<span class="star"></span>-->
                                            <div v-show="showDepartment === '责任部门'" style="position: absolute;top: 33px; left: 0;z-index: 8;background: #fff;border: 1px solid #ccc;">
                                                <ht-tree url="${rc.contextPath}/tQcCorrectPreventDocument/querydeptbyorganid" :setting="dutyTreeSetting"></ht-tree>
                                            </div>
                                        </form-item>
                                    </i-col>
                                    <i-col span="8">
                                        <form-item label="责任人：" prop="dutyPersonnelId">
                                             <!--<i-input class="ht-width-input" v-model="release.dutyPersonnelId"></i-input>-->
                                            <i-select
                                                    @on-change="htTestChange"
                                                    v-model="analyse.dutyPersonnelId"
                                                    class="ht-width-input"
                                                    :disabled="analyseDisable">
                                                <i-option v-for="item in empList" :value="item.id" :label="item.empName" :key="item.empCode">
                                                    <slot>{{item.empCode}}|{{ item.empName }}</slot>
                                                </i-option>
                                            </i-select>
                                            <!--<input type="text" required name="dutyPerson"  v-if="!analyseDisable" v-model="analyse.dutyPersonnelId" class="inline-block hidden-input ">-->
                                            <!--<span class="star"></span>-->
                                        </form-item>
                                    </i-col>

                                </row>
                                <form-item label="原因分析：" class="ht-calc-width" prop="reasonAnalyse">
                                    <i-input
                                            type="textarea"
                                            :rows="4"
                                            v-model="analyse.reasonAnalyse"
                                            @on-change="htTestChange"
                                            :disabled="analyseDisable"></i-input>
                                    <!--<input type="text" required name="reasonAnalyse"   v-if="!analyseDisable" v-model="analyse.reasonAnalyse" class="inline-block hidden-input ">-->
                                    <!--<span class="star"></span>-->
                                </form-item>
                            </i-form>
                            <div class="ht-subtitle mg-top-md">
                                <div>纠正预防</div>
                            </div>
                            <i-form label-width="120" :model="prevent" ref="prevent" :rules="preventValidate">
                                <row>
                                   <i-col span="8">
                                        <form-item label="日期：">
                                            <i-input class="ht-width-input" disabled v-model="prevent.correctPreventDate"></i-input>
                                            <span class="star"></span>
                                        </form-item>
                                   </i-col>
                                </row>
                                <form-item label="纠正措施：" class="ht-calc-width" prop="correctAction">
                                    <i-input
                                            :disabled="correctiveDisable"
                                            type="textarea"
                                            :rows="4"
                                            @on-change="htTestChange"
                                            v-model="prevent.correctAction"
                                    ></i-input>
                                    <!--<input type="text" required name="correctAction"  v-if="!correctiveDisable" v-model="prevent.correctAction" class="inline-block hidden-input ">-->
                                    <!--<span class="star"></span>-->
                                </form-item>
                                <form-item label="预防措施：" class="ht-calc-width" prop="preventAction">
                                    <i-input
                                            :disabled="correctiveDisable"
                                            type="textarea" :rows="4"
                                            v-model="prevent.preventAction"
                                            @on-change="htTestChange"
                                    ></i-input>
                                    <!--<input type="text" required name="preventAction"  v-if="!correctiveDisable" v-model="prevent.preventAction" class="inline-block hidden-input ">-->
                                    <!--<span class="star"></span>-->
                                </form-item>
                                <row>
                                    <i-col span="8">
                                        <form-item label="验证部门："  prop="validateDepartmentName">
                                            <i-input class="ht-width-input" icon="search" :disabled="correctiveDisable"
                                                     v-model="prevent.validateDepartmentName"
                                                     @on-click="showDepartmentTree('验证部门',correctiveDisable)"
                                            ></i-input>
                                            <!--<input type="text" required name="validatedepart"  v-if="!correctiveDisable" v-model="prevent.validateDepartmentName" class="inline-block hidden-input ">-->
                                            <!--<span class="star"></span>-->
                                            <div v-show="showDepartment === '验证部门'" style="position: absolute;top: 33px; left: 0;z-index: 8;background: #fff;border: 1px solid #ccc;">
                                                <ht-tree url="${rc.contextPath}/tQcCorrectPreventDocument/querydeptbyorganid" :setting="validateTreeSetting"></ht-tree>
                                            </div>
                                        </form-item>
                                    </i-col>
                                    <i-col span="8">
                                        <form-item label="验证员：" prop="validatePersonnelId">
                                            <i-select
                                                    :disabled="correctiveDisable"
                                                    v-model="prevent.validatePersonnelId"
                                                    @on-change="htTestChange"
                                                    class="ht-width-input">
                                                <i-option v-for="item in empList" :value="item.id" :label="item.empName" :key="item.empCode">
                                                    <slot>{{item.empCode}} | {{ item.empName }}</slot>
                                                </i-option>
                                            </i-select>
                                            <!--<input type="text" required name="validatePersonnel" v-if="!correctiveDisable" v-model="prevent.validatePersonnelId" class="inline-block hidden-input ">-->
                                            <!--<span class="star"></span>-->
                                        </form-item>
                                    </i-col>
                                </row>
                            </i-form>
                            <div class="ht-subtitle mg-top-md">
                                <div>验证结果</div>
                            </div>
                            <i-form label-width="120" :model="validation" ref="validation" :rules="validationValidate">
                                <row>
                                    <i-col span="8">
                                        <form-item label="验证日期：" prop="validateDate">
                                            <i-input  :disabled="validateDisable" class="ht-width-input" disabled v-model="validation.validateDate"></i-input>
                                            <!--<input type="text" required name="validateDate" v-if="!validateDisable" v-model="validation.validateDate" class="inline-block hidden-input ">  -->
                                            <!--<span class="star"></span>-->
                                        </form-item>
                                    </i-col>
                                </row>
                                <form-item label="验证结果描述：" class="ht-calc-width">
                                    <i-input  @on-change="htTestChange" :disabled="validateDisable"  type="textarea" :rows="4"  v-model="validation.validateResultDescribe"></i-input>
                                </form-item>
                                <form-item label="验证结果：">
                                    <radio-group v-model="validation.validateResult" @on-change="htTestChange">
                                        <radio  :disabled="validateDisable" v-for="item in resultList" :label="item.value">{{item.name}}</radio>

                                    </radio-group>
                                </form-item>
                                <form-item label="跟踪结论：">
                                    <radio-group v-model="validation.followConclusion" @on-change="htTestChange">
                                        <radio  :disabled="validateDisable" v-for="item in conclusionList" :label="item.value">{{item.name}}</radio>
                                        <!-- <radio label="不合格"></radio>                                   -->
                                    </radio-group>
                                </form-item>
                            </i-form>
                        </tab-pane>
                      
                        <tab-pane label="审批信息" name="name2">
                            <steps :current="stepList[1] && stepList[1].currentLevel" style="margin-bottom: 20px;">
                                <step icon="checkmark-circled" v-for="item in stepList" :title="item.processLevel" :content="typeof(item.userName) =='undefined'?'':'当前节点审批人：'+item.userName"></step>
                            </steps>
                            <table class="table edit-table" style="width: 1100px;">
                                <tr>
                                    <th>操作类型</th>
                                    <th>开始级次</th>
                                    <th>目的级次</th>
                                    <th>审批人</th>
                                    <th>审批意见</th>
                                    <th>审批时间</th>
                                </tr>
                                <tr v-for="item in approvalTableData">
                                    <td>{{item.approvalResult}}</td>
                                    <td>{{item.currentLevel}}</td>
                                    <td>{{item.nextLevel}}</td>
                                    <td>{{item.createName}}</td>
                                    <td>{{item.approvalInfo}}</td>
                                    <td>{{item.createTime}}</td>
                                </tr>
                            </table>
                        </tab-pane>
                        <tab-pane label="其他" name="name3">
                            <i-form :model="other" label-width="120" >
                                <row class="mg-top-md">
                                    <i-col span="8">
                                        <div>
                                            <form-item label="创建人：">
                                                    <i-input disabled class="ht-width-input" v-model="other.createName"></i-input>
                                            </form-item>
                                            <form-item label="创建日期：">
                                                    <i-input disabled class="ht-width-input" v-model="other.createTime"></i-input>
                                            </form-item>
                                        </div>
                                    </i-col>
                                    <i-col span="8">
                                        <div>
                                            <form-item label="修改人：">
                                                    <i-input disabled class="ht-width-input" v-model="other.updateName"></i-input>
                                            </form-item>
                                            <form-item label="修改日期：">
                                                    <i-input disabled class="ht-width-input" v-model="other.updateTime"></i-input>
                                            </form-item>
                                        </div>
                                    </i-col>
                                    <i-col span="8">
                                        <div>
                                            <form-item label="审核人：">
                                                    <i-input disabled class="ht-width-input" v-model="other.examineVerifyName"></i-input>
                                            </form-item>
                                            <form-item label="审核日期：">
                                                    <i-input disabled class="ht-width-input" v-model="other.examineVerifyDate"></i-input>
                                            </form-item>
                                        </div>
                                    </i-col>
                                </row> 
                            </i-form>
                        </tab-pane>
                        <tab-pane label="附件" name="name4">
                                <i-button v-show = "uploadShow" type="primary" @click="uploadfile">上传文件</i-button>
                                <form action="">
                                    <table class="edit-table">
                                        <thead>
                                        <tr>
                                            <th>序号</th>
                                            <th>文件名</th>
                                            <th>文件大小</th>
                                            <th>上传人</th>
                                            <th>上传时间</th>
                                            <th>操作</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr v-for="(item,index) in files.sysFile.fileDetails" v-show="!item.del">
                                            <td>{{index+1}}</td>
                                            <td>{{item.fdName}}</td>
                                            <td>{{item.fdSize}}</td>
                                            <td>{{item.uploadUser}}</td>
                                            <td>{{item.uploadTime}}</td>
                                            <td>
                                                <a href="" @click.prevent="download(item)" >下载</a>
                                                <a v-show = "uploadShow" href="" @click.prevent="delFile(item)">删除</a>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </form>
                        </tab-pane>
                    </tabs>
                </i-form>
            </div>
        </div>
        <Modal
                v-model="showUpload"
                title="上传文件">
               <!-- @on-ok="modalOk"
                @on-cancel="modalCancel"-->
            <Upload
                    ref="upload"
                    :on-success="handleSuccess"
                    :max-size="2048"
                    :on-exceeded-size="handleMaxSize"
                    multiple
                    action='${rc.contextPath}/tQcCorrectPreventDocument/fileUploads'>
                <i-button type="ghost" icon="ios-cloud-upload-outline">开始上传</i-button>
                <span>文件上传大小限制为2M以内</span>
            </Upload>
        </Modal>
        <ht-close-modal ref="closeModalRef" @click="closeModal"></ht-close-modal>
    </div>

    <script src="${rc.contextPath}/plugins/layui/layui.all.js"></script>
    <script src='${rc.contextPath}/js/jquery-2.0.3.min.js'></script>
    <script src='${rc.contextPath}/js/vue.min.js'></script>
    <script src='${rc.contextPath}/plugins/jquery-validation-1.17/jquery.validate.min.js'></script>
    <script src="${rc.contextPath}/plugins/jquery-validation-1.17/additional-methods.min.js"></script>
    <script src='${rc.contextPath}/plugins/jquery-validation-1.17/messages_zh.js'></script>
    <script src="${rc.contextPath}/plugins/ztree/jquery.ztree.all.min.js"></script>
    <script src='${rc.contextPath}/plugins/jqgrid/jquery.jqGrid.min.js'></script>
    <script src="${rc.contextPath}/plugins/jqgrid/grid.locale-cn.js"></script>
    <script src="${rc.contextPath}/plugins/layui/layui.all.js"></script>
    <script src='${rc.contextPath}/ktc/js/app.js'></script>
    <script src="${rc.contextPath}/plugins/iview/iview.min.js"></script>
    <script src="${rc.contextPath}/js/quality/components/ht-tree.js"> </script>
    <script src="${rc.contextPath}/js/components/ht-approve-reject.js"> </script>
    <script src="${rc.contextPath}/js/components/ht-close-modal.js"> </script>
    <script src="${rc.contextPath}/js/basedata/components/date-select.js"> </script>
    <script src="${rc.contextPath}/js/quality/components/base-data-list.js"> </script>
    <script src="${rc.contextPath}/js/basedata/components/subject-tree.js"> </script>
    <script src="${rc.contextPath}/js/basedata/components/department-select.js"> </script>
    <script src="${rc.contextPath}/js/quality/components/ht-selectSourceList.js"> </script>
    <script src="${rc.contextPath}/js/quality/components/ht-btns.js"> </script>
    <script src='${rc.contextPath}/js/quality/corrective-prevention-sheet.js'></script>
    <!-- <script src="./corrective-prevention-sheet-1.js"> </script> -->


#parse("modules/public/footer.html") </body>

</html>