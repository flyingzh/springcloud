"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Vue.component("base-data-list",{props:{data_config:{type:String,require:!0},needReload:{require:!1,type:Object},table_id:{require:!1,type:String,default:function(){return("list"+1e8*Math.random()).substring(0,8)}},pager_id:{require:!1,type:String,default:function(){return("list"+1e8*Math.random()).substring(0,8)}},returnRowData:{require:!1,type:Boolean,default:!1}},data:function(){var i=this;return{selected:[],idKey:"",responseRaw:[],base_config:{ajaxGridOptions:{complete:function(t,e){"string"==typeof t.responseText?i.responseRaw=JSON.parse(t.responseText):i.responseRaw=t.responseText}},jsonReader:{root:"data.list",total:"data.totalPage",records:"data.totalCount",cell:"list"},mtype:"POST",contentType:"application/json",datatype:"json",styleUI:"Bootstrap",rownumbers:!0,multiselectWidth:50,viewrecords:!0,rowNum:10,rowList:[10,20,30,40],onSelectAll:function(t,e){i.handlerId(t,e),i.$emit("input",i.selected)},onSelectRow:function(t,e){i.handlerId(t,e),i.$emit("input",i.selected)},onPaging:function(){},beforeSelectRow:function(){i.data_config.singleSelect&&(i.selected=[],$("#"+i.table_id).jqGrid("resetSelection"))},gridComplete:function(){if(i.data_config.singleSelect){var t=$("#"+i.table_id);$("#cb_"+t[0].id).hide()}}}}},methods:{handlerId:function(t,e){var a=this;if("object"===(void 0===t?"undefined":_typeof(t))&&e&&(this.selected=t),"object"!==(void 0===t?"undefined":_typeof(t))||e||(this.selected=[]),"string"==typeof t)if(e)!(-1<this.selected.indexOf(t.toString()))&&this.selected.push(t.toString());else{var i=this.selected.indexOf(t.toString());-1<i&&this.selected.splice(i,1)}if(1==this.returnRowData){var o=$("#"+this.table_id).jqGrid("getGridParam","selarrrow");if(0<o.length){var n=[],r=this.responseRaw,d=o.map(function(t){return Number(t.toString())});r.data&&r.data.list[0].hasOwnProperty("id")&&!a.idKey&&(a.idKey="id"),$.each(r.data&&r.data.list,function(t,e){var i=!1;""!=a.idKey?-1<$.inArray(e[a.idKey].toString(),o)&&(i=!0):-1<$.inArray(t+1,d)&&(i=!0),i&&n.push(e)}),this.selected=n}else this.selected=[]}},jqGridInit:function(){var i=this,t=Object.assign(this.data_config,this.base_config,{multiselect:!1!==this.data_config.multiselect,colNames:this.data_config.colNames,colModel:this.data_config.colModel.map(function(t){return Object.assign(t,{sortable:!1})}),caption:this.data_config.caption,postData:this.$parent.body||this.$root.body,url:this.data_config.url||"./baseDataList.json",multiboxonly:!!this.data_config.multiboxonly,pager:i.pager_id,prmNames:{page:"page",rows:"limit",order:"order",id:"remark"}});!1===this.data_config.shrinkToFit?Object.assign(t,{shrinkToFit:!1}):Object.assign(t,{width:"99%",autowidth:!0}),$.each(t.colModel,function(t,e){if("id"==e.name)return i.idKey=e.name,!1}),$.each(t.colModel,function(t,e){if(void 0!==e.key&&1==e.key)return i.idKey=e.name,!1}),jQuery("#"+i.table_id).jqGrid(t),jQuery("#"+i.table_id).jqGrid("navGrid","#"+i.table_id,{edit:!1,add:!1,del:!1})},jqGridClearData:function(){$("#"+this.table_id).jqGrid("clearGridData")},reload:function(){this.selected=[];var t={postData:this.$parent.body||this.$root.body};console.log(t),this.jqGridClearData(),$("#"+this.table_id).jqGrid("setGridParam",t).trigger("reloadGrid"),console.log("组件内部")}},watch:{needReload:function(){this.reload()}},mounted:function(){this.jqGridInit()},template:'<div class="jqGrid_wrapper">\n        <table :id="table_id"></table> \n        <div :id="pager_id"></div>\n        </div>'});