"use strict";var _methods;function _defineProperty(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}Vue.component("edit-formula",{data:function(){return _defineProperty({show:this.value,dataList:[],computeTypes:[{label:"1001 库存现金",value:1},{label:"100101 现金",value:11},{label:"100102 库存外币",value:12},{label:"1002 银行存款",value:2}],reportFormula:{id:0,accountId:0,discountSubject:"",rowNum:0,computeType:"",valueRule:0,computeTypeName:"",reportContentId:0,reportContentName:""},subjectVisable:!1,reload:!0,curTable:"",currentSelectRow:"",addData:"",operatorList:[{label:"+",value:1},{label:"-",value:2}],monList:[{label:"期初余额",value:1},{label:"期末余额",value:2},{label:"借方发生额",value:3},{label:"贷方发生额",value:4},{label:"借方本年累计发生额",value:5},{label:"贷方本年累计发生额",value:6},{label:"利润表本期实际发生额",value:7},{label:"利润表本年实际发生额",value:8}]},"subjectVisable",!1)},methods:(_methods={showSubjectVisable:function(){this.subjectVisable=!0},subjectClose:function(){this.subjectVisable=!1},subjectData:function(t){console.log(t,"====treeNode"),this.reportFormula.accountId=t.id,this.reportFormula.discountSubject=t.subjectName},editClick:function(t){console.log(t)},closeModal:function(){this.$emit("close")},selectSub:function(){this.subjectVisable=!0}},_defineProperty(_methods,"subjectClose",function(){this.subjectVisable=!1}),_defineProperty(_methods,"add",function(){var e=this,a=!0;console.log(e.dataList,"==== _this.dataList"),0<e.dataList.length&&e.dataList.forEach(function(t){t.accountId===e.reportFormula.accountId&&t.valueRule===e.reportFormula.valueRule&&(a=!1,e.$Message.info({content:"科目和取数规则重复",duration:3}))}),a&&this._ajaxAddData()}),_defineProperty(_methods,"_ajaxAddData",function(){var a=this,t=contextPath+"/report/saveFormula";this.reportFormula.reportContentId=this.fatherid,this.reportFormula.reportContentName=this.headline,this.reportFormula.rowNum=this.rowNums;var e=a.reportFormula;console.log(e,"_parmes========"),$.ajax({type:"post",data:JSON.stringify(e),url:t,dataType:"json",contentType:"application/json;charset=utf-8",success:function(t){console.log(t,"------------");var e="";e=("100100"===t.code&&setTimeout(function(){a._ajaxList()},1e3),t.msg),a.$Message.info({content:e,duration:3})},error:function(t){console.log(t)}})}),_defineProperty(_methods,"save",function(){this.$emit("close")}),_defineProperty(_methods,"_ajaxDelete",function(t){var a=this,e=contextPath+"/report/deleteFormula";$.ajax({type:"post",data:{id:t},url:e,dataType:"json",success:function(t){var e="";e=(t.code,t.msg),a.$Message.info({content:e,duration:3})},error:function(t){console.log(t)}})}),_defineProperty(_methods,"_ajaxList",function(){var o=this,t=o.$parent.formData.split("_");console.log("arr--\x3e",t);var e=contextPath+"/report/formulaList",a={rowNum:o.rowNums,tableName:"xjllb",accountYear:t[0],accountPeriod:t[1]};console.log(a,"----=-=-=-=-=-=-----"),$.ajax({type:"post",data:a,url:e,dataType:"json",success:function(t){console.log("=========res=========",t);var e="";if("100100"===t.code){var a=t.data;o.dataList=a}else e=t.msg,o.$Message.info({content:e,duration:3})},error:function(t){console.log(t)}})}),_defineProperty(_methods,"clickTr",function(t,e){this.currentSelectRow=e,this.curTable="2"}),_defineProperty(_methods,"del",function(e){console.log(e,"操作按钮----"),this._ajaxDelete(e.id);var t=this.dataList.findIndex(function(t){return t.id==e.id});t<0||this.dataList.splice(t,1)}),_defineProperty(_methods,"formatNum",function(t,e){var a=Math.pow(1e3,e);return parseInt(t*a,10)/a}),_methods),watch:{value:function(t){(this.show=t)&&this._ajaxList()}},computed:{endVal:function(){var a=this,o=0;return this.dataList.forEach(function(t){var e=t.computeType+t.amount1;o+=a.formatNum(e,1)}),(o=accounting.formatMoney(o,"",2))||0},beganVal:function(){var a=this,o=0;return this.dataList.forEach(function(t){var e=t.computeType+t.amount2;o+=a.formatNum(e,1)}),(o=accounting.formatMoney(o,"",2))||0}},filters:{filterMoney:function(t){return accounting.formatMoney(t,"",2)},filterOperate:function(t){switch(t){case 1:return"期初余额";case 2:return"期末余额";case 3:return"借方发生额";case 4:return"贷方发生额";case 5:return"借方本年累计发生额";case 6:return"贷方本年累计发生额";case 7:return"利润表本期实际发生额";case 8:return"利润表本年实际发生额"}}},props:["title","value","fatherid","rowNums","headline"],template:'\n        <div>\n            <Modal\n                :title=\'title\'\n                v-model="show"\n                width="800"\n                @on-cancel=\'closeModal\'\n                :mask-closable="false">\n                <label>科目：</label>\n                <i-input v-model="reportFormula.discountSubject" style="width:200px" readonly="true" @on-click="showSubjectVisable" icon="ios-list-outline" type="text"></i-input>\n                <label class="pl10">运算符号</label>\n                <i-select v-model="reportFormula.computeType" class="wt80 ">\n                        <i-option v-for="item in operatorList" :value="item.label" :key="item.value">{{item.label}}</i-option>\n                </i-select>\n                <label class="pl10">取数规则</label>\n                <i-select v-model="reportFormula.valueRule" class="wt125 ">\n                    <i-option v-for="item in monList" :value="item.value" :key="item.value">{{item.label}}</i-option>\n                </i-select>\n                <i-button @click="add">添加</i-button>\n                <div class="ht-receivableW-table mt10"> \n                    <div class="ht-wrapper-tbl">\n                        <table class="table tablediv">\n                            <thead>\n                            <tr>\n                                <td class="wt200">项目</td>\n                                <td class="wt100">运算方式</td>\n                                <td class="wt100">取数规则</td>\n                                <td class="wt125">本月数</td>\n                                <td class="wt100">本年数</td>\n                                <td class="wt80">操作</td>\n                            </tr>\n                            </thead>\n                            <tbody >\n                            <tr lay-size="sm" v-for="(item,idx) in dataList" @click="clickTr(item,idx)"  :class="{success: currentSelectRow === idx}" >     \n                                <td class="wt200">{{item.account}}</td>\n                                <td class="wt100">{{item.computeType}}</td>\n                                <td class="wt100">{{item.valueRule | filterOperate}}</td>\n                                <td class="wt125">{{item.amount1 | filterMoney}}</td>\n                                <td class="wt100">{{item.amount2 | filterMoney}}</td>\n                                <td class="wt80">\n                                    <Icon type="close-round" @click="del(item)"></Icon>\n                                </td>\n                            </tr>\n                            </tbody>\n                            <tfoot>\n                            <tr>\n                                <td class="wt200">合计</td>\n                                <td class="wt100"></td>\n                                <td class="wt100"></td>\n                                <td class="wt125">{{endVal}}</td>\n                                <td class="wt100">{{beganVal}}</td>\n                                <td class="wt80"></td>    \n                            </tr>\n                            </tfoot>\n                        </table>\n                    </div>\n                </div>\n                <div slot="footer">\n                    <i-button type="primary" @click="save">确定</i-button>\n                    <i-button @click="save">取消</i-button>\n                </div>\n            </Modal>\n            <ht-modal-subject v-model="subjectVisable" @close="subjectClose" @save="subjectData" ref="modalSubject"></ht-modal-subject>\n        </div>\n    '});