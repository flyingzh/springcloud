"use strict";Vue.component("ht-count-add",{data:function(){return{show:this.value,dataList:[],floatNumber:2,formData:{id:"",sobId:"",datetime:"",currencyId:"",subjectName:"",subjectCode:"",subjectId:"",remark:"",totalAmount:""},parValueStr:["100元","50元","20元","10元","5元","2元","1元","5角","2角","1角","5分","2分","1分"]}},methods:{pageInitDetail:function(){Object.assign(this.formData,this.formAdd)},editClick:function(t){console.log(t)},closeModal:function(){this.$emit("close")},refresh:function(){this.$emit("close"),this.$emit("loadtree")},formatMoney:function(t){return null==t||0==t?"0.00":accounting.formatNumber(t,2,"")},formatNum:function(t,n){var e=Math.pow(1e3,n);return parseInt(t*e,10)/e},blur_money:function(t,n){var e=100*t.hundreds*t.parValue,a=20*t.twenty*t.parValue,o=t.tails*t.parValue;t.amount=this.formatMoney(e+a+o)},getPreCheckList:function(){var a=this,t=new Date(a.formData.datetime).format("yyyy-MM-dd");$.ajax({type:"POST",url:contextPath+"/checklist/getPreCheckList",data:{time:t,currencyId:a.formData.currencyId},success:function(t){console.log(t),"100100"==t.code?(a.dataList=t.data.checkDetail,$.each(a.dataList,function(t,n){var e={parValueStr:a.parValueStr[n.sequence-1]};n.amount=a.formatMoney(n.amount),Object.assign(n,e)})):layer.alert("暂无数据")},error:function(t){console.log(t)}})},saveBooks:function(){var n=this,e=0;this.dataList.forEach(function(t){e+=t.amount}),e=accounting.formatNumber(e,n.floatNumber,""),n.formData.totalAmount=e;var t={cashCheck:n.formData,checkDetail:n.dataList};console.log(t),$.ajax({type:"POST",url:contextPath+"/checklist/saveOrUpdate",contentType:"application/json;charset=utf-8",data:JSON.stringify(t),dataType:"json",success:function(t){console.log(t),layer.alert(t.msg),"100100"==t.code&&n.refresh()},error:function(t){console.log(t)}})}},watch:{value:function(t){console.log(t),(this.show=t)&&this.pageInitDetail()}},computed:{totalAmount:function(){var n=0;return this.dataList.forEach(function(t){null!=t&&""!=t.amount&&(n+=parseFloat(t.amount))}),(n=accounting.formatNumber(n,this.floatNumber,""))||"0.00"}},filters:{filterMoney:function(t){return accounting.formatMoney(t,"",2)},filterOperate:function(t){switch(t){case"1":return"余额";case"2":return"借方余额";case"3":return"贷方余额"}}},props:["value","title","organizationList","dataList","currencyList","subjectList","periodDate","formAdd"],template:'\n\t\t\t<div>\n\t\t\t\t\t<Modal\n\t\t\t\t\t\t\t:title=\'title\'\n\t\t\t\t\t\t\tv-model="show"\n\t\t\t\t\t\t\twidth="600"\n\t\t\t\t\t\t\t@on-cancel=\'closeModal\'\n\t\t\t\t\t\t\t:mask-closable="false">\n\t\t\t\t\t\t\t<div>\n\n\t\t\t\t\t\t\t\t<Row class="pt10">\n                    \t\t\t\t\t<i-col :span="24" class="ht-lineHeight30">\n\t\t\t\t\t\t\t\t\t\t\t\t<label class="w85">所属组织</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<i-select v-model="formData.sobId" disabled style="width:450px;">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i-option v-for="item in organizationList" :value="item.value">{{item.label}}</i-option>\n\t\t\t\t\t\t\t\t\t\t\t\t</i-select>\n\t\t\t\t\t\t\t\t\t\t</i-col>\n\t\t\t\t\t\t\t\t</Row>\t\n\t\t\t\t\t\t\t\t<Row class="pt10">\n\t\t\t\t\t\t\t\t\t<i-col :span="12" class="ht-lineHeight30">\n\t\t\t\t\t\t\t\t\t\t\t<label class="w85">科目：</label>\n\t\t\t\t\t\t\t\t\t\t\t<i-select v-model="formData.subjectId" style="width:187px;">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i-option v-for="item in subjectList" :value="item.accountId">{{item.accountName}}</i-option>\n\t\t\t\t\t\t\t\t\t\t\t</i-select>\n\t\t\t\t\t\t\t\t\t</i-col>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<i-col :span="12" class="ht-lineHeight30">\n\t\t\t\t\t\t\t\t\t\t\t<label class="w85">币别：</label>\n\t\t\t\t\t\t\t\t\t\t\t<i-select v-model="formData.currencyId" style="width:166px;">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i-option v-for="item in currencyList" :value="item.id">{{item.currencyName}}</i-option>\n\t\t\t\t\t\t\t\t\t\t\t</i-select>\n\t\t\t\t\t\t\t\t\t</i-col>\n\t\t\t\t\t\t\t\t</Row>\t\t\n\t\t\t\t\t\t\t\t<Row class="pt10">\n                    \t\t\t<i-col :span="12" class="ht-lineHeight30">\n\t\t\t\t\t\t\t\t\t\t\t\t<label class="w85">日期：</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<date-picker v-model="formData.datetime" end="true" class="inline-block"></date-picker>\n\t\t\t\t\t\t\t\t\t\t</i-col>\n\t\t\t\t\t\t\t\t\t\t<i-col :span="12" class="ht-lineHeight30" style="text-align: right;padding-right: 30px;">\n\t\t\t\t\t\t\t\t\t\t\t<i-button @click="getPreCheckList">获取上次盘点数</i-button>\n                    \t\t\t</i-col>\n\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<div class="ht-receivableW-table">\n\t\t\t\t\t\t\t\t\t\t<div class="ht-wrapper-tbl">\n\t\t\t\t\t\t\t\t\t\t\t<table class="table tablediv">\n\t\t\t\t\t\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100">票面</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100">把(百张)</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100">卡(二十张)</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100">尾款数(个)</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100">金额小计</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr v-for="item in dataList">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100">{{item.parValueStr}}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100 ht-nopadding" style="background-color: #ffffff ">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<InputNumber :min="0" class="form-control input-sm ht-input ht-commTxtContent" @on-change="blur_money(item,\'hundreds\')" v-model="item.hundreds" ></InputNumber>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100 ht-nopadding" style="background-color: #ffffff ">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<InputNumber :min="0" class="form-control input-sm ht-input ht-commTxtContent" @on-change="blur_money(item,\'twenty\')" v-model="item.twenty" ></InputNumber>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100 ht-nopadding" style="background-color: #ffffff ">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<InputNumber :min="0" class="form-control input-sm ht-input ht-commTxtContent" @on-change="blur_money(item,\'tails\')" v-model="item.tails" ></InputNumber>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100" style="background-color: #eee;">{{item.amount}}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t\t\t\t\t<tfoot>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100">金额合计</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100"></td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100"></td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100"></td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="wt100">{{totalAmount}}</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tfoot>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<Row class="pt10">\n                   \t\t\t\t\t\t<i-col :span="24" class="ht-lineHeight30">\n\t\t\t\t\t\t\t\t\t\t\t\t<label class="w85">备注</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<input type="text" style="width:450px;"  v-model="formData.remark" />\n\t\t\t\t\t\t\t\t\t\t</i-col>\n\t\t\t\t\t\t\t\t</Row>\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div slot="footer">\n\t\t\t\t\t\t\t\t\t\t<i-button type="primary" @click="saveBooks">确定</i-button>\n\t\t\t\t\t\t\t\t\t\t<i-button @click="closeModal">取消</i-button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t</Modal>\n\t\t\t</div>\n\t'});