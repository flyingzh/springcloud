"use strict";function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ve=new Vue({el:"#alreadyConfirmedList",data:function(){return{subjectList:[],currencyList:[],bdt:"",edt:"",bank:"",bankAccount:"",subName:"",curName:"",filter:{subjectId:"",currencyId:"",accountYear:"",accountPeriod:"",beginDatetime:(new Date).format("yyyy-MM-dd"),endDatetime:(new Date).format("yyyy-MM-dd"),containTicked:"",qr:"1",sobId:1},years:[2013,2014,2015,2016,2017,2018,2019],months:[1,2,3,4,5,6,7,8,9,10,11,12],openTime:"",filterVisible:!1,asModal:!1,arcGroup:{date:!1,abstract:!1,settlement:!1,settlementNumber:!1,accountRestriction:!1},findRecord:"",manualGroup:{date:!1,abstract:!1,settlement:!1,settlementNumber:!1,amount:!1,accountRestriction:!1},formData:{f1:"",f2:"",f3:"",subjectName:"",subjectCode:"",subjectId:""},openData:{sobId:"",subjectId:"",subjectCode:"",subjectName:"",currencyId:"",startYear:"",endYear:"",startPeriod:"",endPeriod:"",startDate:"",endDate:"",voucherGroupId:"",startVoucherGroupNumber:"",endVoucherGroupNumber:"",explains:"",relateSubjectId:"",handleId:"",prepareId:"",showInitBalance:"",period:"1"},lodoPList:[],organisationList:[],remarkVisable:!1,remarklist:[],printModal:!1,printInfo:{}}},methods:{clickDigest:function(){this.remarkVisable=!0},onDblclickRemarkRow:function(t){this.openData.explains=t.content,this.remarkVisable=!1},onRemarkModalChange:function(t){this.remarkVisable=t},onRemarkListChange:function(t){this.remarklist=t},goBankAccountReconciliation:function(){var t=contextPath+"/finance/cashier/BankAccountReconciliation/index.html?subjectId="+this.filter.subjectId+"&currencyId="+this.filter.currencyId+"&accountYear="+this.filter.accountYear+"&accountPeriod="+this.filter.accountPeriod+"&beginDatetime="+this.bdt+"&endDatetime="+this.edt+"&containTicked="+this.filter.containTicked+"&qr="+this.filter.qr+"&sobId="+this.filter.sobId;window.parent.activeEvent({name:"银行存款对账",url:t})},saveData:function(){},canceldata:function(){},save:function(){var e=this;this.bdt=new Date(this.filter.beginDatetime).format("yyyy-MM-dd"),this.edt=new Date(this.filter.endDatetime).format("yyyy-MM-dd");var t=e.subjectList.find(function(t){return t.accountId===e.filter.subjectId});t&&(e.subName=t.accountCode+" "+t.accountName,e.bank=t.accountName);var n=e.currencyList.find(function(t){return t.currencyId===e.filter.currencyId});n&&(e.curName=n.currencyName),this.getBankAccount(),this.filterVisible=!1,$("#list").setGridParam({postData:JSON.stringify(this.filter)}).trigger("reloadGrid")},cancel:function(){this.filterVisible=!1},outHtml:function(){window.parent.closeCurrentTab({name:name,openTime:this.openTime,exit:!0})},filterOpen:function(t){this.filterVisible=t},getColSum:function(t){var e=$("td[aria-describedby='list_"+t+"']"),n=0;return(e=0!==e.children("div.sumCol").length?$("td[aria-describedby='list_"+t+"']").children("div.sumCol"):$("td[aria-describedby='list_"+t+"']:not(:last)")).each(function(t,e){n+=1e3*accounting.unformat($(e).text())}),n/=1e3,n=accounting.formatMoney(n,"",2)},pageInit:function(){var t,n=this,e=contextPath+"/bankdepositstatement/listhookedrecord";jQuery("#list").jqGrid((_defineProperty(t={url:e,postData:JSON.stringify(n.filter),ajaxGridOptions:{contentType:"application/json;charset=utf-8"},datatype:"json",colNames:["勾对id","记录","日期","凭证字号","摘要","对方科目","借方金额","贷方金额","制单人","数据来源"],height:1e5,colModel:[{name:"hookId",index:"hookId",width:100,align:"center",hidden:!0},{name:"record",index:"record",width:100,align:"center"},{name:"datetime",index:"datetime",width:150,align:"center"},{name:"voucherGroupName",index:"voucherGroupName",width:150,align:"center"},{name:"summary",index:"summary",width:100,align:"center"},{name:"relativeSubjectName",index:"relativeSubjectName",width:100,align:"center"},{name:"debitAmountFor",index:"debitAmountFor",width:100,align:"center",formatter:function(t,e,n,i){return null==n.debitAmountFor?"":accounting.formatNumber(n.debitAmountFor,2)},formatoptions:{decimalSeparator:"."}},{name:"creditAmountFor",index:"creditAmountFor",width:100,align:"center",formatter:function(t,e,n,i){return null==n.creditAmountFor?"":accounting.formatNumber(n.creditAmountFor,2)},formatoptions:{decimalSeparator:"."}},{name:"createName",index:"createName",width:100,align:"center"},{name:"dataSource",index:"dataSource",width:100,align:"center"}],rowNum:999999999,sortorder:"desc",mtype:"post",jsonReader:{root:"data",total:"totalPage",records:"totalCount",cell:"list"},sortable:!1,multiselect:!0,multikey:null,multiboxonly:!1,rownumbers:!0,styleUI:"Bootstrap"},"height",$(window).height()-200),_defineProperty(t,"viewrecords",!0),_defineProperty(t,"loadComplete",function(t){console.log(t,"===========xhr="),n.lodoPList=t.data||[]}),_defineProperty(t,"beforeRequest",function(){n.selectListId=[]}),_defineProperty(t,"onCellSelect",function(t){var e=jQuery("#list").jqGrid("getRowData",t);console.log(e,"---------=>")}),_defineProperty(t,"onSelectAll",function(t,e){console.log(t,e,"===aRowids,status=="),n.selectListId=e?t:[]}),_defineProperty(t,"onSelectRow",function(t,e){jQuery("#list").jqGrid("getRowData",t);console.log("当前选择的id==="+n.selectListId)}),_defineProperty(t,"ondblClickRow",function(t){}),t))},completeMethod:function(){$("#list").footerData("set",{code:"合计",subjectId:[0]});var t=this.getColSum("subjectId");$("#list").footerData("set",{code:"合计",subjectId:t})},getSubject:function(){var e=this;$.ajax({url:contextPath+"/cashierBalanceController/app/initCnSubject",type:"post",data:"isCash=1&status=0",dataType:"json",async:!1,success:function(t){e.subjectList=t.data}})},subjectChange:function(){console.log("subjectchange"),console.log(this.filter.subjectId);var e=this;$.ajax({url:contextPath+"/cashierBalanceController/app/initCnCurrency",type:"post",data:"accountId="+e.filter.subjectId+"&isCash=1&status=0",dataType:"json",async:!1,success:function(t){e.currencyList=t.data}})},getYear:function(){$.ajax({url:contextPath+"/bankdepositstatement/year",type:"post",dataType:"json",success:function(t){}})},getMonth:function(){$.ajax({url:contextPath+"/bankdepositstatement/month",type:"post",dataType:"json",success:function(t){}})},getOrg:function(){var e=this;$.ajax({url:contextPath+"/bankdepositstatement/getognlist",type:"post",dataType:"json",success:function(t){e.organisationList=t.data}})},getBankAccount:function(){var e=this;$.ajax({url:contextPath+"/bankdepositstatement/getbankaccount",type:"post",dataType:"json",contentType:"application/json",data:JSON.stringify(e.filter),success:function(t){e.bankAccount=t.data}})},cancelHook:function(){for(var e=this,t=[],n=$("#list").jqGrid("getGridParam","selarrrow"),i=0;i<n.length;i++){var a=$("#list").jqGrid("getRowData",n[i]);t.push(a.hookId)}if(t.length<1)return e.$Message.info({content:"未选择任何已勾对记录",duration:3}),!1;$.ajax({url:contextPath+"/bankdepositstatement/cancelhook",type:"post",dataType:"json",contentType:"application/json",data:JSON.stringify(t),success:function(t){e.$Message.info({content:t.msg,duration:3}),$("#list").setGridParam({postData:JSON.stringify(e.filter)}).trigger("reloadGrid")}})},refresh:function(){$("#list").setGridParam({postData:JSON.stringify(this.filter)}).trigger("reloadGrid")},getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(e);return null!=n?n[2]:""},quit:function(){window.parent.closeCurrentTab({openTime:this.openTime,exit:!0})},exporting:function(){$("#export_form")[0].submit()},print:function(){var t=this;if(console.log(t.lodoPList,"=========that.lodoPList"),t.lodoPList&&t.lodoPList.length){t.lodoPList.forEach(function(t){t.isTick=2===t.isTick?"√":""});var e={title:"已勾对记录列表",template:1,titleInfo:[{name:"银行",val:t.bank},{name:"银行账号",val:t.bankAccount},{name:"科目",val:t.subName},{name:"币别",val:t.curName},{name:"期间",val:1==t.filter.qr?t.filter.accountYear+"年"+t.filter.accountPeriod+"期":t.bdt+"至"+t.edt}],colNames:[{name:"记录",col:"record"},{name:"日期",col:"datetime"},{name:"凭证字号",col:"voucherGroupName"},{name:"摘要",col:"summary"},{name:"对方科目",col:"relativeSubjectName"},{name:"借方金额",col:"debitAmountFor"},{name:"贷方金额",col:"creditAmountFor"},{name:"制单人",col:"createName"},{name:"数据来源",col:"dataSource"}],styleCss:"",colMaxLenght:9,data:t.lodoPList,totalRow:!1};t.printInfo=e,t.printModalShow(!0)}else t.$Message.info({content:"无打印数据",duration:3})},printModalShow:function(t){this.printModal=t}},created:function(){this.filter.subjectId=Number(this.getQueryString("subjectId")),this.filter.currencyId=Number(this.getQueryString("currencyId")),this.filter.accountYear=Number(this.getQueryString("accountYear")),this.filter.accountPeriod=Number(this.getQueryString("accountPeriod")),this.filter.beginDatetime=this.getQueryString("beginDatetime"),this.filter.endDatetime=this.getQueryString("endDatetime"),this.filter.containTicked=this.getQueryString("containTicked"),this.filter.qr=Number(this.getQueryString("qr")),this.filter.sobId=Number(this.getQueryString("sobId")),this.bdt=this.filter.beginDatetime,this.edt=this.filter.endDatetime},mounted:function(){var e=this;this.getSubject(),this.subjectChange(),this.getBankAccount(),this.getYear(),this.getMonth(),this.getOrg();var t=e.subjectList.find(function(t){return t.accountId===e.filter.subjectId});t&&(e.subName=t.accountCode+" "+t.accountName,e.bank=t.accountName);var n=e.currencyList.find(function(t){return t.currencyId===e.filter.currencyId});n&&(e.curName=n.currencyName),this.pageInit(),this.openTime=window.parent.params&&window.parent.params.openTime}});