"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Vue.component("source-list",{props:{config:{type:Object,require:!1,default:function(){return!1}},code:{default:function(){return""}},showModal:{default:function(){return!1}}},data:function(){var o=this;return{responseRaw:[],selected:[],selectedRow:[],body:{hasCreateTestDocument:0,startTime:"",endTime:"",documentCode:"",date:""},coustomer:{custName:"",goodsTypeName:"",startTime:"",endTime:""},base_config:{multiboxonly:!1,multiselect:!0,colNames:["单据编号","单据日期","业务类型","商品类型"],colModel:[{name:"saleOrderNo",index:"currencyName asc, invdate",width:200,align:"center",sort:!1},{name:"orderDate",index:"currencyName asc, invdate",width:200,align:"center",sort:!1},{name:"businessType",index:"businessType",width:200,align:"center"},{name:"goodsTypeName",index:"goodsTypeName",width:200,align:"center"}],jsonReader:{root:"data.list",total:"data.totalPage",records:"data.totalCount",cell:"list"},prmNames:{page:"page",rows:"limit"},ajaxGridOptions:{complete:function(e,t){o.responseRaw=JSON.parse(e.responseText)}},mtype:"POST",contentType:"application/json",datatype:"json",styleUI:"Bootstrap",rownumbers:!0,pagination:!0,multiselectWidth:50,viewrecords:!0,rowNum:10,rowList:[10,30,50],pager:"#my_pager_id_source",url:contextPath+"/tsalecustorder/list/",postData:{status:4},onSelectAll:function(e,t){o.handlerData(e,t)},onSelectRow:function(e,t){o.handlerData(e,t)}}}},methods:{handlerData:function(e,t){var o=this;if("object"===(void 0===e?"undefined":_typeof(e))&&t&&(this.selected=e),"object"!==(void 0===e?"undefined":_typeof(e))||t||(this.selected=[]),"string"==typeof e)if(t)!(-1<this.selected.indexOf(e.toString()))&&this.selected.push(e.toString());else{var n=this.selected.indexOf(e.toString());-1<n&&this.selected.splice(n,1)}this.selectedRow=[],this.selected.map(function(t){o.responseRaw.data.list.map(function(e){t==e.id&&o.selectedRow.push(e)})})},modalOk:function(){this.isAllEqual(this.selectedRow)?this.$emit("sure",JSON.parse(JSON.stringify(this.selectedRow))):this.$Modal.error({content:"所选商品类型必须一致"})},isAllEqual:function(o){return!(0<o.length)||!o.some(function(e,t){return e.goodsType!==o[0].goodsType})},init:function(){jQuery("#my_table_id_source").jqGrid(this.base_config)},clear:function(){this.body={documentCode:"",date:"",startTime:"",endTime:""}},search:function(){var e=$("#my_table_id_source"),t={postData:Object.assign({documentType:this.code},this.body)};e.jqGrid("clearGridData"),e.jqGrid("setGridParam",t).trigger("reloadGrid")},modalCancel:function(){this.$emit("cancel")},changeDate:function(e){this.body.startTime=e[0].replace(/\//g,"-")+" 00:00:00",this.body.endTime=e[1].replace(/\//g,"-")+" 23:59:59"}},mounted:function(){this.init()},watch:{code:{handler:function(){this.search()}}},template:'<div>\n            <Modal\n            @on-ok="modalOk"\n            @on-cancel="modalCancel"\n        class-name="source-list"\n        v-model="showModal"\n        title="选择源单信息">\n        <div class="content clearfix">\n           <div style="width: 900px;border: 1px solid #ccc;">\n              <div>\n                  <i-form :model="body" style="display:inline-block; margin-top: 10px;" :label-width="120">\n                    <form-item label="客户名称">\n                        <i-input v-model="coustomer.custName"></i-input>\n                    </form-item>\n                    <form-item label="单据日期">\n                        \x3c!--<date-picker format="yyyy-MM-dd" v-model="body.date" :key="body.date" @on-change="body.date=$event"  type="datetime" placeholder="请选择时间" style="width: 200px"></date-picker>--\x3e\n                    <date-picker @on-change="changeDate" format="yyyy/MM/dd" v-model="body.date" type="daterange" placement="bottom-end" placeholder="Select date" style="width: 200px"></date-picker>\n                    </form-item>\n                     <i-button type="primary" style="margin-left: 120px" @click="search">查询</i-button>\n                  </i-form>\n\n                 \n            </div>\n            <div class="jqGrid_wrapper">\n                <table id="my_table_id_source"></table> \n                <div id="my_pager_id_source"></div>\n            </div>\n            </div>\n           <div slot="footer">\n                    <i-button type="text" size="large" @click="modalCancel">取消</i-button>\n                    <i-button type="primary" size="large" @click="modalOk">确定</i-button>\n                </div>\n        </div>\n    </Modal>\n</div>'});