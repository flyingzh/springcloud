"use strict";var _methods;function _defineProperty(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var vm=new Vue({el:"#customer-order-list",data:function(){var n=this;return{modalTrigger:!1,modalType:"",steplist:[],approvalTableData:[],outStockEntity:{status:"",outStockNo:""},tabId:"tabId2222",documentStatus:"status",documentNo:"outStockNo",isHideSearch:!0,isHideList:!0,selected:[],openTime:"",typeName:{query:"查看",update:"修改",save:"新增"},orderStatus:{temporaryStorage:1,unreviewed:2,revieweding:3,audited:4,turnDown:5},operationFlag:{yes:0,no:1},businessType:[],orderDate:[],params:{},reload:!1,jumpFlag:{query:"query",update:"update",add:"add"},body:{businessType:"",outStockNo:"",startTime:"",endTime:"",custName:""},businessStatusLabel:[{label:"待收定金",value:"10"}],saveReqList:[],data_config:{url:contextPath+"/tsaleoutstock/list",colNames:["日期","单据编号","单据状态","业务类型","客户","业务员","商品类型","备注","总数量","总重量","销售总金额","id","校验标识"],colModel:[{name:"createTime",index:"createTime",width:200,align:"left",sortable:!1,formatter:function(t,e,o,a){return new Date(t).format("yyyy-MM-dd")}},{name:"outStockNo",index:"outStockNo",width:250,align:"left",formatter:function(t,e,o,a){return $(document).off("click",".detail"+t).on("click",".detail"+t,function(){n.detailClick({value:t,grid:e,rows:o,state:a})}),'<a class="detail'+t+'">'+t+"</a>"}},{name:"status",index:"status",width:120,align:"left",sortable:!1,formatter:function(t,e,o,a){return 1==t?"暂存":2==t?"待审核":3==t?"审核中":4==t?"已审核":5==t?"驳回":""}},{name:"businessType",index:"goodsType",width:120,align:"left",sortable:!1,formatter:function(t,e,o,a){return"S_CUST_ORDER_02"==t?"受托加工销售":"S_CUST_ORDER_01"==t?"普通销售":""}},{name:"custName",index:"custName",width:120,align:"left",sortable:!1},{name:"saleMenName",index:"saleMenName",width:120,align:"left"},{name:"goodsTypeName",index:"goodsTypeName",width:120,sortable:!1,align:"left"},{name:"remark",index:"goodsName",width:200,sortable:!1,align:"left"},{name:"totalNum",index:"countingUnit",width:120,sortable:!1,align:"left"},{name:"totalWeight",index:"num",width:120,sortable:!1,align:"left"},{name:"totalActualAmount",index:"totalActualAmount",width:120,sortable:!1,align:"left"},{name:"id",hidden:!0},{name:"checkFlag",hidden:!0}],shrinkToFit:!1}}},methods:(_methods={detailClick:function(t){console.log("这是查询。。。"),console.log(t.value),console.log(t.rows),this.testJump(t.value,this.typeName.query)},changeDate:function(t){this.body.startTime=""==t[0]?"":t[0].replace(/\//g,"-")+" 00:00:00",this.body.endTime=""==t[1]?"":t[1].replace(/\//g,"-")+" 23:59:59"},search:function(){0<this.orderDate.length&&(this.body.startTime=this.orderDate[0]?this.orderDate[0].format("yyyy-MM-dd HH:mm:ss"):"",this.body.endTime=this.orderDate[1]?this.orderDate[1].format("yyyy-MM-dd HH:mm:ss"):""),console.log(this.body),this.reload=!this.reload},clear:function(){this.$refs.bType.reset(),this.$nextTick(function(){this.body.businessType=""}),this.body={businessType:"",outStockNo:"",startTime:"",endTime:"",custNo:""},this.orderDate=[]},exit:function(){window.parent.closeCurrentTab({exit:!0,openTime:this.openTime})},refresh:function(){console.log("这是刷新。。。"),this.reload=!this.reload,this.selected=[]},jump:function(t,e,o){console.log("跳转..."),console.log(t),console.log(e),window.parent.activeEvent({name:"销售出库单"+o,url:contextPath+"/sale/saleoutstock/saleoutstock-add.html",params:{type:e,data:t}})},testJump:function(t,e){console.log("跳转..."),window.parent.activeEvent({name:"销售出库单"+e,url:contextPath+"/sale/saleoutstock/saleoutstock-add.html",params:{type:"other",data:t}})},add:function(){console.log("这是新增。。。"),this.jump(this.operationFlag.no,this.jumpFlag.add,this.typeName.save)},checkStatus:function(){var t=!0;return 1!=this.selected[0].status?(this.$Modal.warning({content:"该订单处于非暂存状态，禁止操作该数据！"}),void(t=!1)):t},del:function(){console.log("这是删除。。。");var t=this,e=t.selected,o=[];e.forEach(function(t){o.push(t.id)}),console.log(o),this.$Modal.confirm({title:"系统提示",content:"<p>删除的摘要将不能恢复，请确认是否删除？</p>",okText:"确定",cancelText:"取消",onOk:function(){t.deleteOrder(o)}})},deleteOrder:function(t){var e=this;$.ajax({type:"POST",url:contextPath+"/tsaleoutstock/delete",data:JSON.stringify(t),contentType:"application/json",success:function(t){"100100"==t.code?setTimeout(function(){e.$Modal.info({content:t.data,onOk:function(){e.reload=!e.reload}})},300):e.$Modal.warning({content:t.msg})},error:function(t){e.$Modal.error({content:"系统出现异常,请联系管理人员"})}})}},_defineProperty(_methods,"exit",function(){window.parent.closeCurrentTab({exit:!0,openTime:this.openTime})}),_defineProperty(_methods,"checkSelect",function(){var t=!0;return 1!=this.selected.length?(this.$Modal.warning({content:"请选择一条记录！"}),void(t=!1)):t}),_defineProperty(_methods,"update",function(){console.log("这是修改。。。");var t=this.checkSelect(),e=this.checkStatus();t&&e&&this.inquire(this.selected[0].outStockNo,this.jumpFlag.update,this.selected[0].operationFlag,this.typeName.update)}),_defineProperty(_methods,"submit",function(){console.log("这是提交。。。");var t=this.checkSelect(),e=this.checkStatus();if(t&&e){if(1==this.selected[0].checkFlag)return void this.$Modal.warning({content:"请完善销售出库单据信息！"});var o=this;$.ajax({type:"POST",url:contextPath+"/tsaleoutstock/updateStatus",data:{outStockNo:o.selected[0].outStockNo,status:o.orderStatus.unreviewed},success:function(t){"100100"==t.code?(o.$Modal.success({content:t.msg}),o.refresh()):o.$Modal.warning({content:t.msg})},error:function(t){o.$Modal.error({content:"系统出现异常,请联系管理人员"})}})}}),_defineProperty(_methods,"transDocStatus",function(t){return"暂存"===t?1:"待审核"===t?2:"审核中"===t?3:"已审核"===t?4:5}),_defineProperty(_methods,"approval",function(){var t=this;if(this.checkSelect()){var e=$("#myTable").jqGrid("getRowData",this.selected[0].id);console.log(e);var o=e.outStockNo.split(">");e.outStockNo=o[1].split("<")[0],t.outStockEntity.outStockNo=e.outStockNo,t.outStockEntity.status=t.transDocStatus(e.status),t.modalType="approve",t.modalTrigger=!t.modalTrigger}}),_defineProperty(_methods,"reject",function(){var t=this;if(this.checkSelect()){var e=$("#myTable").jqGrid("getRowData",this.selected[0].id),o=e.outStockNo.split(">");e.outStockNo=o[1].split("<")[0],t.outStockEntity.outStockNo=e.outStockNo,t.outStockEntity.status=t.transDocStatus(e.status),t.modalType="reject",t.modalTrigger=!t.modalTrigger}}),_defineProperty(_methods,"approvalOrRejectCallBack",function(t){console.log(t);var e=this;"100515"==t.result.code&&("approve"==e.modalType&&e.ajaxUpdateDocStatusById(e.outStockEntity.outStockNo,4,"审核"),"reject"==e.modalType&&e.ajaxUpdateDocStatusById(e.outStockEntity.outStockNo,1,"驳回")),this.refresh()}),_defineProperty(_methods,"ajaxUpdateDocStatusById",function(t,e,o){var a=this;$.ajax({url:contextPath+"/tsaleoutstock/updateStatus",method:"POST",dataType:"json",data:{outStockNo:t,status:e},success:function(t){"100100"==t.code?(a.$Modal.success({content:o+"成功!",title:"提示"}),a.outStockEntity.status=e):a.$Modal.success({content:o+"失败!",title:"提示"})}})}),_defineProperty(_methods,"inquire",function(t,e,o,a){var n=this;console.log(o),console.log("这是查询。。。");var s={outStockNo:t,operationFlag:o};$.ajax({type:"POST",url:contextPath+"/tsaleoutstock/info",data:s,success:function(t){"100100"==t.code?n.jump(t.data,e,a):n.$Modal.warning({content:t.msg})},error:function(t){n.$Modal.error({content:"系统出现异常,请联系管理人员"})}})}),_methods),created:function(){},mounted:function(){this.openTime=window.parent.params.openTime}});