"use strict";var ve=new Vue({el:"#asset-class",data:function(){return{tid:"zTreeAssetStorageLocation",treeUrl:"",isDisabled:!0,formData:{id:"",code:"",name:"",sobId:"",editable:"1",remark:"",pid:""},initForm:{id:"",code:"",name:"",sobId:"",editable:"1",remark:"",pid:""},organizationList:[],nodes:[],setting:{callback:{onClick:this.clickEvent}},curEntity:{},selected:"",openTime:"",treeSetting:{callback:{onClick:this.treeClickCallBack,beforeClick:this.treeBeforeClick}}}},methods:{initTree:function(){var a=this;$.ajax({type:"post",url:contextPath+"/falocation/initTree",data:null,success:function(e){if("100100"==e.code){var t=e.data;a.nodes=t}else layer.alert(e.msg)}})},clickEvent:function(e,t,a){var i=this;i.selected=a.id,$.ajax({type:"post",url:contextPath+"/falocation/info",data:{id:i.selected},success:function(e){console.log(e),"100100"==e.code?(i.curEntity=e.data,i.formData.code=e.data.code,i.formData.name=e.data.name,i.formData.id=e.data.id,i.isDisabled=!0):layer.alert(e.msg)}})},initPage:function(){var t=this;$.ajax({type:"post",url:contextPath+"/falocation/initPage",data:null,success:function(e){"100100"==e.code?(t.organizationList=e.data.org,t.formData.sobId=e.data.org[0].value,t.initForm.sobId=e.data.org[0].value,t.curEntity={},t.selected="",t.isDisabled=!0,t.initTree()):layer.alert("页面初始化失败")}})},modify:function(e){var t=this;if("add"==e)$.extend(!0,t.formData,t.initForm),$.isEmptyObject(t.curEntity)||(t.formData.code=t.curEntity.code+"."),t.curEntity={},t.isDisabled=!1;else if("edit"==e){if($.isEmptyObject(t.curEntity))return void t.$Modal.warning({title:"提示",content:"请选选择要修改的存放地点"});t.isDisabled=!1,$.extend(!0,t.formData,t.curEntity),t.curEntity={}}},saveFun:function(){var t=this,e=t.formData;null!=e.code&&""!=e.code?null!=e.name&&""!=e.name?t.codeCheck(e.code)?$.ajax({type:"post",url:contextPath+"/falocation/saveOrUpdate",data:JSON.stringify(t.formData),contentType:"application/json;charset=utf-8",dataType:"json",success:function(e){console.log(e),"100100"==e.code?(t.$Modal.success({title:"提示",content:"操作成功"}),t.refreshLocation()):t.$Modal.error({title:"提示",content:"操作失败："+e.msg})}}):t.$Message.error("编码只能由[0-9]的数字和小数点组成"):t.$Message.error("名称不能为空"):t.$Message.error("编码不能为空")},codeCheck:function(e){var t=e.replace(/\./g,".");return!isNaN(t)},delFun:function(){var t=this;null!=t.selected&&""!=t.selected?$.ajax({type:"post",url:contextPath+"/falocation/delete",data:{id:t.selected},success:function(e){console.log(e),"100100"==e.code?(t.$Modal.success({title:"提示",content:"删除成功"}),t.refreshLocation()):t.$Modal.error({title:"提示",content:"删除失败："+e.msg})}}):t.$Message.error("请选择要删除的存放地点")},cancelFun:function(){window.parent.closeCurrentTab({name:"基础资料-存放地点",openTime:this.openTime,exit:!0})},refreshLocation:function(){this.initPage()}},mounted:function(){this.initPage(),this.openTime=window.parent.params&&window.parent.params.openTime}});