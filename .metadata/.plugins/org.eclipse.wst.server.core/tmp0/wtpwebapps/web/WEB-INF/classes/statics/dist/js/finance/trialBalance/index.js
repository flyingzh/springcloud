"use strict";new Vue({el:"#trial-balance",data:function(){return{openTime:"",formData:{accountYear:"",accountPeriod:"",treeHeight:"1",currencyId:"-1",showSubjectDetail:"",showProjectDetail:"",includeVoucher:"",accountantTime:"",currencyName:"",decimalDigits:2,message:""},isFilterVisible:!1,subjectList1:[],subjectList2:[],subjectList4:[],base_config:{ExpandColumn:"username",scroll:"true",styleUI:"Bootstrap",url:contextPath+"/financeBalance/queryBalanceList",ajaxGridOptions:{contentType:"application/json;charset=utf-8"},datatype:"json",postData:this.formData,jsonReader:{root:"data.list",cell:"data.list",userdata:"data.userData",repeatitems:!1},treeReader:{level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded"},viewrecords:!0,rowNum:999,height:$(window).height()-200,mtype:"POST"},colNames:[],colModel:[],colunm_comfig:[{startColumnName:"beginBalance",numberOfColumns:2,titleText:"期初余额"},{startColumnName:"debit",numberOfColumns:2,titleText:"本期发生额"},{startColumnName:"endBalance",numberOfColumns:2,titleText:"期末余额"}],colunm_comfig1:[{startColumnName:"beginBalanceFor",numberOfColumns:2,titleText:"期初余额"},{startColumnName:"debitFor",numberOfColumns:2,titleText:"本期发生额"},{startColumnName:"endBalanceFor",numberOfColumns:2,titleText:"期末余额"}]}},methods:{initMethod:function(){var i=this;this.delTable(),this.colNames1=["科目编码","科目名称","借方","贷方","借方","贷方","借方","贷方"],this.colModel=[{name:"accountCode",index:"accountCode",width:110,sortable:!1},{name:"accountName",index:"accountName",width:200,sortable:!1},{name:"beginBalance",index:"beginBalance",width:80,formatter:function(e,t,a,n){return"合计"===a.accountName?null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,","):2===a.direction?(a.beginBalance1=e,e=""):null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}},{name:"beginBalance1",index:"beginBalance1",width:80,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}},{name:"debit",index:"debit",width:80,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}},{name:"credit",index:"credit",width:80,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}},{name:"endBalance",index:"endBalance",width:80,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}},{name:"endBalance1",index:"endBalance1",width:80,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}}],this.jqGridInit(this.colNames1,this.colModel,this.colunm_comfig,i)},outHtml:function(){window.parent.closeCurrentTab({name:name,openTime:this.openTime,exit:!0})},renovate:function(){this.save()},initMethod1:function(){var i=this;this.delTable(),this.colNames1=["科目编码","科目名称","借方","贷方","借方","贷方","借方","贷方"],this.colModel=[{name:"accountCode",index:"accountCode",width:110,sortable:!1},{name:"accountName",index:"accountName",width:200,sortable:!1},{name:"beginBalanceFor",index:"beginBalanceFor",width:80,formatter:function(e,t,a,n){return"合计"===a.accountName?null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,","):2===a.direction?(a.beginBalanceFor1=e,e=""):null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}},{name:"beginBalanceFor1",index:"beginBalanceFor1",width:80,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}},{name:"debitFor",index:"debitFor",width:80,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}},{name:"creditFor",index:"creditFor",width:80,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}},{name:"endBalanceFor",index:"endBalanceFor",width:80,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}},{name:"endBalanceFor1",index:"endBalanceFor1",width:80,formatter:function(e,t,a,n){return null==e||0==e?"":accounting.formatNumber(e,i.formData.decimalDigits,",")}}],this.jqGridInit(this.colNames1,this.colModel,this.colunm_comfig1,i)},showDetailMethod:function(){this.delTable(),this.colNames1=["科目编码","科目名称","核算维度编码","核算维度名称","借方","贷方","借方","贷方","借方","贷方","借方","贷方"],this.colModel=[{name:"accountCode",index:"accountCode",width:110,sortable:!1},{name:"accountName",index:"accountName",width:80,sortable:!1},{name:"dimensionCode",index:"age",width:120},{name:"dimensionName",index:"age",width:120},{name:"debit1",index:"age",width:80},{name:"credit1",index:"address",width:80},{name:"debit2",index:"age",width:80},{name:"credit2",index:"address",width:80},{name:"debit3",index:"age",width:80},{name:"credit3",index:"address",width:80},{name:"debit4",index:"age",width:80},{name:"credit4",index:"address",width:80}],this.jqGridInit(this.colNames1,this.colModel,this.colunm_comfig,this)},delTable:function(){$("#my_report").empty();var e=$(".jqGrid_wrapper");e.empty(),$("<table id='my_report'></table>").appendTo(e),$("<div id='my_pager'></div>").appendTo(e)},jqGridInit:function(e,t,a,n){var i=Object.assign({},this.base_config,{colNames:e,colModel:t,postData:JSON.stringify(this.formData),pager:"#my_pager",width:"99%",autowidth:!0,gridComplete:function(){jQuery("#my_report").jqGrid("destroyGroupHeader"),jQuery("#my_report").jqGrid("setGroupHeaders",{useColSpanStyle:!0,groupHeaders:a})},loadComplete:function(e){console.log(e),jQuery("#my_report").getGridParam("userData");var t=jQuery("#my_report").jqGrid("getGridParam","userData");n.$set(n.formData,"accountantTime",t.accountantTime),n.$set(n.formData,"currencyName",t.currencyName),n.$set(n.formData,"decimalDigits",t.decimalDigits),n.$set(n.formData,"message",t.message),window.top.home.loading("hide")}});jQuery("#my_report").jqGrid(i)},save:function(){this.base_config.url=contextPath+"/financeBalance/queryBalanceList",this.base_config.postData=JSON.stringify(this.formData),"-1"==this.formData.currencyId?this.initMethod():this.initMethod1(),this.cancel()},refresh:function(){this.delTable(),window.top.home.loading("show"),this.save()},cancel:function(){this.$refs.filter.visible=!1,this.isFilterVisible=!1},more:function(e){if("Derivation"===e){console.log("引出,导出到excel表...");var t="";for(var a in this.formData)t+=a+"="+this.formData[a]+"&";t=t.slice(0,t.length-1),window.open(contextPath+"/financeBalance/exporttrialBalance?"+t)}},currencyShow:function(){var i=this;$.ajax({type:"post",async:!1,data:"",url:contextPath+"/balance/currencyList",dataType:"json",success:function(e){for(var t=e.data,a=[],n=0;n<t.length;n++)a.push({name:t[n].label,value:t[n].value}),-1==t[n].value&&(i.formData.currencyId=t[n].value);console.log(i.formData.currencyId);JSON.stringify(a);i.subjectList4=a},error:function(e){console.log(e)}});var e=contextPath+"/systemProfileController/queryByType?type=系统信息&sobId=1";$.ajax({type:"POST",async:!1,url:e,success:function(e){for(var t=e.data,a=0;a<t.length;a++)"sysAmountDecimal"==t[a].name&&(i.formData.decimalDigits=t[a].value,null!=i.formData.decimalDigits&&""!=i.formData.decimalDigits||(i.formData.decimalDigits=2))}})},accountShow:function(){var r=this;$.ajax({type:"post",async:!1,data:"",url:contextPath+"/financeBalance/getAccountYearAndPeriod",dataType:"json",success:function(e){for(var t=e.data,a=[],n=0;n<t.length;n++)a.push({name:t[n].accountYear,value:t[n].accountYear});console.log(t[0].accountYear),r.formData.accountYear=t[0].accountYear;JSON.stringify(a);r.subjectList1=a;for(var i=[],o=0;o<t.length;o++)i.push({name:t[o].accountPeriod,value:t[o].accountPeriod});console.log(t[0].accountPeriod),r.formData.accountPeriod=t[0].accountPeriod;JSON.stringify(i);r.subjectList2=i},error:function(e){console.log(e)}})}},computed:{showDetail:function(){return!!this.formData.for6},treeDisabled:function(){return!!this.formData.showSubjectDetail}},mounted:function(){var e=this;e.base_config.postData=JSON.stringify(e.formData),e.currencyShow(),e.accountShow(),window.top.home.loading("show"),e.initMethod(),e.openTime=window.parent.params&&window.parent.params.openTime}});