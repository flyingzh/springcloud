"use strict";function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function getQueryString(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),r=window.location.search.substr(1).match(e);return null!=r?unescape(r[2]):null}Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[r]:("00"+e[r]).substr((""+e[r]).length)));return t};var inventory=new Vue({el:"#imcomingReportList",data:function(){var t;return _defineProperty(t={openTime:"",approveComment:!1,rejectComment:!1,approvement:{receiptsId:"",approvalResult:1,approvalInfo:""},rejectement:{receiptsId:"",approvalResult:"0",approvalInfo:""},isLook:!0,isEdit:!1,reload:!1,selected:[],selectRowData:[],showHighSearch:!1,otherSearch:[],documentTypeArr:[],selectDateArr:[],documentStatusArr:[],businessTypeArr:[],sourceDocumentTypeArr:[],testResultArr:[],categoryType:[],inspectors:[],body:{documentType:"",documentCode:"",documentTimeStart:"",documentTimeEnd:"",businessType:"",documentStatus:"",sourceDocumentCode:"",inspectorId:"",productTypeId:""}},"selectRowData",[]),_defineProperty(t,"commodityCategoty",[]),_defineProperty(t,"tableName",""),_defineProperty(t,"data_config",{shrinkToFit:!1,url:contextPath+"/testDocument/list",colNames:["id","单据编号","源单单号","单据日期","单据类型","单据状态","质检员","源单类型","送检编号","质检完成时间","商品类型","检验总数量","合格数","不合格数","合格率","检验结果"],colModel:[{name:"id",width:80,align:"center",hidden:!0},{name:"documentCode",index:"id",width:200,align:"left",formatter:function(t,e,r,n){return $(document).off("click",".detail"+t).on("click",".detail"+t,function(){inventory.documentCodeClick(r.documentCode,r.upstreamSourceCode)}),'<a class="detail'+t+'">'+t+"</a>"},unformat:function(t,e,r){return t.replace(/(<\/?a.*?>)/g,"")}},{name:"upstreamSourceCode",width:200,align:"left"},{name:"documentTime",width:150,align:"center",formatter:function(t,e,r,n){return t?new Date(t).format("yyyy-MM-dd"):""}},{name:"documentType",width:150,align:"left",formatter:function(t,e,r,n){return inventory.formatterDocumentType(t)},unformat:function(t,e,r){return inventory.unformatDocumentType(t)}},{name:"documentStatus",width:150,align:"left",formatter:function(t,e,r,n){return inventory.formatterDocumentStatus(t)},unformat:function(t,e,r){return inventory.unformatDocumentStatus(t)}},{name:"inspectorName",width:100,sortable:!1,align:"left"},{name:"sourceDocumentType",width:150,align:"left",formatter:function(t,e,r,n){return inventory.formatterSourceDocumentType(t)},unformat:function(t,e,r){return inventory.unformatSourceDocumentType(t)}},{name:"sourceDocumentCode",width:200,align:"left"},{name:"testFinishTime",width:150,sortable:!1,align:"center",formatter:function(t,e,r,n){return t?new Date(t).format("yyyy-MM-dd hh:mm:ss"):""}},{name:"productTypeName",width:150,sortable:!1,align:"left"},{name:"testTotalAmount",width:150,sortable:!1,align:"right"},{name:"qualifiedTotalAmount",width:150,sortable:!1,align:"right"},{name:"unqualifiedTotalAmount",width:150,sortable:!1,align:"right"},{name:"qualifiedPercent",width:150,sortable:!1,align:"right",formatter:function(t,e,r,n){return t?t<=1?(Math.round(1e4*t)/100).toFixed(2)+"%":1<t?t.toFixed(2)+"%":void 0:""},unformat:function(t,e,r){return t?-1!=t.indexOf("%")?parseFloat(t.replace(/\%/g,""))/1e3*100:void 0:null}},{name:"testResult",width:150,sortable:!1,align:"left",formatter:function(t,e,r,n){return inventory.formatterTestResult(t)},unformat:function(t,e,r){return inventory.unformatTestResult(value)}}]}),_defineProperty(t,"isSearchHide",!0),_defineProperty(t,"isTabulationHide",!0),_defineProperty(t,"isHide",!0),_defineProperty(t,"receiptsId",""),_defineProperty(t,"documentStatus",""),_defineProperty(t,"testDocumentId",""),_defineProperty(t,"steplist",[]),_defineProperty(t,"stepData",[{currentLevel:1,subtitle:"一级审批"},{currentLevel:2,subtitle:"二级审批"},{currentLevel:3,subtitle:"三级审批"},{currentLevel:4,subtitle:"四级审批"},{currentLevel:5,subtitle:"五级审批"},{currentLevel:6,subtitle:"六级审批"},{currentLevel:7,subtitle:"结束"}]),_defineProperty(t,"currentStep",""),_defineProperty(t,"nextStep",""),t},created:function(){var t=getQueryString("documentType");this.fetchDocumentType(),this.body.documentType=t},methods:{hideSearchOrShowTable:function(){!0!==this.isSearchHide?!1!==this.isTabulationHide||(this.isTabulationHide=!0):this.isSearchHide=!1},hideSearch:function(){this.isHide=!this.isHide,this.isSearchHide=!this.isSearchHide,$(".chevron").css("top","")},hidTabulation:function(){this.isHide=!this.isHide,this.isTabulationHide=!this.isTabulationHide,this.isTabulationHide?$(".chevron").css("top",""):$(".chevron").css("top","84%")},search:function(){0<this.selectDateArr.length&&this.selectDateArr[0]&&this.selectDateArr[1]?(this.body.documentTimeStart=this.selectDateArr[0].format("yyyy-MM-dd"),this.body.documentTimeEnd=this.selectDateArr[1].format("yyyy-MM-dd")):(this.body.documentTimeStart="",this.body.documentTimeEnd=""),0<this.commodityCategoty.length?this.body.productTypeId=this.commodityCategoty[this.commodityCategoty.length-1]:this.body.productTypeId="",this.reload=!this.reload},clear:function(){var t=this;this.body.inspectorId&&(this.$refs.inspSel.reset(),this.$nextTick(function(){t.body.inspectorId=""})),this.body.upstreamSourceCode="",this.body.documentCode="",this.body.documentTimeStart="",this.body.documentTimeEnd="",this.body.businessType="",this.body.documentStatus="",this.body.sourceDocumentCode="",this.body.productTypeId="",this.commodityCategoty=[],this.selectDateArr=[],this.reload=!this.reload},highSearch:function(){this.showHighSearch=!this.showHighSearch},addSearch:function(){this.otherSearch.push({name:"",include:"",key:""})},deleteSearch:function(t){this.otherSearch.splice(t,1)},refresh:function(){},showList:function(){},addAttachment:function(){},getApproveInfo:function(){var e=this;e.approvement.receiptsId=e.receiptsId,$.ajax({type:"POST",url:contextPath+"/testDocument/submitapproval",contentType:"application/json",data:JSON.stringify(e.approvement),dataType:"json",success:function(t){"100100"===t.code?(layer.alert("审核成功"),0==t.data.approvalStatus&&(e.documentStatus="checking"),1==t.data.approvalStatus&&(e.documentStatus="auditing"),-2==t.data.approvalStatus&&(e.documentStatus="temporary_save"),e._ajaxUpdateDocumentStatus(e.testDocumentId,e.documentStatus),e.approvement={receiptsId:"",approvalResult:1,approvalInfo:""},e.reload=!e.reload,e.initApproval()):layer.alert("审核失败")},error:function(t){layer.alert("服务器出错")}})},submit:function(){var e=this,t=e.getSelectRowData();if(t.length<1)return layer.alert("请先选择一条数据!"),!1;if(1<t.length)return layer.alert("只能选择一条数据!"),!1;var r=t[0];if("auditing"==r.documentStatus||"await_check"==r.documentStatus||"checking"==r.documentStatus)return layer.alert("当前单据状态不可提交!"),!1;$.ajax({url:contextPath+"/testDocument/submit",method:"post",dataType:"json",data:{testDocumentId:r.id},success:function(t){"100100"===t.code?(layer.alert("提交成功!"),e.reload=!e.reload):layer.alert(t.msg)},error:function(t){console.log(t)}})},genSpecialRelease:function(){var t=this.getSelectRowData();if(t.length<1)return layer.alert("请先选择一条数据!"),!1;if(1<t.length)return layer.alert("只能选择一条数据!"),!1;var e=t[0];console.log("row:",e);var r=e.documentStatus,n=e.id;"auditing"===r?$.ajax({type:"POST",url:contextPath+"/testDocument/isSpecialOrComfirm",data:{testDocumentId:n,type:"spercial"},dataType:"json",success:function(t){"specialAcross"===t.data?window.parent.activeEvent({name:"生成特别放行单",url:contextPath+"/quality/quality/specialReleaseDocumentInfo.html?type=1&code="+e.sourceDocumentCode}):layer.alert(t.data)},error:function(t){layer.alert(res.data)}}):layer.alert("检验单未审核，请审核!")},confirmResult:function(){var t=this.getSelectRowData();if(t.length<1)return layer.alert("请先选择一条数据!"),!1;if(1<t.length)return layer.alert("只能选择一条数据!"),!1;var e=t[0];console.log("row:",e);var r=e.documentStatus,n=e.id;"auditing"===r?$.ajax({type:"POST",url:contextPath+"/testDocument/isSpecialOrComfirm",data:{testDocumentId:n,type:"comfirm"},dataType:"json",success:function(t){"comfirmAcross"===t.data?layer.alert("已确认检验结果"):layer.alert(t.data)},error:function(t){layer.alert(res.data)}}):layer.alert("检验单未审核，请审核!")},getSelectRowData:function(){var t=[],e=!0,r=!1,n=void 0;try{for(var a,o=this.selected[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var u=a.value,i=$("#jydList").jqGrid("getRowData",u);t.push(i)}}catch(t){r=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(r)throw n}}return t},genReportPaper:function(){var t=this.getSelectRowData();if(t.length<1)return layer.alert("请先选择一条数据!"),!1;if(1<t.length)return layer.alert("只能选择一条数据!"),!1;var e=t[0];if("auditing"!==e.documentStatus)return layer.alert("选中的所处状态不允许生成报告单!"),!1;window.parent.activeEvent({name:"生成报告单",url:contextPath+"/quality/quality/inspection-report.html",params:{testDocumentId:e.id,code:e.documentCode}})},upperSearch:function(){var t=this.getSelectRowData();if(t.length<1)return layer.alert("请先选择一条数据!"),!1;if(1<t.length)return layer.alert("只能选择一条数据!"),!1;t[0]},addNew:function(){"lljyd"==this.body.documentType?window.parent.activeEvent({name:"新增来料检验单",url:contextPath+"/quality/test-document/test-document-add.html",params:{ger:"ll"}}):"tbjyd"==this.body.documentType?window.parent.activeEvent({name:"新增调拨检验单",url:contextPath+"/quality/test-document/test-document-add.html",params:{ger:"db"}}):"fhjyd"==this.body.documentType&&window.parent.activeEvent({name:"新增发货检验单",url:contextPath+"/quality/test-document/test-document-add.html",params:{ger:"fh"}})},update:function(){var t=this.getSelectRowData();if(t.length<1)return layer.alert("请先选择一条数据!"),!1;if(1<t.length)return layer.alert("只能选择一条数据!"),!1;var e=t[0].id;console.log("rowDatas:=====",t[0]),"lljyd"==this.body.documentType?window.parent.activeEvent({name:"修改来料检验单",url:contextPath+"/quality/test-document/test-document-add.html",params:{code:e,type:"update",ger:"ll"}}):"tbjyd"==this.body.documentType?window.parent.activeEvent({name:"修改调拨检验单",url:contextPath+"/quality/test-document/test-document-add.html",params:{code:e,type:"update",ger:"db"}}):"fhjyd"==this.body.documentType&&window.parent.activeEvent({name:"修改发货检验单",url:contextPath+"/quality/test-document/test-document-add.html",params:{code:e,type:"update",ger:"fh"}})},documentCodeClick:function(t,e){window.parent.activeEvent({name:"查看检验单",url:contextPath+"/quality/test-document/test-document.html",params:{code:t,scode:e,type:1}})},approval:function(){var r=this,t=r.getSelectRowData();if(t.length<1)return layer.alert("请先选择一条数据!"),!1;if(1<t.length)return layer.alert("只能选择一条数据!"),!1;var e=[];console.log(t);var n=!0,a=!1,o=void 0;try{for(var u,i=t[Symbol.iterator]();!(n=(u=i.next()).done);n=!0){var s=u.value;"await_check"!=s.documentStatus&&"checking"!=s.documentStatus&&"reject"!=s.documentStatus&&e.push(s.documentCode)}}catch(t){a=!0,o=t}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}if(0<e.length)return layer.alert("编号为"+e.join(",")+"的单据，当前状态不可以审核!"),!1;if(""===t[0].documentCode||"temporary_save"===t[0].documentStatus)return layer.alert("请提交检验单!"),!1;var c=t[0].id,d=t[0].documentStatus;r.testDocumentId=c,r.receiptsId=t[0].documentCode,r.documentStatus=t[0].documentStatus,$.ajax({type:"POST",url:contextPath+"/testDocument/findUserOperation",contentType:"application/json",data:JSON.stringify({receiptsId:t[0].documentCode,docTypeCode:t[0].documentType+"_code"}),dataType:"json",success:function(t){if("100515"===t.code&&(layer.alert("审核成功"),r._ajaxUpdateDocumentStatus(c,"auditing")),"100514"===t.code){var e=1===t.data?"【一级审核】":2===t.data?"【二级审核】":3===t.data?"【三级审核】":4===t.data?"【四级审核】":5===t.data?"【五级审核】":6===t.data?"【六级审核】":t.msg;layer.alert(0===t.data?"该单据已被驳回到申请人，待申请人提交!":"您没有"+e+"的审核权限")}if("100100"===t.code){if("auditing"===d)return layer.alert("检验单已审核"),!1;r.initApproval(),r.approveComment=!0}},error:function(t){layer.alert("服务器出错")}})},reject:function(){var r=this,t=r.getSelectRowData();if(t.length<1)return layer.alert("请先选择一条数据!"),!1;if(1<t.length)return layer.alert("只能选择一条数据!"),!1;var e=[],n=!0,a=!1,o=void 0;try{for(var u,i=t[Symbol.iterator]();!(n=(u=i.next()).done);n=!0){var s=u.value;"temporary_save"!=s.documentStatus&&""!==t[0].documentStatus&&"auditing"!==s.documentStatus||e.push(s.documentCode)}}catch(t){a=!0,o=t}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}if(0<e.length)return layer.alert("编号为"+e.join(",")+"的单据，当前状态不可以驳回!"),!1;if(""===t[0].documentStatus||"temporary_save"===t[0].documentStatus)return layer.alert("请提交检验单!"),!1;var c=t[0].id;t[0].documentStatus;r.testDocumentId=c,r.receiptsId=t[0].documentCode;var d=t[0].documentCode;if(r.documentStatus=t[0].documentStatus,"temporary_save"===t[0].documentCode)return layer.alert("请提交检验单!"),!1;$.ajax({type:"POST",url:contextPath+"/testDocument/isReject",data:{testDocumentId:c,testDocumentCode:d},dataType:"json",success:function(t){"100100"===t.code&&(t.data?$.ajax({type:"POST",url:contextPath+"/testDocument/findUserOperation",contentType:"application/json",data:JSON.stringify({receiptsId:r.receiptsId,docTypeCode:"jyd"}),dataType:"json",success:function(t){if("100100"===t.code&&(r.rejectComment=!0),"100514"===t.code){var e=1===t.data?"【一级审核】":2===t.data?"【二级审核】":3===t.data?"【三级审核】":4===t.data?"【四级审核】":5===t.data?"【五级审核】":6===t.data?"【六级审核】":t.msg;layer.alert(0===t.data?"该单据已被驳回到申请人，待申请人提交!":"您没有"+e+"的驳回权限")}"100515"===t.code&&(layer.alert("驳回成功"),r.documentStatus="reject",r._ajaxUpdateDocumentStatus(r.testDocumentId,r.documentStatus),r.reload=!r.reload)},error:function(t){layer.alert("服务器出错")}}):layer.alert("该检验单有生成子单，请勿驳回"))},error:function(t){layer.alert("服务器出错")}})},getRejectInfo:function(){var e=this;e.rejectement.receiptsId=e.receiptsId,$.ajax({type:"POST",url:contextPath+"/testDocument/submitapproval",contentType:"application/json",data:JSON.stringify(e.rejectement),dataType:"json",success:function(t){"100100"===t.code?(layer.alert("驳回成功"),e.documentStatus="reject",-2==t.data.approvalStatus&&(e.documentStatus="temporary_save"),e._ajaxUpdateDocumentStatus(e.testDocumentId,e.documentStatus)):layer.alert("驳回失败"),e.rejectement={receiptsId:"",approvalResult:"0",approvalInfo:""},e.reload=!this.reload,e.initApproval()},error:function(t){layer.alert("服务器出错")}})},initApproval:function(){var u=this;$.ajax({type:"post",url:contextPath+"/testDocument/queryProcessByReceiptsId",data:{receiptsId:u.receiptsId},dataType:"json",success:function(t){for(var e=t.data.list,r=0;r<e.length;r++)switch(e[r].processLevel){case 1:e[r].processLevel="一级审核";break;case 2:e[r].processLevel="二级审核";break;case 3:e[r].processLevel="三级审核";break;case 4:e[r].processLevel="四级审核";break;case 5:e[r].processLevel="五级审核";break;case 6:e[r].processLevel="六级审核"}if(e.unshift({processLevel:"开始"}),e.push({processLevel:"结束"}),e[1].currentLevel===t.data.levelLength)for(var n=0;n<e.length;n++)e[n].currentLevel=e.length-1;for(var a=(u.steplist=e)[1].currentLevel,o=0;o<u.stepData.length;o++){if(a===u.stepData[o].currentLevel){u.currentStep=u.stepData[o+1].subtitle,u.nextStep=u.stepData[o+2].subtitle,u.stepData[o+1].currentLevel===e.length-2&&(u.nextStep=u.stepData[u.stepData.length-1].subtitle);break}a+1===u.stepData[o].currentLevel&&(u.currentStep=u.stepData[o].subtitle,u.nextStep=u.stepData[o+1].subtitle)}console.log(u.currentStep,u.nextStep)},error:function(){alert("服务器出错啦")}})},DeleteOneRow:function(){var r=this;console.log(r.selected);var t=r.getSelectRowData();if(t.length<1)return layer.alert("请先选择一条数据!"),!1;var n=[],e=!0,a=!1,o=void 0;try{for(var u,i=t[Symbol.iterator]();!(e=(u=i.next()).done);e=!0){var s=u.value;n.push({id:s.id,documentStatus:s.documentStatus,documentCode:s.documentCode})}}catch(t){a=!0,o=t}finally{try{!e&&i.return&&i.return()}finally{if(a)throw o}}layer.confirm("确认删除吗?",{btn:["确定","取消"]},function(t,e){$.ajax({url:contextPath+"/testDocument/delete",method:"post",dataType:"json",data:JSON.stringify(n),contentType:"application/json;charset=utf-8",success:function(t){if("100100"===t.code){layer.closeAll("dialog");var e=t.data;-1!=e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"<br/>")),layer.alert(e),r.reload=!r.reload}else layer.alert(t.msg)},error:function(t){console.log(t)}})})},_ajaxUpdateDocumentStatus:function(t,e){if(!t||!e)return!1;$.ajax({type:"POST",url:contextPath+"/testDocument/updateByTestDocumentIdAndStatus",dataType:"json",async:!1,data:{testDocumentId:t,documentStatus:e},success:function(t){},error:function(t){_this.$Spin.hide(),console.log("服务器出错")}})},fetchDocumentType:function(){var i=this;$.ajax({type:"POST",url:contextPath+"/codeController/getChildNodesByMark",dataType:"json",async:!1,data:{mark:"zj_jzyfdydlx"},success:function(t){if(console.log(t),i.documentTypeArr=[],"100100"===t.code&&0<t.data.length){var e=!0,r=!1,n=void 0;try{for(var a,o=t.data[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var u=a.value;i.documentTypeArr.push({name:u.name,value:u.value})}}catch(t){r=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(r)throw n}}}},error:function(t){i.$Spin.hide(),console.log("服务器出错")}})},formatterDocumentType:function(t){return t?this.documentTypeArr.length<1?t:this.documentTypeArr[this.documentTypeArr.map(function(t){return t.value}).indexOf(t)]?this.documentTypeArr[this.documentTypeArr.map(function(t){return t.value}).indexOf(t)].name:t:""},unformatDocumentType:function(t){return t?this.documentTypeArr.length<1?t:this.documentTypeArr[this.documentTypeArr.map(function(t){return t.name}).indexOf(t)]?this.documentTypeArr[this.documentTypeArr.map(function(t){return t.name}).indexOf(t)].value:t:""},fetchDocumentStatus:function(){var e=this,t=getCodeList("zj_document_status");e.documentStatusArr=[],t.forEach(function(t){e.documentStatusArr.push({name:t.name,value:t.value})})},formatterDocumentStatus:function(t){return t?this.documentStatusArr.length<1?t:this.documentStatusArr[this.documentStatusArr.map(function(t){return t.value}).indexOf(t)]?this.documentStatusArr[this.documentStatusArr.map(function(t){return t.value}).indexOf(t)].name:t:""},unformatDocumentStatus:function(t){return t?this.documentStatusArr.length<1?t:this.documentStatusArr[this.documentStatusArr.map(function(t){return t.name}).indexOf(t)]?this.documentStatusArr[this.documentStatusArr.map(function(t){return t.name}).indexOf(t)].value:t:""},fetchBusinessType:function(){var t=getCodeList("root_zj_jydywlx");switch(getQueryString("documentType")){case"lljyd":this.businessTypeArr=t.filter(function(t){return"xsjy"!==t.value&&"yllyjy"!==t.value});break;case"fhjyd":this.businessTypeArr=t.filter(function(t){return"xsjy"===t.value});break;case"tbjyd":this.businessTypeArr=t.filter(function(t){return"xsjy"===t.value||"yllyjy"===t.value});break;default:this.businessTypeArr=t}},fetchSourceDocumentType:function(){var e=this,t=getCodeList("root_zj_jydydlx");e.sourceDocumentTypeArr=[],t.forEach(function(t){e.sourceDocumentTypeArr.push({name:t.name,value:t.value})})},formatterSourceDocumentType:function(t){return t?this.sourceDocumentTypeArr.length<1?t:this.sourceDocumentTypeArr[this.sourceDocumentTypeArr.map(function(t){return t.value}).indexOf(t)]?this.sourceDocumentTypeArr[this.sourceDocumentTypeArr.map(function(t){return t.value}).indexOf(t)].name:t:""},unformatSourceDocumentType:function(t){return t?this.sourceDocumentTypeArr.length<1?t:this.sourceDocumentTypeArr[this.sourceDocumentTypeArr.map(function(t){return t.name}).indexOf(t)]?this.sourceDocumentTypeArr[this.sourceDocumentTypeArr.map(function(t){return t.name}).indexOf(t)].value:t:""},loadProductType:function(){var e=this;$.ajax({type:"post",url:contextPath+"/documentController/getCategory?parentId=0",dataType:"json",success:function(t){console.log(t),e.categoryType=e.initGoodCategory(t.data.cateLists)},error:function(){alert("服务器出错啦")}})},initGoodCategory:function(t){var a=this,o=[];return t.forEach(function(t){var e=t.id,r=t.name,n=t.cateLists;n&&(n=a.initGoodCategory(n)),o.push({value:e,label:r,children:n})}),o.forEach(function(t){t.children||delete t.children}),o},fetchInspectors:function(){var i=this;$.ajax({type:"POST",url:contextPath+"/testDocument/getCurrentUserOrgEmployees",contentType:"application/json",dataType:"json",success:function(t){if(i.inspectors=[],"100100"===t.code&&0<t.data.length){var e=!0,r=!1,n=void 0;try{for(var a,o=t.data[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var u=a.value;i.inspectors.push({label:u.empName,value:u.id,code:u.empCode})}}catch(t){r=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(r)throw n}}}console.log(t)},error:function(t){i.$Spin.hide(),console.log("服务器出错")}})},fetchTestResult:function(){var e=this,t=getCodeList("zj_jyjg");e.testResultArr=[],t.forEach(function(t){e.testResultArr.push({name:t.name,value:t.value})})},formatterTestResult:function(t){return t?this.testResultArr.length<1?t:this.testResultArr[this.testResultArr.map(function(t){return t.value}).indexOf(t)]?this.testResultArr[this.testResultArr.map(function(t){return t.value}).indexOf(t)].name:t:""},unformatTestResult:function(t){return t?this.testResultArr.length<1?t:this.testResultArr[this.testResultArr.map(function(t){return t.name}).indexOf(t)]?this.testResultArr[this.testResultArr.map(function(t){return t.name}).indexOf(t)].value:t:""},setColumns:function(){},toProductDetail:function(){},exit:function(){window.parent.closeCurrentTab({openTime:this.openTime,exit:!0})}},watch:{"body.inspectorId":function(t){void 0===t&&(this.body.inspectorId="")},"body.businessType":function(t){void 0===t&&(this.body.businessType="")},"body.documentStatus":function(t){void 0===t&&(this.body.documentStatus="")}},mounted:function(){this.openTime=window.parent.params.openTime,this.fetchDocumentStatus(),this.fetchBusinessType(),this.loadProductType(),this.fetchInspectors(),this.fetchSourceDocumentType(),this.fetchTestResult()}});