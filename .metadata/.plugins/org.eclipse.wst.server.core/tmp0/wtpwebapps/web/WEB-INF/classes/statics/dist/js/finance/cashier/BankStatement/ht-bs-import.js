"use strict";function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Vue.component("ht-bs-import",{data:function(){return{show:this.value,dataList:[],subjectVisable:!1,upload_config:{url:contextPath+"/bankstatementappcontroller/uploadBankStatementByExcel",uploadType:"父级文件导入"},formData:{subjectId:"",currencyId:"",accountYear:"",accountPeriod:"",accountNumber:"",exchangeRate:"",fileList:[]},currencyList:[]}},methods:{uploadSuccess:function(t){console.log("查看点击上传之后的回调函数result: "),console.log(t);var e=this;if(e.formData.fileList=t.data,"100100"!=t.code)return e.$Message.error({content:t.msg,duration:3,closable:!0}),void this.$refs.uploadRef.clearFiles();$("#list2").jqGrid("setGridParam",{data:e.formData.fileList}).trigger("reloadGrid"),e.$Message.success({content:"文件上传成功!",duration:3,closable:!0})},uploadError:function(t,e,n){console.log(t,e,n,"uploadError :error, file, fileList")},editClick:function(t){console.log(t)},closeModal:function(){this.$emit("close"),this.formData.fileList=[],$("#list2").clearGridData(),this.$refs.uploadRef.clearFiles(),console.log(this.formData)},getColSumDetail:function(t){var e=$("td[aria-describedby='list2_"+t+"']"),n=0;return(e=0!==e.children("div.sumCol").length?$("td[aria-describedby='list2_"+t+"']").children("div.sumCol"):$("td[aria-describedby='list2_"+t+"']:not(:last)")).each(function(t,e){n+=1e3*accounting.unformat($(e).text())}),n/=1e3,n=accounting.formatMoney(n,"",2)},pageInitDetail:function(){var t,e=this;jQuery("#list2").jqGrid((_defineProperty(t={datatype:"local",data:e.formData.fileList,colNames:["日期","摘要","借方金额","贷方金额","备注"],height:"250",colModel:[{name:"dateTimeStr",width:100,align:"center"},{name:"summary",width:245,align:"center"},{name:"debitAmountFor",width:150,align:"center",formatter:function(t,e,n,o){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"creditAmountFor",width:150,align:"center",formatter:function(t,e,n,o){return null==t||0==t?"":accounting.formatNumber(t,2,",")}},{name:"remark",width:200,align:"center"}],rowNum:999999999,sortorder:"desc",sortable:!1,styleUI:"Bootstrap"},"height","230"),_defineProperty(t,"viewrecords",!0),_defineProperty(t,"rownumbers",!0),_defineProperty(t,"loadComplete",function(t){console.log(t,"===========xhr="),e.lodoPList=t.data||[]}),_defineProperty(t,"onCellSelect",function(t){jQuery("#list2").jqGrid("getRowData",t)}),_defineProperty(t,"ondblClickRow",function(t){}),t))},completeMethodDetail:function(){$("#list2").footerData("set",{code:"合计",subjectId:[0]});var t=this.getColSumDetail("subjectId");$("#list2").footerData("set",{code:"合计",subjectId:t})},downloadf1:function(){this.$emit("downloadf1")},importSubjectChange:function(t){var e=this;$.ajax({type:"post",url:contextPath+"/cnbankdepositjournalappcontroller/subjectChange",data:{subjectId:t},success:function(t){"100100"===t.code?(e.currencyList=t.data,e.$refs.editCurrencyIdRef.reset(),e.$nextTick(function(){0<e.currencyList.length&&(e.formData.currencyId=e.currencyList[0].currencyId)}),console.log("引入界面的科目发生变化时查看返回的币别list:result.data"),console.log(e.currencyList)):e.$Message.error({content:"请求错误!",duration:3,closable:!0})}})},importsave1:function(){var t=this,n=t.formData;$.each(t.currencyList,function(t,e){n.currencyId===e.currencyId?n.exchangeRate=e.exchangeRate:n.exchangeRate=1}),$.each(t.subjectList,function(t,e){n.subjectId===e.accountId&&(n.accountNumber=e.bankAccount)}),this.$emit("importsave1",this.formData),t.closeModal()}},mounted:function(){},watch:{value:function(t){console.log(t),(this.show=t)&&this.pageInitDetail()}},computed:{},filters:{filterMoney:function(t){return accounting.formatMoney(t,"",2)},filterOperate:function(t){switch(t){case"1":return"余额";case"2":return"借方余额";case"3":return"贷方余额"}}},props:["value","organizationList","subjectList","periodYear","periodList","downloadf","importsave"],template:'\n\t\t\t<div>\n\t\t\t\t\t<Modal\n\t\t\t\t\t\t\ttitle=\'银行对账单引入\'\n\t\t\t\t\t\t\tv-model="show"\n\t\t\t\t\t\t\twidth="700"\n\t\t\t\t\t\t\t@on-cancel=\'closeModal\'\n\t\t\t\t\t\t\t:mask-closable="false">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Row class="pt10">\n                    <i-col :span="12" class="ht-lineHeight30">\n\t\t\t\t\t\t\t\t\t\t\t\t<label class="w85">科目</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="star"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t<i-select v-model="formData.subjectId" style="width:200px;" @on-change="importSubjectChange">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i-option v-for="item in subjectList"  :value="item.accountId" :key="item.accountId">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t <slot>{{ item.accountCode }}|{{ item.bankName }}</slot></i-option>\n\t\t\t\t\t\t\t\t\t\t\t\t</i-select>\n\t\t\t\t\t\t\t\t\t\t</i-col>\n                    <i-col :span="12" class="ht-lineHeight30">\n\t\t\t\t\t\t\t\t\t\t\t\t<label class="w85">币别</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="star"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t<i-select v-model="formData.currencyId" name="editCurrencyIdRef" ref="editCurrencyIdRef" style="width:120px;">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i-option v-for="item in currencyList" :value="item.currencyId" :key="item.currencyId">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<slot>{{ item.currencyName }}</slot>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</i-option>\n\t\t\t\t\t\t\t\t\t\t\t\t</i-select>\n\t\t\t\t\t\t\t\t\t\t</i-col>\n\t\t\t\t\t\t\t\t</Row>\t\t\n\t\t\t\t\t\t\t\t<Row class="pt10">\n                    <i-col :span="12" class="ht-lineHeight30">\n\t\t\t\t\t\t\t\t\t\t\t\t<label class="w85">期间</label>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="star"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t<i-select v-model="formData.accountYear" filterable style="width:100px;">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i-option v-for="item in periodYear" :value="item.value" :key="item.value">{{item.name}}</i-option>\n\t\t\t\t\t\t\t\t\t\t\t\t</i-select>\n\t\t\t\t\t\t\t\t\t\t\t\t年\n\t\t\t\t\t\t\t\t\t\t\t\t<i-select v-model="formData.accountPeriod" filterable style="width:80px;">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i-option v-for="item in periodList" :value="item.value" :key="item.value">{{item.name}}</i-option>\n\t\t\t\t\t\t\t\t\t\t\t\t</i-select>\n\t\t\t\t\t\t\t\t\t\t\t\t期\n\t\t\t\t\t\t\t\t\t\t</i-col>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t\t<Row class="pt10">\n\t\t\t\t\t\t\t\t\t<i-col :span="12" >\n\t\t\t\t\t\t\t\t\t\t<Upload  \n\t\t\t\t\t\t\t \t\t\t\tref="uploadRef"\n\t\t\t\t\t\t\t\t\t\t\t:on-success="uploadSuccess"\n\t\t\t\t\t\t\t\t\t\t\t:on-error="uploadError"\n\t\t\t\t\t\t\t\t\t\t\t:action="upload_config.url"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<i-button type="ghost" icon="ios-cloud-upload-outline">上传文件</i-button>\n\t\t\t\t\t\t\t\t\t\t</Upload>\n\t\t\t\t\t\t\t\t\t</i-col>\n\t\t\t\t\t\t\t\t\t<i-button @click="downloadf1">下载引入格式</i-button>\n\t\t\t\t\t\t\t\t</Row>\n\t\t\t\t\t\t\t\t<div class="ht-receivableW-table mt10"> \n\t\t\t\t\t\t\t\t\t\t<div class="jqGrid_wrapper2">\n\t\t\t\t\t\t\t\t\t\t\t<table id="list2"></table>\n\t\t\t\t\t\t\t\t\t\t\t<div id="pager2"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div slot="footer">\n\t\t\t\t\t\t\t\t\t\t<i-button type="primary" @click="importsave1">引入</i-button>\n\t\t\t\t\t\t\t\t\t\t<i-button @click="closeModal">取消</i-button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t</Modal>\n\t\t\t</div>\n\t'});