"use strict";function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var custList=new Vue({el:"#cust-add",data:function(){var e;return _defineProperty(e={sourceTemp:!1,isHideSearch:!0,isHideList:!0,isShow:!1,goldTemp:!0,orderId:[],selected:[],employees:"",modalTrigger:!1,modalType:"",stepList:[],approvalTableData:[],payOrder:{custPayOrderNo:"",organizationId:"",organName:"",custNo:"",custId:"",custName:"",status:1,orderDate:"",businessType:"",saleMenId:"",saleMenName:"",saleOrderNo:"",payAmount:"",goldPrice:"",goldColor:"",goldWeight:"",auditId:"",auditTime:"",createName:"",createTime:"",updateName:"",updateTime:"",isDel:"",version:"",financialDataFlag:"",financialDataId:"",remark:"",saveOrSubmit:"",page:"1",limit:"2"},businessTypeList:[{value:1,label:"预付款"},{value:2,label:"锁价"}],goldType:[],tabId:"tabId"},"selected",[]),_defineProperty(e,"reload",!0),_defineProperty(e,"orderReload",!0),_defineProperty(e,"orderId","orderId"),_defineProperty(e,"orderSelected",[]),_defineProperty(e,"data_user_list",{url:contextPath+"/deposit/findCustomerCode",colNames:["选择","客户编码","客户名称"],colModel:[{name:"id",index:"invdate",width:80,align:"center",formatter:function(e,t,r,a){return $(document).off("click",".select"+r.id).on("click",".select"+r.id,function(){custList.confirm(e,t,r,a)}),'<a type="primary" class="select'+r.id+'">选取</a>'}},{name:"code",index:"code",width:300,align:"center"},{name:"name",index:"name",width:300,align:"center"}],multiselect:!1}),_defineProperty(e,"data_order_list",{url:contextPath+"/saleCustPayOrder/findCustOrderNo",colNames:["id","日期","单据编码","客户","商品类型"],colModel:[{name:"id",index:"invdate",width:80,align:"center",hidden:!0},{name:"orderDate",index:"orderDate",width:200,align:"center"},{name:"saleOrderNo",index:"saleOrderNo",width:200,align:"center"},{name:"custName",index:"custName",width:200,align:"center"},{name:"goodsTypeName",index:"goodsTypeName",width:200,align:"center"}]}),_defineProperty(e,"customer",{name:"",code:""}),_defineProperty(e,"saleOrderShow",!1),_defineProperty(e,"orderNum",""),_defineProperty(e,"orderShow",!1),_defineProperty(e,"saleGold",""),e},methods:{clearNum:function(e,t,r){return htInputNumber(e,t,r)},act:function(){if(this.payOrder.goldPrice){var e=Number(this.payOrder.payAmount)/Number(this.payOrder.goldPrice);e=e.toFixed(3),console.log(e),this.payOrder.goldWeight=e}},returnOrder:function(){var t=this;if(this.orderSelected.length<0)this.$Modal.info({content:"请选择数据"});else if(1<this.orderSelected.length)this.$Modal.info({content:"请选择一条数据"});else{var r=this.orderSelected[0].saleOrderNo;$.ajax({url:contextPath+"/saleCustPayOrder/checkCustNo",data:{custNo:r},dataType:"json",type:"post",success:function(e){console.log(e),100100==e.code&&(t.payOrder.saleOrderNo=r,t.saleOrderShow=!1,t.orderShow=!1),-1==e.code&&t.$Modal.info({content:"已关联订单"})},error:function(){console.log("服务器出错啦")}})}},exitOrder:function(){this.saleOrderShow=!1,this.orderShow=!1},orderSearch:function(){if(""!=this.payOrder.custName&&null!=this.payOrder.custName){this.orderShow=!0;var e={postData:{CustOrderNo:this.orderNum,custName:this.payOrder.custName}};$("#"+this.orderId).jqGrid("setGridParam",e).trigger("reloadGrid")}else this.$Modal.info({content:"请选择客户"})},orderAction:function(){this.saleOrderShow=!0},userAction:function(){var e=this;console.log(this.payOrder.custName),""==this.payOrder.custName?this.isShow=!0:this.$Modal.confirm({content:"将会取消关联订单",onOk:function(){e.payOrder.saleOrderNo="",e.payOrder.custName="",e.isShow=!0},onCancel:function(){}})},searchCut:function(){var e={postData:{customerName:this.customer.name,customerNum:this.customer.code}};$("#"+this.tabId).jqGrid("setGridParam",e).trigger("reloadGrid")},searchClear:function(){this.customer={name:"",code:""};var e={postData:{customerName:this.customer.name,customerNum:this.customer.code}};$("#"+this.tabId).jqGrid("clearGridData"),$("#"+this.tabId).jqGrid("setGridParam",e).trigger("reloadGrid")},confirm:function(e,t,r,a){var o=r;this.payOrder.custName=o.name,this.payOrder.custNo=o.code,this.payOrder.custId=o.id,this.isShow=!1},getEmployees:function(){var t=this;$.ajax({type:"post",url:contextPath+"/tpurchasecollectgoods/data",dataType:"json",success:function(e){t.payOrder.organizationId=e.data.orgId,t.payOrder.organName=e.data.orgName,t.employees=e.data.employees,console.log(t.employees)},error:function(){console.log("服务器出错啦")}})},approval:function(e){var t=this;t.modalType="approve",t.modalTrigger=!t.modalTrigger},reject:function(e){var t=this;t.modalType="reject",t.modalTrigger=!t.modalTrigger},approvalOrRejectCallBack:function(e){var t=this;if("100100"===e.result.code){var r=e.result.data;t.payOrder.status=r.status,1===t.payOrder.status&&(t.sourceTemp=!1),t.payOrder.auditTime=r.auditTime,t.payOrder.auditId=r.auditId}else"100515"===e.result.code?t.modalType:this.$Modal.warning({content:e.result.msg,title:"警告"})},saveOrSubmit:function(t){var r=this;if(1==(r.payOrder.saveOrSubmit=t)){if(""==this.payOrder.orderDate)return void this.$Modal.info({content:"请填写日期"});if(""==this.payOrder.saleOrderNo)return void this.$Modal.info({content:"请关联客户订单"});if(""==this.payOrder.payAmount)return void this.$Modal.info({content:"请填写来款金额"});if(""==this.payOrder.businessType)return void this.$Modal.info({content:"请填写来款性质"});if(2==this.payOrder.businessType&&""==this.payOrder.goldColor)return void this.$Modal.info({content:"请填写金料成色"})}$.ajax({type:"post",async:!0,traditional:!0,dataType:"json",contentType:"application/json;charset=utf-8",data:JSON.stringify(r.payOrder),url:contextPath+"/saleCustPayOrder/saveOrSubmit",success:function(e){"100100"==e.code?(r.payOrder=e.data,console.log(r.payOrder),1==t&&(r.$Modal.warning({title:"提示信息",content:"提交成功！"}),r.sourceTemp=!0),0==t&&r.$Modal.warning({title:"提示信息",content:"保存成功！"})):"-1"==e.code?(null!=e.data.orderDate&&r.$Modal.warning({title:"提示信息",content:"下单日期未选择！"}),null!=e.data.BusinessType&&r.$Modal.warning({title:"提示信息",content:e.data.BusinessType}),null!=e.data.CustName&&r.$Modal.warning({title:"提示信息",content:e.data.CustName}),null!=e.data.GoldColor&&r.$Modal.warning({title:"提示信息",content:e.data.GoldColor}),null!=e.data.PayAmount&&r.$Modal.warning({title:"提示信息",content:e.data.PayAmount})):"-2"==e.code&&null!=e.data&&r.$Modal.warning({title:"提示信息",content:e.data})},error:function(e){console.log(e)}})},view:function(e){var t=this;"query"==e.type&&$.ajax({type:"post",async:!0,traditional:!0,data:{id:e.allInfo},url:contextPath+"/saleCustPayOrder/findSaleCustPayOrderEntity",dataType:"json",success:function(e){console.log(e),t.payOrder=e.data,1==t.payOrder.status?(t.sourceTemp=!1,2==t.payOrder.businessType&&(t.goldTemp=!1)):t.sourceTemp=!0},error:function(e){console.log(e)}}),"modify"==e.type&&$.ajax({type:"post",async:!0,traditional:!0,data:{id:e.allInfo},url:contextPath+"/saleCustPayOrder/findSaleCustPayOrderEntity",dataType:"json",success:function(e){console.log(e),t.payOrder=e.data},error:function(e){console.log(e)}})},enComeType:function(e){this.payOrder.goldPrice="",this.payOrder.goldColor="",this.payOrder.goldWeight="","1"==e?this.goldTemp=!0:"2"==e&&(this.goldTemp=!1)},saleMan:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];console.log(t),this.payOrder.saleMenId=t[0].value,this.payOrder.saleMenName=t[0].label},goldMoney:function(e){for(var t in this.saleGold)if(t===e){this.payOrder.goldPrice=this.saleGold[t];var r=Number(this.payOrder.payAmount)/Number(this.payOrder.goldPrice);r=r.toFixed(3),this.payOrder.goldWeight=r}},initGoldPrice:function(e){var t=this;$.ajax({type:"post",url:contextPath+"/tbasetodygoldprice/queryPrice",data:{type:e},dataType:"json",success:function(e){t.saleGold=e.data},error:function(){t.$Message.warning("服务器报错")}})}},mounted:function(){this.initGoldPrice(1),this.getEmployees(),this.goldType=layui.data("dict").base_Condition,console.log(this.goldType);var e=window.parent.params.params;console.log(e),this.view(e)}});